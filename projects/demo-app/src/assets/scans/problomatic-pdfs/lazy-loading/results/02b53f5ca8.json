{"statistics":{"identical":1208,"minorChanges":141,"relatedMeaning":61},"text":{"comparison":{"identical":{"source":{"chars":{"starts":[40213,40611,41068,41224,41254,41329,41456,41486,41699,41963,42356,42442,42638,42668,42774,42850,43295,43517,43581,43611,43713,43890,43914,44091,44189,44271,44443,44473,44636,45050,45139,45169,45266,45338,45537,45615,45639,45715,45996,46264,46360,46449,46543,46728,46816,46915,47234,47516,47546,47635,47701,47731,47796,47820,47897,47994,48099,48177,48201,48345,48415,48952,48982,49163,49233,49267,49445,49621,49939,50039,50203,50233,60746,70318,75995,76104,76579,77179],"lengths":[45,23,29,29,29,29,29,23,27,33,23,23,29,27,23,35,39,29,29,31,25,23,33,39,31,31,29,23,37,29,29,25,23,43,35,23,25,41,29,31,23,27,31,33,35,27,25,29,25,31,29,29,23,33,29,23,23,23,23,29,29,29,25,31,33,25,23,27,41,37,29,29,41,24,38,61,54,55]},"words":{"starts":[5805,5907,5999,6032,6047,6068,6096,6111,6150,6198,6258,6280,6311,6326,6353,6374,6489,6537,6558,6573,6599,6623,6635,6684,6714,6740,6779,6794,6829,6914,6946,6961,6982,7000,7064,7088,7100,7119,7188,7247,7274,7297,7323,7373,7399,7426,7479,7524,7539,7561,7582,7597,7617,7629,7652,7684,7714,7738,7750,7778,7799,7908,7923,7982,8002,8019,8051,8094,8155,8183,8240,8255,10610,12607,14148,14186,14276,14448],"lengths":[22,11,14,14,14,14,14,11,13,16,11,11,14,13,11,17,19,14,14,15,12,11,16,19,15,15,14,11,18,14,14,12,11,21,17,11,12,20,14,15,11,13,15,16,17,13,12,14,12,15,14,14,11,16,14,11,11,11,11,14,14,14,12,15,16,11,11,13,20,18,14,14,15,11,16,28,24,25]}},"suspected":{"chars":{"starts":[5339,5535,5695,5843,6063,6211,6350,6494,6850,6934,7069,7172,7317,7389,7425,7455,8170,8484,8622,8694,8766,8796,8868,8940,9026,9104,9182,9326,9476,9550,9629,9859,9889,9927,10108,10261,10686,10835,10980,11110,11612,11696,12170,12293,12378,12608,13081,13167,13350,13747,13826,13984,14248,14650,14742,15080,15239,15398,15557,16336,16954,17270,17428,18300,18771,16698,18930,19089,19253,19412,19889,20241,18094,13449,8038,6609,7734,18604],"lengths":[45,23,29,29,29,29,29,23,27,33,23,23,29,27,23,35,39,29,29,31,25,23,33,39,31,31,29,23,37,29,29,25,23,43,35,23,25,41,29,31,23,27,31,33,35,27,25,29,25,31,29,29,23,33,29,23,23,23,23,29,29,29,25,31,33,25,23,27,41,37,29,29,41,25,38,61,53,55]},"words":{"starts":[777,855,908,969,1038,1099,1145,1197,1292,1330,1378,1413,1464,1494,1509,1524,1784,1885,1922,1952,1982,1997,2027,2057,2094,2127,2160,2211,2258,2282,2308,2374,2389,2404,2462,2509,2635,2678,2725,2771,2883,2904,3022,3065,3091,3163,3269,3295,3345,3447,3476,3523,3590,3681,3707,3794,3832,3870,3908,4092,4249,4347,4397,4653,4783,4180,4831,4879,4928,4976,5120,5213,4590,3369,1744,1226,1625,4733],"lengths":[22,11,14,14,14,14,14,11,13,16,11,11,14,13,11,17,19,14,14,15,12,11,16,19,15,15,14,11,18,14,14,12,11,21,17,11,12,20,14,15,11,13,15,16,17,13,12,14,12,15,14,14,11,16,14,11,11,11,11,14,14,14,12,15,16,11,11,13,20,18,14,14,15,11,16,28,24,25]}}},"minorChanges":{"source":{"chars":{"starts":[49012,60137,76840,77050],"lengths":[92,98,159,101]},"words":{"starts":[7937,10426,14368,14407],"lengths":[29,33,38,37]}},"suspected":{"chars":{"starts":[17900,7652,7798,7936],"lengths":[85,73,73,73]},"words":{"starts":[4529,1594,1655,1705],"lengths":[29,29,32,33]}}},"relatedMeaning":{"source":{"chars":{"starts":[40262,50081],"lengths":[91,92]},"words":{"starts":[5829,8203],"lengths":[26,33]}},"suspected":{"chars":{"starts":[7575,8286],"lengths":[76,83]},"words":{"starts":[1561,1825],"lengths":[32,34]}}}},"value":"University of Connecticut\n\nOpenCommons@UConn\nDoctoral Dissertations\n\nUniversity of Connecticut Graduate School\n\n7-28-2017\n\nOptimization and Bayesian Inference in Modelbased Decision Making\nAli Abdollahi\nali.abdollahi@uconn.edu\n\nFollow this and additional works at: https://opencommons.uconn.edu/dissertations\nRecommended Citation\nAbdollahi, Ali, \"Optimization and Bayesian Inference in Model-based Decision Making\" (2017). Doctoral Dissertations. 1611.\nhttps://opencommons.uconn.edu/dissertations/1611\n\nOptimization and Bayesian Inference in\nModel-based Decision Making\n\nAli Abdollahi, Ph.D.\nUniversity of Connecticut, 2017\n\nABSTRACT\nThe focus of this dissertation is on using optimization and Bayesian inference\nin model-based decision making. We discuss two problems: (a) optimal battery\ncharging and battery life management; (b) fault diagnosis using probabilistic graphical\nmodels. In the first part of this thesis, we address the optimal charging problem\nusing a two-time-scale algorithm which performs fast-charging at the lower-level (fast\ntime-scale), while managing the battery life at the higher-level (low time-scale). At the\nlower-level, we derive optimal charging algorithms for Li-ion batteries using equivalent\nelectrical circuit models and quadratic optimization approaches. The objective function\nis considered as a linear combination of time-to-charge, energy-loss, temperature rise\nindex, and any other arbitrary function of state-of-charge (SOC). A generic algorithm,\nwhich is applicable to any equivalent electrical circuit model of a battery, is derived\nfor calculating the optimal current profile. At the higher-level, we propose a battery\nlife management algorithm to determine the optimal values for the control parameters\nof the charging process, namely, maximum allowable current and maximum allowable\nterminal voltage. As a precursor to the battery life management algorithm, we propose\ntwo new battery capacity fade models that are shown to be statistically superior to\n\nAli Abdollahi, Ph.D.\nUniversity of Connecticut, 2017\n\nthe bi-exponential capacity fade model. In the second part of the thesis, we consider\nthe fault diagnosis problem using probabilistic graphical models. We discuss the\nDetection-False Alarm (DFA), the Leaky Noisy OR (LNOR), and the logistic regression\n(LR)-based test models. Here, we prove the equivalence of DFA and LNOR test models.\nThen, we propose a unified test model that includes both the LNOR and the LR\ntest models as special cases, and derive a Maximum a posteriori solution for the\nmultiple fault diagnosis problem based on the unified test model using the Lagrangian\nrelaxation method and deriving a dual cost function for the problem.\n\nOptimization and Bayesian Inference in\nModel-based Decision Making\n\nAli Abdollahi\n\nM.S., Electrical Engineering, Ferdowsi University of Mashhad, 2002\nB.S., Electrical Engineering, Ferdowsi University of Mashhad, 1999\n\nA Dissertation\nSubmitted in Partial Fulfillment of the\nRequirements for the Degree of\nDoctor of Philosophy\nat the\nUniversity of Connecticut\n\n2017\n\ni\n\nCopyright by\n\nAli Abdollahi\n\n2017\n\nii\n\nAPPROVAL PAGE\n\nDoctor of Philosophy Dissertation\n\nOptimization and Bayesian Inference in\nModel-based Decision Making\nPresented by\nAli Abdollahi, M.S. Electrical Engineering\n\nMajor Advisor\n\nAssociate Advisor\n\nKrishna R. Pattipati\n\nYaakov Bar-Shalom\n\nAssociate Advisor\n\nShengli Zhou\n\nUniversity of Connecticut\n2017\n\niii\n\nTo: my mother and my wife\n\niv\n\nACKNOWLEDGMENTS\n\nNow that I am in the last stages of preparing my PhD thesis, I would like to\nspend some time to thank those who helped me during this journey. First, I would\nlike to thank my major advisor, Prof. Krishna R. Pattipati, who helped me prepare\nthis work. I love the moments that we discussed and I am thankful for his support,\nguidance, and encouragement. I learned from him lessons of research and lessons of\nlife. I would like to thank my co-advisor, Prof. Yaakov Bar-Shalom, for his meticulous\nreading of my papers and for his helpful comments. I would like to thank Prof. Shengli\nZhou for serving on my dissertation Committee.\nI would like to thank Cyberlab students, Xu Han, Niranjan Raghunathan,\nManisha Mishra, Pujitha Mannaru, Rajeev Ghimire, David Sidoti, Lingyi Zhang, Gopi\nVinod Avvari, Bharath Pattipati, Donald McMenemy, and Spandana Vallabhaneni,\nfor the friendly environment that they provided in Cyberlab, and I would like to\nespecially thank Xu Han and Niranjan Raghunathan for their help in the optimal\nbattery charging project.\nI would like to thank Michael Rauth, Bob Card, and Travis Williams from\nFairchild Semiconductor for the discussions that we had during the weekly teleconferences. I would also like to thank the Department Head, Prof. Rajeev Bansal, the\nDepartment Associate Head, Prof. John Chandy, and the administrative staff of the\nDepartment, Mary P. McCarthy, Karen Kuca, Celine Goorahoo, and Dee Stolstrom\nfor their help.\n\nv\n\nSupport from Fairchild Semiconductor, National Science Foundation (NSF),\nUTC Chair Professorship and UCONN’s Academic Plan is gratefully acknowledged.\nFinally, I would like to thank my family members who have always been\nthe source of support, encouragement and love. I would like to specially thank and\ndedicate this work to my mother and my wife.\n\nvi\n\nContents\nPage\nList of Figures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\nix\nList of Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xiii\nCh. 1. Introduction\n1.1 Publications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n1.2 Optimal Battery Charging and Battery Life Management . . . . . . .\n1.2.1 Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n1.2.2 Related Work . . . . . . . . . . . . . . . . . . . . . . . . . . .\n1.2.3 Challenges . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n1.2.4 Approach and Results . . . . . . . . . . . . . . . . . . . . . .\n1.3 Multiple Fault Diagnosis using Probabilistic Graphical Models . . . .\n1.3.1 Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n1.3.2 Related Work . . . . . . . . . . . . . . . . . . . . . . . . . . .\n1.3.3 Challenges . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n1.3.4 Approach and Results . . . . . . . . . . . . . . . . . . . . . .\n1.4 Contributions and Research Impact . . . . . . . . . . . . . . . . . . .\n\n1\n4\n6\n6\n6\n7\n8\n8\n8\n9\n10\n11\n12\n\nCh. 2. Optimal Battery Charging\n2.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n2.2 Analytic Solution for Optimal Charging Current Profile for OCVResistance Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n2.3 Optimal Charging Problem Considering Temperature . . . . . . . . .\n2.4 Linear Quadratic- Constant Voltage (LQ-CV) Strategy Formulation .\n2.5 Simulations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n2.5.1 Model I . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\nVerification of the Optimal Solution . . . . . . . . . . . . . . .\nEffect of Weights . . . . . . . . . . . . . . . . . . . . . . . . .\n\n14\n14\n\nvii\n\n16\n29\n34\n44\n45\n45\n47\n\n2.6\n\nTemperature Effect . . . . . . . . . . . . . . . . . . . . . . . .\nAnalysis of Different Commercial Batteries . . . . . . . . . . .\n2.5.2 Model III . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\nEffect of Weights . . . . . . . . . . . . . . . . . . . . . . . . .\nSummary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n\n51\n54\n56\n56\n59\n\nCh. 3.\n3.1\n3.2\n3.3\n3.4\n3.5\n3.6\n3.7\n3.8\n3.9\n\nCapacity Fade Modeling\nIntroduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\nAging Experiments . . . . . . . . . . . . . . . . . . . . . . . . . . . .\nLAR-αβγ Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\nLS-BE Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\nComparison of LAR-αβγ Model and LS-BE Model . . . . . . . . . .\nCVD Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\nComparison of CVD and LS-BE Models . . . . . . . . . . . . . . . .\nEffect of Terminal Voltage and Current on Battery Capacity . . . . .\nSummary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n\n60\n60\n61\n65\n65\n67\n71\n73\n75\n77\n\nCh. 4. Battery Life Management\n78\n4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78\n4.2 Fast Charging with Battery Life Management via Optimal Charging\nParameter Selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79\n4.3 Numerical Illustration of Optimal Charging Parameter Selection . . . 87\n4.3.1 Scenario 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88\n4.3.2 Scenario 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90\n4.3.3 Scenario 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92\n4.3.4 Scenario 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93\n4.3.5 Scenario 5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95\n4.3.6 Scenario 6 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96\n4.3.7 Scenario 7 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98\n4.3.8 Scenario 8 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99\n4.3.9 Summary of Scenarios and Some Insights . . . . . . . . . . . . 103\n4.4 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104\nCh. 5.\n5.1\n5.2\n5.3\n\nFault Detection, Diagnosis and Prognosis\n106\nIntroduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106\nStatic Multiple Fault Diagnosis . . . . . . . . . . . . . . . . . . . . . 111\nDynamic Multiple Fault Diagnosis . . . . . . . . . . . . . . . . . . . . 127\n\nviii\n\n5.4\n5.5\n5.6\n\nFault Diagnosis in Active Probing (Sequential Fault Diagnosis) and\nFault Diagnosis Applications . . . . . . . . . . . . . . . . . . . . . . . 132\nRelevant Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136\nSummary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142\n\nCh. 6. Unification of Leaky Noisy OR and Logistic Regression Test\nModels\n6.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n6.2 Equivalence of Detection-False Alarm (DFA) and Leaky Noisy OR\n(LNOR) Test Models . . . . . . . . . . . . . . . . . . . . . . . . . . .\n6.3 Logistic Representation of Test Models . . . . . . . . . . . . . . . . .\n6.3.1 Logistic Combinatorial Test Models . . . . . . . . . . . . . .\n6.3.2 Restricted Logistic Test Model . . . . . . . . . . . . . . . . . .\n6.3.3 Logistic Regression Test Model . . . . . . . . . . . . . . . . .\n6.4 Unified Representation of Leaky Noisy OR and Logistic Regression Test\nModels . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n6.5 Maximum A Posteriori (MAP) Inference for the Unified Test Model .\n6.6 Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n6.6.1 Comparison of the Leaky Noisy OR and Logistic Regression\nTest Models . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n6.6.2 Dual Cost Function and the MAP Estimate . . . . . . . . . .\n6.7 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n\n162\n166\n168\n\nCh. 7. Conclusion and Future Work\n\n170\n\nAppendices\n\n179\n\nCh. A. OCV and electrical parameters for commercial batteries\n\n180\n\nCh. B. Temperature Modeling for OCV-Resistance Model\n\n182\n\nCh. C. Derivation of the LQ-CV algorithm\n\n189\n\nBibliography\n\n201\n\nix\n\n145\n145\n146\n150\n151\n151\n152\n154\n156\n162\n\nList of Figures\n1.0.1 Battery management system (BMS) block diagram . . . . . . . . . . .\n\n2\n\n2.2.1 OCV curve as a function of SOC . . . . . . . . . . . . . . . . . . . . .\n\n18\n\n2.2.2 Equivalent electrical circuit model I of battery . . . . . . . . . . . . . .\n\n19\n\n2.2.3 Equivalent electrical circuit model III of battery . . . . . . . . . . . . .\n\n19\n\n2.2.4 Minimization of time and energy loss . . . . . . . . . . . . . . . . . . .\n\n23\n\n2.4.1 Equivalent electrical circuit model III of battery . . . . . . . . . . . . .\n\n34\n\n2.5.1 Five different current profiles (including the optimal profile) . . . . . .\n\n46\n\n2.5.2 Five different current profiles: a) cost functions b) current levels in CC\nstage\n\n. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n\n47\n\n2.5.3 Current profiles for different values of ρt . . . . . . . . . . . . . . . . .\n\n48\n\n2.5.4 SOC profiles for different values of ρt . . . . . . . . . . . . . . . . . . .\n\n49\n\n2.5.5 Voltage profiles for different values of ρt\n\n49\n\n. . . . . . . . . . . . . . . . .\n\n2.5.6 TTC, El and efficiency curves for different values of ρt\n\n. . . . . . . . .\n\n50\n\n. . . . . . . . . . . . . . . . . . . . . . . . . . .\n\n51\n\n2.5.8 Current profiles for ρt = 1, ρT = 1 and temperature parameter set ”A” .\n\n53\n\n2.5.7 TTC versus efficiency\n\n2.5.9 Temperature profiles for ρt = 1, ρT = 1 and temperature parameter set ”A” 53\n2.5.10 Time-to-charge versus efficiency of different battery types at 25◦ C . . .\nx\n\n55\n\n2.5.11 Cost function for different battery types at 25◦ C, ρt = 0.5 . . . . . . . .\n\n55\n\n2.5.12 Current profiles for different values of ρt . . . . . . . . . . . . . . . . .\n\n56\n\n2.5.13 SOC profiles for different values of ρt . . . . . . . . . . . . . . . . . . .\n\n57\n\n2.5.14 Terminal voltage profiles for different values of ρt . . . . . . . . . . . .\n\n57\n\n2.5.15 Current profiles for different values of ρT . . . . . . . . . . . . . . . . .\n\n58\n\n3.2.1 A sample current profile (charge-rest-discharge-rest) . . . . . . . . . . .\n\n64\n\n3.2.2 Voltage profiles of 125 cycles (data set 2) . . . . . . . . . . . . . . . . .\n\n64\n\n3.5.1 Comparison of LAR-αβγ model and LS-BE model with 40 training samples 68\n3.5.2 Comparison of LAR-αβγ model and LS-BE model with 160 training\nsamples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n\n68\n\n3.5.3 MSE ratio of LS-BE to LAR . . . . . . . . . . . . . . . . . . . . . . . .\n\n70\n\n3.7.1 Comparison of LAR-αβγ model and LS-BE model with different fitting\ndata lengths. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n\n74\n\n3.7.2 Relative error of LS-BE, and CVD models with respect to LAR-αβγ . .\n\n74\n\n3.8.1 Plot of 80 capacity curves with high resolution in voltage (20 values) and\nlow resolution in current (4 values) . . . . . . . . . . . . . . . . . . . .\n\n76\n\n3.8.2 Plot of 80 capacity curves with low resolution in voltage (4 values) and\nhigh resolution in current (20 values) . . . . . . . . . . . . . . . . . . .\n\n76\n\n4.1.1 Block diagram of level-I optimization (battery life management) . . . .\n\n79\n\n4.2.1 An example of normalized capacity as a function of cycle number . . .\n\n81\n\n4.2.2 Illustration of Useful Cycle Life (UCL) . . . . . . . . . . . . . . . . . .\n\n82\n\n4.2.3 Illustration of Virtual Present Cycle (VPC)\n\n. . . . . . . . . . . . . . .\n\n83\n\n4.2.4 Illustration of Remaining Useful Cycle Life (RUCL) . . . . . . . . . . .\n\n84\n\n4.2.5 Battery life management block diagram . . . . . . . . . . . . . . . . . .\n\n87\n\nxi\n\n4.3.1 Expected Useful Cycle Life (EUCL) for Scenario 1 infeasible strategies\nare in red; optimal strategy is in green . . . . . . . . . . . . . . . . . .\n\n89\n\n4.3.2 Expected Useful Cycle Life (EUCL) for Scenario 2 infeasible strategies\nare in red; optimal strategy is in green . . . . . . . . . . . . . . . . . .\n\n91\n\n4.3.3 Expected Useful Cycle Life (EUCL) for Scenario 3 infeasible strategies\nare in red; optimal strategy is in green . . . . . . . . . . . . . . . . . .\n\n93\n\n4.3.4 Expected Useful Cycle Life (EUCL) for Scenario 4 infeasible strategies\nare in red; optimal strategy is in green . . . . . . . . . . . . . . . . . .\n\n94\n\n4.3.5 Expected Useful Cycle Life (EUCL) for Scenario 5 infeasible strategies\nare in red; optimal strategy is in green . . . . . . . . . . . . . . . . . .\n\n96\n\n4.3.6 Expected Useful Cycle Life (EUCL) for Scenario 6 infeasible strategies\nare in red; optimal strategy is in green . . . . . . . . . . . . . . . . . .\n\n97\n\n4.3.7 Expected Useful Cycle Life (EUCL) for Scenario 7 infeasible strategies\nare in red; optimal strategy is in green . . . . . . . . . . . . . . . . . .\n\n99\n\n4.3.8 Expected Useful Cycle Life (EUCL) for Scenario 8 infeasible strategies\nare in red; optimal strategy is in green . . . . . . . . . . . . . . . . . . 100\n4.3.9 Effect of power fade (increase in the series resistance) on the expected\nuseful cycle life (EUCL) of battery . . . . . . . . . . . . . . . . . . . .\n\n101\n\n4.3.10 Effect of capacity fade on the expected useful cycle life (EUCL) of battery102\n4.3.11 Effect of vmax and imax on power fade and capacity fade . . . . . . . . . 102\n5.1.1 Tripartite digraph of fault diagnosis system . . . . . . . . . . . . . . . . 108\n5.1.2 Modeling abstractions in fault diagnosis subsystems . . . . . . . . . . . 110\n5.1.3 Perfect and imperfect relations of a failure source and a test outcome .\n\n111\n\n5.2.1 Some plots regarding the dual function . . . . . . . . . . . . . . . . . . 123\n\nxii\n\n5.2.2 Dual cost function analysis . . . . . . . . . . . . . . . . . . . . . . . . . 125\n6.2.1 Detection-False Alarm (DFA) test model . . . . . . . . . . . . . . . . . 147\n6.2.2 Leaky Noisy OR (LNOR) test model . . . . . . . . . . . . . . . . . . . 147\n6.6.1 Comparison of probability of t1 is passed given x for the LNOR and the\nLR test models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 164\n6.6.2 Comparison of probability of t2 is passed given x for the LNOR and the\nLR test models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 164\n6.6.3 Comparison of Pr(T = 11|x) Pr(x) for the LNOR and the LR test models 165\n6.6.4 Comparison of Pr(T = 11|x) Pr(x) for the LNOR and the LR test models 166\n6.6.5 Dual cost function for the LNOR test model . . . . . . . . . . . . . . . 167\n6.6.6 Dual cost function for the LR test model . . . . . . . . . . . . . . . . . 167\nB.0.1 Block diagram of temperature modeling . . . . . . . . . . . . . . . . . . 186\n\nxiii\n\nList of Tables\n2.5.1 Battery thermal paramters . . . . . . . . . . . . . . . . . . . . . . . . .\n\n52\n\n2.5.2 Cost function for different schemes . . . . . . . . . . . . . . . . . . . .\n\n52\n\n3.2.1 List of aging experiments . . . . . . . . . . . . . . . . . . . . . . . . . .\n\n62\n\n3.2.2 Description of charging profiles . . . . . . . . . . . . . . . . . . . . . .\n\n63\n\n3.2.3 Description of discharge profile of Disch1 . . . . . . . . . . . . . . . . .\n\n63\n\n3.5.1 AIC differences of the LAR-αβγ and LS-BE models and relative likelihood\nof LS-BE model for all aging experiments . . . . . . . . . . . . . . . . .\n\n70\n\n3.5.2 Parameters of LAR-αβγ model for all experiments . . . . . . . . . . . .\n\n71\n\n3.6.1 Parameters of CVD model . . . . . . . . . . . . . . . . . . . . . . . . .\n\n73\n\n4.3.1 Expected Useful Cycle Life (EUCL), for Scenario 1: P C = 50, QPC = 0.96,\nR0 = 150mΩ, and sth = 0.50 . . . . . . . . . . . . . . . . . . . . . . . .\n\n89\n\n4.3.2 Expected Useful Cycle Life (EUCL), for Scenario 2: P C = 50, QPC = 0.99,\nR0 = 150mΩ, and sth = 0.50 . . . . . . . . . . . . . . . . . . . . . . . .\n\n90\n\n4.3.3 Expected Useful Cycle Life (EUCL), for Scenario 3: P C = 50, QPC = 0.96,\nR0 = 150mΩ, and sth = 0.80 . . . . . . . . . . . . . . . . . . . . . . . .\n\nxiv\n\n92\n\n4.3.4 Expected Useful Cycle Life (EUCL), for Scenario 4: P C = 50, QPC = 0.96,\nR0 = 200mΩ, and sth = 0.50 . . . . . . . . . . . . . . . . . . . . . . . .\n\n94\n\n4.3.5 Expected Useful Cycle Life (EUCL), for Scenario 5: P C = 50, QPC = 0.96,\nR0 = 250mΩ, and sth = 0.50 . . . . . . . . . . . . . . . . . . . . . . . .\n\n95\n\n4.3.6 Expected Useful Cycle Life (EUCL), for Scenario 6: P C = 50, QPC = 0.96,\nR0 = 300mΩ, and sth = 0.50 . . . . . . . . . . . . . . . . . . . . . . . .\n\n97\n\n4.3.7 Expected Useful Cycle Life (EUCL), for Scenario 7: P C = 50, QPC = 0.97,\nR0 = 150mΩ, and sth = 0.50 . . . . . . . . . . . . . . . . . . . . . . . .\n\n98\n\n4.3.8 Expected Useful Cycle Life (EUCL), for Scenario 8: P C = 50, QPC = 0.98,\nR0 = 150mΩ, and sth = 0.50 . . . . . . . . . . . . . . . . . . . . . . . . 100\n4.3.9 Scenarios: parameters and optimal policy . . . . . . . . . . . . . . . . . 103\n6.3.1 Input and fj (x) for two failure sources and a single output . . . . . . . 152\nA.0.1 Electrical parameters of model III for commercial batteries . . . . . . . 180\nA.0.2 OCV parameters for commercial batteries . . . . . . . . . . . . . . . .\n\nxv\n\n181\n\nChapter 1\nIntroduction\nThe focus of this dissertation is on optimization and Bayesian inference in model-based\ndecision making. In the optimization part, our focus is on optimal battery charging.\nFigure 1.0.1 shows the block diagram of a battery management system (BMS). The\nbattery fuel gauge (BFG) provides the charger with battery model parameters, battery\ncapacity estimate, battery usage statistics, and battery state-of-charge (SOC). The\ncharging process is considered as a two-level algorithm. In a higher level (level I), we\ndetermine the optimal values for maximum allowable current and maximum allowable\nterminal voltage of the battery. In a lower level (level II), we find the optimal charging\ncurrent with respect to an objective function.\n\n1\n\nFigure 1.0.1: Battery management system (BMS) block diagram\n\nAt the lower level (level II), using equivalent electrical circuit models of the\nbattery, we formulate the charging problem as a constrained optimization problem\nwith an objective function that is a combination of three sub-objectives: time-to-charge\n(TTC), energy loss (EL), and a temperature rise index (TRI); the constraints are\nthe battery dynamics, the maximum allowable terminal voltage, and the maximum\nallowable current. We show that under if a simple model (composed of an Open-Circuit\nVoltage (OCV) and a resistance) is used for the battery, the well-known Constant\nCurrent-Constant Voltage (CC-CV) policy with the value of the current in the CC\nstage being a function of the ratio of the weightings on TTC and EL, and of the\nresistance of the battery, is the optimal charging profile. The optimal battery charging\nproblem is then formulated in its general form for any electrical model of the battery\n2\n\nand for a more general objective function (composed of weighted sum of TTC, EL,\nTRI, and any function of the state-of-charge (SOC)).\nAt the higher level (level I), as a precursor to formulating the battery life\nmanagement in terms of an optimization problem, we present two new models for\nnormalized battery capacity as functions of the number of cycles and two charge control\nparameters, viz., maximum terminal voltage of the battery and maximum charge\ncurrent. These models are compared to a bi-exponential capacity model proposed in\nthe literature. The effectiveness of the proposed models for forecasting the battery\ncapacity is validated using experimental data and they are shown statistically to be\nsubstantially more accurate than the bi-exponential capacity model. The new models\nare used for battery life management by developing an optimal charging parameter\nselection method, which provides the best setting values for the two control variables\nto achieve a pre-specified desired “useful cycle life,” while attaining the fastest possible\ntime-to-charge.\nIn the Bayesian inference part, our focus is on the problem of fault diagnosis\nin probabilistic graphical models. The fault diagnosis problem can be represented as\na tri-partite probabilistic graphical model. The first layer of this tri-partite graph is\ncomposed of the components of the system, which are the potential sources of failure.\nThe health condition of each component is represented by a binary state variable,\nwhich is zero if the component is healthy and one otherwise. The second layer is\ncomposed of tests with binary outcomes (pass or fail), and the third layer constitutes\nof the noisy observations associated with the test outcomes. The cause-effect relations\nbetween the states of components and the observed test outcomes can be compactly\nmodeled in terms of detection and false alarm probabilities. This model, which uses\nthe concept of detection and false alarm probabilities, is referred to as the DFA test\n3\n\nmodel in this dissertation. The fault diagnosis problem is formulated as a maximum\na posteriori (MAP) inference problem, and a dual cost function of the resulting\noptimization problem is derived. Another model, which is discussed, is the leaky\nnoisy OR (LNOR) test model. We prove that, for every DFA test model, there is\nan equivalent LNOR test model. Thus, all the formulations involving the DFA test\nmodel are applicable to the LNOR test model. Another model that is discussed is the\nlogistic regression (LR) test model. Then, a unified test model, which subsumes both\nthe LNOR and the LR test models as special cases, is developed. The MAP problem\nfor fault diagnosis for the unified test model is discussed and a dual cost function is\nderived.\n\n1.1\n\nPublications\n\nPublications to-date include: [5, 6, 11, 9, 10, 7, 8, 135].\n1. A. Abdollahi, X. Han, N. Raghunathan, B. Pattapati, B. Balasingam, K.\nR. Pattipati, Y. Bar-Shalom, and B. Card, “Optimal Charging for General\nEquivalent Electrical Battery Model, and Battery Life Management,” Journal\nof Energy Storage, vol. 9, pp. 47–58, 2017.\n2. A. Abdollahi, X. Han, G. V. Avvari, N. Raghunathan, B. Balasingam, K. R.\nPattipati, and Y. Bar-Shalom, “Optimal battery charging, Part I: Minimizing\ntime-to-charge, energy loss, and temperature rise for OCV-resistance battery\nmodel,” Journal of Power Sources, vol. 303, pp. 388-398, 2016.\n3. A. Abdollahi, K. R. Pattipati, A. Kodali, S. Singh, S. Zhang, and P. B. Luh,\n“Probabilistic Graphical Models for Fault Diagnosis in Complex Systems,” Part-I\n4\n\nCh. 5 in Principles of Performance and Reliability Modeling and Evaluation,\nSpringer 2016. pp. 109–139.\n4. A. Abdollahi, K. R. Pattipati, “Probabilistic Graphical Models for Fault Prognosis in Complex Systems,” in preparation, 2017.\n5. A. Abdollahi, K. R. Pattipati, “Unification of Leaky Noisy OR and Logistic\nRegression Models and Maximum A Posteriori Inference for Multiple Fault\nDiagnosis Using the Unified Model,” in International Workshop on Principles\nof Diagnosis (DX), Denver, CO., Oct., 2016.\n6. A. Abdollahi, N. Raghunathan, X. Han, G. V. Avvari, B. Balasingam, K.\nR. Pattipati, and Y. Bar-Shalom, “Battery charging optimization for OCVresistance equivalent circuit model,” in Proc. American Control Conference\n(ACC), 2015, pp. 3467-3472.\n7. A. Abdollahi, N. Raghunathan, X. Han, B. Pattipati, B. Balasingam, K. R.\nPattipati, Y. Bar-Shalom, and B. Card, “Battery health degradation and optimal\nlife management,” in Proc. IEEE AUTOTESTCON, 2015, pp. 146-151.\n8. B. Pattipati, B. Balasingam, A. Abdollahi, G. V. Avvari, K. R. Pattipati, and\nY. Bar-Shalom, “Integrated battery fuel gauge and optimal charger,” In Proc.\nIEEE AUTOTESTCON, 2014, pp. 260-269.\n\n5\n\n1.2\n\nOptimal Battery Charging and Battery Life\nManagement\n\n1.2.1\n\nMotivation\n\nThe ever-increasing market for battery-operated smart devices and electric vehicles is\na catalyst for the efficient operation and health monitoring of batteries. In this vein,\nresearchers address this challenge, broadly, in two ways: optimal battery charging and\nlife cycle management. The latter requires the tracking of battery capacity. Although\nthe literature abounds with different charging methods and different capacity modeling\napproaches (see the following subsection), to the best of our knowledge, no general\nframework exists that considers both charging and life management of a battery. In\nthis thesis, this integrated battery charging and battery life management will be\ndiscussed and a two-level algorithm for solving the problem is proposed.\n\n1.2.2\n\nRelated Work\n\nThere are different approaches for charging batteries in the literature, including:\ntraditional methods of charging such as the constant trickle current charge strategy,\nconstant-current constant-voltage (CC-CV) [51], multi-step constant-current charging\n[115], Taguchi-based methods [116, 187], boost charging [132], pulse-charging [153, 41,\n42, 113], ant-colony based optimization of multistage constant current strategy [117],\noptimal-control based approaches[77], neural network [148], Grey-predicted charging\nsystem [43]. For a review of different charging methods, the interested reader may\nconsult [51], [102], [39], [175].\nThere are a number of capacity models in the literature, including bi6\n\nexponential [82], physics-based electrochemical [114], [160], [152], and methods that\nare based on support vector machines [136], relevance vector machines (RVM) [162],\nsample entropy-based [85], extended Kalman filter [150], weighted total least squares\n[151], and SOC lookup [59]. A robust real time capacity estimation approach based\non recursive least squares, total least squares, and OCV lookup has been proposed in\n[21]. A good review of several capacity estimation techniques can be found in [201].\nFor more information on capacity fade, the interested reader may refer to [14], [205].\n\n1.2.3\n\nChallenges\n\nOne challenge in finding the optimal charging profile is that batteries are nonlinear\nsystems. The open-circuit voltage (OCV) of a battery is a nonlinear function of the\nstate-of-charge (SOC) of the battery. Another challenge is controlling the capacity\nfade due to a charging profile. Capacity of a battery decreases with usage and the\namount of capacity fade depends on how the battery is charged and discharged. While\nthe discharge is out of designer’s control, the charging profile can be controlled. For\nexample, if the battery is charged with a low-level of current, its capacity fades more\nslowly over time compared to a battery with the same characteristics, but charged\nwith high levels of current. The former requires longer charging times, while the latter\nshortens the charging time at the cost of decreased battery life. A challenge in finding\nthe optimal charging profile is how to strike a balance between the speed of charge\nand the life of a battery.\n\n7\n\n1.2.4\n\nApproach and Results\n\nIn this thesis, we investigate a two-level control strategy for combined optimal battery\ncharging and battery life management. The low-level (level-II) deals with the problem\nof optimally charging the battery, given the control parameters of charging, viz.,\nthe maximum allowable current and the maximum allowable terminal voltage. A\ncombination of different cost functions is considered including: time-to-charge, energy\nloss, and temperature rise index. For the battery, equivalent electrical circuit models\nare considered [20, 21]. At the higher level of optimization (level-I), we consider the\noptimal selection of control parameters of the charging process (maximum allowable\ncurrent and maximum allowable terminal voltage). These parameters greatly affect\nthe life of the battery. As a precursor to the level-I optimization strategy, we present\ntwo models of normalized battery capacity (or, equivalently, capacity fade), one of\nwhich as a function of the number of cycles and the two charge control parameters.\nIn the level-I optimization, we develop an algorithm for selecting the setpoints for the\ncontrol variables to achieve a pre-specified desired “useful cycle life”, while attaining\nthe fastest possible time-to-charge. This work was published in [5, 6, 11, 9, 10].\n\n1.3\n\nMultiple Fault Diagnosis using Probabilistic\nGraphical Models\n\n1.3.1\n\nMotivation\n\nReliability is essential to system availability and critical to system performance, and it is\nachieved in two phases: in design and development via design for performance reliability\n\n8\n\nand testability, and during system operation via fault diagnosis and maintenance.\nDesign process aims at increasing product performance and reliability, while reducing\nthe cost and time-to-market. The performance and reliability goals conflict with the the\nneed to reduce cost and time-to-market, and this imposes a trade-off on how reliability\nand performance are achieved. Market pressures restrict the extent to which reliability\ncan be achieved during system design; after-market services, such as efficient fault\ndiagnosis, prognosis and condition-based maintenance, represent additional strategies\nto improve system availability. The latter strategies are assuming greater significance\nas systems are becoming complex with larger numbers of interacting components and\nare networked with the attendant cross-subsystem fault propagation. As a result,\naccurate methods of fault detection, diagnosis, and prognosis are in high demand in\nindustry.\n\n1.3.2\n\nRelated Work\n\nTraditional approaches to fault detection and isolation, as discussed in [191], include\n“failure-sensitive” filters [101], [97], voting systems (for systems with a high degree of\nredundancy in parallel hardware), multiple hypothesis filter-detectors [111], [15], [49],\njump process techniques [35], [34], and innovation-based detection systems [122], [124],\n[165], [79], [192].\nData-driven approaches to FDD are used when the system models are\nunavailable, but adequate data monitoring is available. Such systems are frequently\nused when vendors of subsystems do not provide the details of the internal functioning\nof their products in order to protect their intellectual property. To circumvent this\nlack of product details, data-driven approaches utilize substantial monitoring data in\n\n9\n\norder to train a model that satisfactorily represents the black-box system. Recursive\nidentification [118], neural networks [68], [32] and machine learning methods [177],\n[159] are among the data-driven techniques.\nKnowledge-based approaches to FDD require qualitative models for process\nmonitoring and are used when mathematical models are unavailable. Most knowledgebased techniques are based on causal analysis, expert systems, and/or ad hoc rules.\nBecause of the qualitative nature of these models, knowledge-based approaches have\nbeen applied to many complex systems. Graphical models, such as Petri nets, multisignal flow graphs and Bayesian networks [177], are applied for diagnostic knowledge\nrepresentation and inference in complex systems. Bayesian Networks subsume the\ndeterministic fault diagnosis models embodied in the Petri net and multi-signal models.\nThe model based, data-driven and knowledge-based approaches provide the\n“sand box” that test designers can use to experiment with, and systematically select\nrelevant models or combinations thereof, to satisfy the requirements on diagnostic\naccuracy, computational speed, memory, on-line versus off-line diagnosis, and so\non. Ironically, no single technique can serve as the diagnostic approach for complex\nsystems. Thus, an integrated diagnostic process that naturally employs data-driven\ntechniques, graph-based dependency models and mathematical/physical models is\nnecessary for fault diagnosis, thereby enabling efficient maintenance of these systems.\nThe probabilistic graphical models provide such an integrating platform.\n\n1.3.3\n\nChallenges\n\nThe process of detecting and isolating faults in complex systems is challenging, because:\n\n\nThe numbers of faults and monitoring signals (“processed sensor measurements”,\n10\n\n“tests”, “symptoms”, “visual observations”) in these systems are large (running\ninto tens of thousands).\n\n\nEach test outcome may be caused by faults in multiple components of possibly\nmultiple subsystems (“many-to-many” fault-test relationships).\n\n\n\nFaults propagate from one subsystem to another (“cross-subsystem fault propagation”) with delays.\n\n\n\nThe combination of failure sources leads to combinatorial explosion in an exhaustive search for failure sources, which is impractical in real-world problems.\n\n\n\nTest outcomes, which are uncertain, are observed with delays caused by fault\npropagation, computation and communication.\n\n\n\nSimultaneous occurrence of multiple faults is frequent.\nThis makes traditional single-fault diagnosis approaches untenable. Uncertain\n\ntest outcomes pose particularly difficult challenges to fault diagnosis: while, in a perfect\nbinary test outcome situation, a passed test indicates the normal status of its associated\ncomponents and a failed test implies the existence of at least one faulty component\nassociated with the test, neither can be inferred when the tests are imperfect.\n\n1.3.4\n\nApproach and Results\n\nWe address the multiple fault diagnosis using probabilistic graphical models in which\nthe failure sources have probabilistic cause-effect relations with the test outcomes.\nThese are performed using the detection and false alarm probabilities (DFA test model).\nAlso, we show that the DFA test model and the leaky noisy OR (LNOR) test model\n11\n\nare two different ways of representing the same uncertain test outcome phenomena. A\nunified test model is proposed to include both the LNOR and the logistic regression\n(LR) test models. The maximum a prosteriori inference for multiple fault diagnosis is\nderived for the unified test model and it is extended for fault prognosis. This work\nwas published in [11, 7]. Additional publication is planned [8].\n\n1.4\n\nContributions and Research Impact\n\nThe primary contributions of this thesis are:\n1. Deriving a closed form solution for determining the optimal battery charging\nprofile to minimize a weighted sum of time-to-charge and energy loss;\n2. Proving that for an OCV-Resistance battery model, CC-CV is the optimal\nsolution with respect to an objective function, composed of linear combination\nof time-to-charge and energy-loss.\n3. Deriving a semi-closed form solution for optimal battery charging profile by\nadding the temperature rise index to the cost function;\n4. Showing that the effect of temperature rise can be approximated as an equivalent\nheating resistance;\n5. Deriving the optimal battery charging profile for general equivalent electrical\ncircuit models as a linear quadratic - constant voltage (LQ-CV) strategy;\n6. Deriving two new battery capacity fade models that are shown to be statistically\nsuperior to the bi-exponential capacity fade model.\n12\n\n7. Developing an optimal charging parameter selection method for selecting the\nbest settings for the control variables to achieve a desired “useful cycle life”,\nwhile attaining the fastest possible time-to-charge;\n8. Proving the equivalence of the Detection-False Alarm (DFA) and the Leaky\nNoisy OR (LNOR) test models;\n9. Introducing a unified test model to include both the LNOR and the logistic\nregression (LR) test models;\n10. Solving the maximum a posteriori (MAP) inference problem associated with\nthe unified test model;\n11. Deriving a dual cost function for the fault diagnosis problem both in the DFA\ntest model and in the unified test model.\n12. Developing an algorithm for fault prognosis in systems using the unified test\nmodel.\nThe broader impacts of this thesis are as follows:\n1. Minimizing the life cycle cost of systems;\n2. Enhancing the safety and reliability of systems;\n3. Improving customer satisfaction through enhanced system availability;\n4. Utility in a large number of applications, including automotive systems, aerospace\nsystems, electrification of transportation, medical equipment, smart buildings/smart grid, and communication networks, to name a few.\n\n13\n\nChapter 2\nOptimal Battery Charging\n\n2.1\n\nIntroduction\n\nBattery charging is a problem of significant interest, especially as the battery-dependent\nsmart devices proliferate.The literature abounds with different strategies for charging\nbatteries. Among the traditional methods of charging, the simplest is the constant\ntrickle current charge strategy, which, due to its low charging current, requires a long\ncharging time (around 10 hours) [51]; constant current strategy with higher rates of\ncurrent requires shorter charging time. The most widely-used traditional strategy\nis the constant-current constant-voltage (CC-CV) [51] strategy, in which a constant\ncurrent is applied to the battery until the terminal voltage reaches a specified value,\nand afterwards the charging current decreases by applying a constant voltage to the\nterminals of the battery. In [89, 88], a multi-step constant-current charging is devised\nfor shortening the charging time and prolonging the cycle life of the battery. Using\northogonal arrays, Taguchi-based methods for battery charging [116, 188] present\n14\n\na systematic method to find the optimal solution with guidelines for choosing the\ndesign parameters. In [132], a boost charging strategy is proposed by applying\nvery high currents to close-to-fully discharged batteries. In pulse-charging methods\n[153, 202, 41, 42, 113], the battery is exposed to very short rest or even deliberate\ndischarging periods during the charging process. Soft-computing approaches are also\nused in the optimization of battery charging profile. In [117], the charging problem\nis viewed as an optimization problem with the objective function of maximizing the\ncharge within 30 minutes using a multistage constant current charging algorithm\nwhose optimal solution is obtained via an ant-colony approach. In [77], a universal\nvoltage protocol is proposed to improve charging efficiency and cycle life by applying\na charging profile depending on the state-of-health (SOH) of the battery, using SOH\nestimation approaches [78] in the optimization process. Recently, in [84], battery\ncharging is considered as an optimization problem with cost function of time-to-charge\nand energy loss (as we do in this paper), but they have not solved the problem\nanalytically; rather they have presented a numerical solution to the problem. Other\napproaches, such as genetic algorithm and neural network based strategies [148], data\nmining [12, 76], Grey-predicted charging system [43] have also been used for charging\nbatteries.\nIn this chapter, we look at the charging problem from a fresh perspective\nusing optimal control theory, and our goal is to find the optimal current profile that\nminimizes a specific cost function. In this sense, different objectives may be embedded\nin the cost function. One obvious cost function is the time-to-charge (TTC). We prefer\nto minimize the charging time as much as possible, as TTC reduction contributes to\nuser satisfaction. Another important objective is the energy loss (EL) during charging.\nReducing the energy loss increases the charging efficiency. In this paper, first we\n15\n\nuse an integrated cost function that includes both the TTC and EL. Then, we also\ninclude the effects of temperature into account, and the cost function is selected as\na linear combination of three criteria: time-to-charge, energy loss, and temperature\nrise index (TRI). In both cases, analytical solutions of the optimal charging problem\nare derived, when the battery model is considered as an Open-Circuit Voltage (OCV)\nand a resistance. When more complex models are adopted for the battery, we can no\nlonger obtain an analytic solution, but we can find a numerical algorithm to provide\nthe optimal charging profile.\nThis chapter is organized as follows. In section 2.2, we derive an analytical\nsolution for the optimal charging current profile to minimize TTC and EL, for OCVResistance model (referred to here as Model I). In section 2.3, we extend this approach\nto the case where temperature rise is considered as well. In section 2.4, we we derive the\noptimal charging profile, which is called LQ-CV (Linear QuadraticConstant Voltage),\nfor a general equivalent electrical model of battery. Section 2.5 is devoted to simulation\nresults and finally we summarize the chapter in section 2.6.\n\n2.2\n\nAnalytic Solution for Optimal Charging Current Profile for OCV-Resistance Model\n\nWe consider a simplified equivalent electrical circuit model of the battery as shown in\nFig. 2.2.2. The theory extends naturally to more complex models involving parallel\nRC elements (shown in Fig. 2.2.3), but, as we will discuss in section 2.4, the analytical\nclosed form solutions are not possible in the latter case. The model consists of a\nvoltage source corresponding to the open-circuit voltage (OCV), which is dependent\non the state of charge (SOC), and a resistance R0 . The SOC is denoted by s. The\n16\n\nequivalent electrical circuit models in Fig. 2.2.2 and Fig. 2.2.3, in this dissertation,\nare termed “model I” and “model II”, respectively, for the sake of consistency with\nprevious publications [20]. The OCV is a nonlinear function of SOC and is denoted\nby OCV (s[k]). In [20], OCV-SOC function is described as follows:\n\nss , E + s(1 − 2E)\n\n(2.2.1)\n\n−2\n−3\n−4\nOCV (ss ) = K0 + K1 s−1\ns + K2 ss + K3 ss + K4 ss + K5 ss + K6 ln(ss ) + K7 ln(1 − ss )\n\n(2.2.2)\nand E = 0.15. Note that the scaling of SOC in (2.2.1) is performed for numerical\nstability. For example, if s = 0, then ln(s) equals negative infinity, if the scaling is not\nused. K0 through K7 are some constants.\nFigure 2.2.1 depicts the OCV curve as a function of SOC for several commercial batteries.\n\n17\n\nFigure 2.2.1: OCV curve as a function of SOC\n\nThe state of charge is zero when the battery is totally discharged and it is\none if it is completely charged. The sampling time is denoted by ∆ (in seconds). We\nassume that the initial and final SOC are known: s[0] = s0 , s[kf ] = skf , where kf ∆ is\nthe charging time. We also assume that the maximum allowed value of the terminal\ncharging voltage is vc , that is, v[k] ≤ vc for all k. In this thesis, we consider charging\ncurrent as positive and discharging current as negative.\nThe SOC dynamics for the battery considering the foregoing model are as\nfollows:\n\ns[k + 1] = s[k] + ch i[k]\n18\n\n(2.2.3)\n\nwhere ch (in 1/Amperes) is the parameter in Coulomb counting, given by\n\nch =\n\n∆\n3600Q\n\nwhere Q (in Ah) is the battery capacity, assumed to be known.\n\nFigure 2.2.2: Equivalent electrical circuit model I of battery\n\nFigure 2.2.3: Equivalent electrical circuit model III of battery\n\n19\n\n(2.2.4)\n\nLet the objective function be a combination of TTC and EL. In other words,\nkf −1\n\nJ ̃tE = wt Jt + wE JE = wt kf ∆ + wE\n\nX\n\nR0 i2 [k]∆\n\n(2.2.5)\n\nk=0\n\nwhere Jt is the TTC cost function, JE is the EL cost function; wt and wE are weights\non the TTC and EL cost functions, respectively. The resistance of the battery, i.e.,\nR0 , is assumed to be known.\nThe charging problem then could be formulated as follows:\nMinimize J ̃tE subject to:\n\ns[k + 1] = s[k] + ch i[k] s[0] = s0\n\ns[kf ] = skf\n\n(2.2.6)\n\nOCV (s[k]) + R0 i[k] ≤ vmax\n\n(2.2.7)\n\ni[k] ≤ imax\n\n(2.2.8)\n\nIt is important to note that only the ratio of weights affects the optimal\ncurrent profile of i[k]. Therefore, by dividing (2.2.5) by wE , we redefine the cost\nfunction as follows:\nkf −1\n\nJtE = J ̃tE /wE = ρt Jt + JE = ρt kf ∆ +\n\nX\n\nR0 i2 [k]∆\n\n(2.2.9)\n\nk=0\n\nwhere ρt = wt /wE . Also note that when the current is injected into the battery, the\nOCV starts to increase and this, in turn, causes the terminal voltage to rise, until\nit reaches vmax , which is the maximum allowed terminal voltage. During the whole\ncharging process the current should not exceed imax , which is the maximum allowed\ncharging current. Selecting the optimal values of imax and vmax is discussed in chapter\n\n20\n\n4. In this chapter, we use vc for vmax , where vc is the voltage corresponding to SOC of\n1; that is\n\nvc = OCV(1)\n\n(2.2.10)\n\nAssume that at time k1 , the terminal voltage v[k1 ] reaches vc and let us\ndenote the state of charge at time k1 as s1 . After time k1 , the terminal voltage should\nbe fixed at the constant voltage (CV) vc ; hence, for k = k1 , k1 + 1, ..., kf − 1, the\ndynamics of the system are as follows:\n\ni[k] =\n\n1\n(vc − OCV(s[k]))\nR0\n\n(2.2.11)\n\ns[k + 1] = s[k] + ch i[k]\n\n(2.2.12)\n\ns[k1 ] = s1\n\n(2.2.13)\n\ns[kf ] = skf\n\nBefore going further, let us define a new equivalent problem as follows:\nMinimize\n\nJtE = ρt Jt + JE = ρt k1 ∆ +\n\nkX\n1 −1\nk=0\n\n21\n\nR0 i2 [k]∆\n\n(2.2.14)\n\nsubject to:\n\ns[k + 1] = s[k] + ch I[k] s[0] = s0\n\ns[k1 ] = s1\n\n(2.2.15)\n\nThis problem is in fact the minimization in the stage where the terminal\nvoltage is below vc and therefore here the condition OCV (s[k]) + R0 I[k] ≤ vc is not\nshown as we know that it holds.\nInspired by [186] and [60], we solve the problem in three steps as described\nbelow:\nÊ Given k1 (when the terminal voltage constraint becomes active), find the\noptimal current profile that minimizes the energy losses, and calculate the\ncorresponding energy losses as a function of k1 .\nË Generate a new equivalent cost function JtE∗ consisting of the weighted TTC\nplus the k1 -dependent minimum energy loss obtained in step 1, and find the\noptimal k1 based on this cost function.\nÌ Given the optimal k1 from step 2, evaluate the optimal current obtained in\nstep 1.\nIn the first step, assuming k1 is known, we find the optimal current i∗ [k|k1 ]\nthat minimizes the energy loss. Having this optimal current profile, we can calculate\nthe minimum EL cost function JE∗ (k1 ), which is a function of k1 . In the second step,\nwe use the partially optimized cost function JtE∗ = ρt k1 ∆ + JE∗ (k1 ) and we find the\noptimum value for k1 , say k1∗ . In the third step, we insert the optimal final time k1∗ into\nthe current i∗ [k|k1 ] (obtained in step 1) to find the optimal current i∗ [k]. Inserting\n22\n\nFigure 2.2.4: Minimization of time and energy loss\n∗\ni∗ [k] into the cost function, one can calculate JtE\n(k1∗ ). Figure 2.2.4 illustrates the\n\nabove three steps. In Fig. 2.2.4, think of k1 as the final time, and consider the problem\nof minimizing a “combination of time and energy loss”.\n\nNote that, given k1 , the term ρt k1 ∆ in (2.2.14) is constant and can be\ndropped; therefore, the first stage is formulated as follows:\nMinimize\n\nJE (k1 ) =\n\nkX\n1 −1\n\nR0 i2 [k]∆\n\n(2.2.16)\n\nk=0\n\nsubject to\n\ns[k + 1] = s[k] + ch i[k] s[0] = s0\n\n23\n\ns[k1 ] = s1\n\n(2.2.17)\n\nThe Hamiltonian function for this problem is\n\nH[k] = R0 i2 [k]∆ + λ[k + 1](s[k] + ch i[k])\n\n(2.2.18)\n\nThe following equations must hold for the optimal solution [30]:\n\n∂H[k]\n=0\n∂i[k]\n\n(2.2.19)\n\n∂H[k]\n∂s[k]\n\n(2.2.20)\n\n∂H[k]\n∂λ[k + 1]\n\n(2.2.21)\n\nλ[k] =\n\ns[k + 1] =\n\nFrom (2.2.19) we have\n\ni∗ [k] = −\n\nch λ[k + 1]\n2R0 ∆\n\nk = 0, 1, ...k1 − 1\n\n(2.2.22)\n\nFrom (2.2.20), we can write\n\nλ[k] = λ[k + 1] k = k1 − 1, ..., 0 λ[k1 ] = ν\n\n(2.2.23)\n\nwhere ν is the Lagrange multiplier associated with the constraint s[k1 ] = s1 . Equation\n\n24\n\n(2.2.23) implies that all co-states are equal; therefore, we can write\n\nλ[k] = ν\n\nk = 0, 1, ...k1\n\n(2.2.24)\n\nBased on (2.2.24), equation (2.2.22) can be written as\n\ni∗ [k] = −\n\nch ν\n2R0 ∆\n\nk = 0, 1, ..., k1 − 1\n\n(2.2.25)\n\nNote that equation (2.2.25) states that the optimal current is constant. From (2.2.21),\nwe can write\n\ns[k + 1] = s[k] + ch i[k]\n\n(2.2.26)\n\nwhich is actually the dynamics of the system. Knowing the initial state of charge (s0 ),\nand noting the optimal current in (2.2.25) is constant, we have\n\ns[k] = s0 + ch\n\nk−1\nX\n\ni[l] = s0 −\n\nl=0\n\nkc2h ν\n2R0 ∆\n\n(2.2.27)\n\nSince for k = k1 , we have s[k1 ] = s1 , therefore\n\ns1 = s0 −\n\nk1 c2h ν\n2R0 ∆\n\n(2.2.28)\n\nSolving for ν, we have\n\nν=−\n\n2R0 ∆(s1 − s0 )\nk1 c2h\n\n25\n\n(2.2.29)\n\nInserting (2.2.29) into (2.2.25), we have\n\ni∗ [k] =\n\ns1 − s0\nk1 ch\n\nk = 0, 1, ..., k1 − 1\n\n(2.2.30)\n\nInserting (2.2.30) into the cost function, the optimal cost function, given k1 is:\n\nJE∗ (k1 ) =\n\nkX\n1 −1\n\n\u0012\nR0\n\nk=0\n\ns1 − s0\nk1 ch\n\n\u00132\n∆=\n\nR0 ∆(s1 − s0 )2\nk1 c2h\n\n(2.2.31)\n\nNow, consider step 2 and define the cost function as\n\nJtE∗ = ρt k1 ∆ + JE∗ (k1 ) = ρt k1 ∆ +\n\nR0 ∆(s1 − s0 )2\nk1 c2h\n\n(2.2.32)\n\nTo find the optimum k1 , the following relations should hold:\n\nJtE∗ (k1 − 1) ≥ JtE∗ (k1 )\n\n(2.2.33)\n\nJtE∗ (k1 + 1) ≥ JtE∗ (k1 )\n\n(2.2.34)\n\nInserting (2.2.32) into (2.2.33) and (2.2.34) we obtain two second-order equations in\nterm of k1 . Solving these equations, we get k1− and k1+ , respectively, for relations\n(2.2.33) and (2.2.34).\n\nk1∓ =\n\n±1 +\n\nq\n2\n0)\n1 + 4R0 (sρt1c−s\n2\nh\n\n2\n\n(2.2.35)\n\nThe optimum k1 is ceil(k1− ) or floor(k1+ ). Since k1− − k1+ = 1, we have ceil(k1− ) =\n\n26\n\nfloor(k1+ ) = round((k1− + k1+ )/2). Thus,\ns\nk1∗ = round\n\n1 R0 (s1 − s0 )2\n+\n4\nρt c2h\n\n!\n(2.2.36)\n\nA more convenient way is to treat k1 in (2.2.32) as a continuous variable and\ntake derivative of (2.2.32) with respect to k1 as follows:\n∂JtE∗ (k1 )\nR0 ∆(s1 − s0 )2\n= ρt ∆ −\n=0\n∂k1\nk12 c2h\n\nk1∗ =\n\ns1 − s0\nch\n\ns\n\nR0\nρt\n\n(2.2.37)\n\n(2.2.38)\n\nNote that if we neglect 14 in (2.2.36), the argument of the rounded function in (2.2.36)\nis exactly the same as the one in (2.2.38).\nStep 3 involves inserting (2.2.38) into (2.2.30) to find the optimum current\ns1 − s0\ni [k] = ∗\n=\nk1 ch\n∗\n\nr\n\nρt\nR0\n\nk = 0, 1, ..., k1 − 1\n\n(2.2.39)\n\nRemark 2.2.1. If we put more emphasis on TTC (i.e., we increase ρt ), the optimal\ncurrent increases and TTC decreases. For an animation of the effect of ρt on the\noptimal current, the reader may refer to [1].\nRemark 2.2.2. When a battery ages, it experiences power fade which is equivalent\nto increasing the series resistance in the battery. Increasing the series resistance (i.e.,\nR0 ) results in a decrease in the optimal current and TTC increases. For an animation\nof the effect of power fade (increasing R0 ) on the optimal current, the reader may\n27\n\nrefer to [1].\nIt is seen that the optimal current is constant and is a function of the weight\non TTC and the series resistance. Therefore, the solution of optimal time-to-charge\nand energy loss (OtE) problem is a CC-CV profile with the current of the CC stage\ngiven by (2.2.39). Following the CC stage, from k1 to kf , one has the CV stage where\n\nv[k] = vc\n\nk = k1 , ..., kf\n\n(2.2.40)\n\nTo the best of our knowledge, this is the first time that it is proved that the\nwell-known CC-CV charging profile is the optimal solution of a particular optimization\nproblem, namely, the problem of minimizing the weighted sum of time-to-charge and\nenergy loss for the OCV-Resistance model in Fig. 2.2.2.\nIn the sequel, this profile is referred to as OtE profile or OtE policy.\nBefore we close this section, we point out another way of solving the OtE\nproblem of (2.2.14)-(2.2.15) by condensing (2.2.15) for all values of k into a single\ncondition. From (2.2.15) we can write\n\ni[k] = (s[k + 1] − s[k]) /ch\n\n(2.2.41)\n\nSince (2.2.41) holds for k = 0, 1, ..., k1 − 1, and using the initial and end\nvalues of SOC from (2.2.15) we can write:\nkX\n1 −1\n\ni[l] = (s1 − s0 )/ch\n\n(2.2.42)\n\nl=0\n\nTherefore, the problem of (2.2.14)-(2.2.15) is equivalent to a quadratic pro-\n\n28\n\ngramming problem with the constraint in (2.2.42). In this way, we are dealing with\ncurrents i[l] as our unknowns. It is easy to show that this results in the same solution\nas (2.2.39). This simplification of the dynamics of the system into the condensed\ncondition of (2.2.42) will be useful in the next section where we derive an analytical\nsolution when the cost function includes the summation of temperature rises as well.\nIt should be noted that the practical meaning of the parameters of optimization problem (e.g., wt and wE in (2.2.5) and ρt in (2.2.14)) is to use them in\nan iterative design procedure to reach the desired performance. For example, if the\nmaximum energy loss is Emax and the maximum time-to-charge is T T Cmax , then in\nthe design procedure, wt and wE should be selected inversely proportional to Emax\n1\nand T T Cmax , respectively; that is wt ∝ T T C1max , wE ∝ Emax\nand then iterate. Or\nmax\nmax\nequivalently, ρt should be selected proportional to T E\n; that is ρt ∝ T E\nand\nT Cmax\nT Cmax\nmax\nthen iterate on the proportionality factor. As T E\nis actually the power loss, ρt\nT Cmax\n\nshould be selected proportional to power loss.\n\n2.3\n\nOptimal Charging Problem Considering Temperature\n\nIn this section, we will extend the cost function to include the battery temperature\nvia temperature rise index (TRI, to be defined) as well as TTC and EL. To this\nend, we need a temperature model for the battery. The reader may refer to the\n“Appendix B” for details of temperature modeling. References [146] and [198] describe\nthe temperature model of the battery as a linear system with two states, namely, Tcore\nand Tair , and reference [147] uses the nonlinear heat transfer equation with a single\nstate. Our simulations show that the dynamics of Tair have negligible fluctuations\n29\n\naround the ambient temperature. Therefore, the temperature model, considered below,\ncan be simplified to the linear part of the heat transfer equation\n\nT [k + 1] = T [k] − a(T [k] − Tamb ) + bi2 [k]\n\n(2.3.1)\n\nwhere\n\na=\n\n∆\nmbatt Ch,batt REff\n\n(2.3.2)\n\nR0 ∆\nmbatt Ch,batt\n\n(2.3.3)\n\nis the cooling coefficient and\n\nb=\n\nHere, T is the battery core temperature in kelvin (K), Tamb is the ambient temperature\nin K, mbatt is the battery mass in kg, Ch,batt is the heat capacity of the battery in\nJ/(kg · K), and REff is the effective thermal resistance in K/W (kelvin/watt).\nDefining temperature rise (TR) as T̃ [k] = T [k] − Tamb and assuming T [0] =\nTamb , we can write\nT̃ [k + 1] = (1 − a)T̃ [k] + bi2 [k],\n\nT̃ [0] = 0\n\n(2.3.4)\n\nThe solution of (2.3.4) is\n\nT̃ [k] = b\n\nk−1\nX\n\n(1 − a)k−1−l i2 [l]\n\n(2.3.5)\n\nl=0\n\nEquation (2.3.5) states that the temperature rise at any time is the integral of the\n\n30\n\nsquare of current, from time zero up to that time with a ”forgetting factor” of (1 − a)\nand the scaling factor b.\nSince T̃ [k] is positive for any k, the cost function including TTC, EL and\nTR can be written as\n\nJtET = ρt Jt + JE + ρT JT\n\n(2.3.6)\n\nwhere Jt and JE are TTC and EL as before and JT is the temperature rise index\n(TRI) defined as follows:\n\nJT = ∆\n\nkf\nX\n\nT̃ [k]\n\n(2.3.7)\n\nT̃ [k + 1]\n\n(2.3.8)\n\nk=0\n\nSince T̃ [0] = 0, the TRI can be written as\nkf −1\n\nJT = ∆\n\nX\nk=0\n\nUsing (2.3.5) and (2.3.8), we can write (2.3.6) as follows\n\nkf −1\n\nJtET = ρt kf ∆ +\n\nX\n\nR0 i2 [k]∆\n\nk=0\nkf −1\n\n+ρT b∆\n\nk\nXX\n\n(1 − a)k−l i2 [l]∆\n\nk=0 l=0\n\n31\n\n(2.3.9)\n\nwhich can be simplified as follows\nkf −1\n\nJtET = ρt kf ∆ + ∆\n\nX\n\n\nkf −k−1\n\nR0 + ρT b\n\nX\n\n(1 − a)l   i2 [k]\n\n(2.3.10)\n\nl=0\n\nk=0\n\nSimplifying the inner summation and noting that b/a = R0 REff , we can write\nkf −1\n\nJtET = ρt kf ∆ + ∆\n\nX\n\nReq [k]i2 [k]\n\n(2.3.11)\n\nk=0\n\nReq [k] = R0 + RT [k]\n\nRT [k] = ρT R0 REff 1 − (1 − a)kf −k\n\n(2.3.12)\n\n\u0001\n\n(2.3.13)\n\nwhere RT [k] is the heating equivalent resistance. Assume, as before, that at time k1 ,\nthe terminal voltage v reaches its maximum allowable value of vc , and SOC reaches\ns1 . Given s1 and k1 , we can write the cost function as\n\nJ(s1 , k1 ) = ∆\n\nkX\n1 −1\n\nReq [k]i2 [k]\n\n(2.3.14)\n\nk=0\n\nNote that we discarded the contributions of i[k1 ], ..., i[kf − 1], because when the\nterminal voltage reaches vc the current is already determined by the constrained\ndynamics of the system in (2.2.11); we also discarded the contribution of kf , i.e.\nρt kf ∆, because: firstly, k1 is given; secondly, given s1 , kf − k1 is also known, which\nmeans kf is known. An important point to note is that, while the upper bound of the\nsummation in (2.3.14) is k1 − 1 , the formulation for Req , i.e., (2.3.12), considers the\n32\n\neffect of the whole charging time and it contains kf rather than k1 .\nNow, given s1 and k1 , we can state the optimal charging problem as follows:\nMinimize (2.3.14) subject to (2.2.42), or equivalently\n\nMinimize: L = J(s1 , k1 ) + λ\n\nkX\n1 −1\n\ns1 − s0\ni[l] −\nch\nl=0\n\n!\n(2.3.15)\n\nTaking the derivative of Lagrangian L with respect to i[k] for k = 0, 1, ..., k1 − 1 and\nequating it to zero, we have:\n\ni[k] = −\n\nλGeq [k]\nλ\n=−\n2Req [k]∆\n2∆\n\n(2.3.16)\n\nwhere Geq [k] = 1/Req [k] is the conductance. Taking the derivative of L with respect\nto λ, and using (2.3.16) we find the optimal current profile in the first stage as follows:\n\ni∗ [k] = −\n\nGeq [k] (s1 − s0 )\nkP\n1 −1\nGeq [k]\nch\n\nk = 0, 1, ..., k1 − 1\n\n(2.3.17)\n\nk=0\n\nWe refer to the current profile in (2.3.17) as the optimal time-to-charge,\nenergy losses and temperature rise (OtET) policy. Note that (2.3.17) is similar to\nwhat we obtained for the OtE case. In particular, if ρT = 0, then (2.3.17) will be\nthe same as (2.2.30). Also, comparing (2.3.16) with the OtE case and, noting that\nfor k = 0, 1, ..., k1 − 1, we can use the approximation of Req [k] ≈ R0 (1 + ρT REff ),\nanalogous to the optimal current profile of (2.2.39), we can write\n\n∗\n\ni [k] ≈\n\nr\n\nρt\nR0 (1 + ρT REff )\n\n33\n\nk = 0, 1, ..., k1 − 1\n\n(2.3.18)\n\nWe refer to the current profile of (2.3.18) as the near-optimal time-to-charge, energy\nloss and temperature rise (NOtET) policy.\n\n2.4\n\nLinear Quadratic- Constant Voltage (LQ-CV)\nStrategy Formulation\n\nIn this section, we investigate the battery charging problem using the equivalent\nelectrical circuit model (model III) shown in Fig. 2.4.1.\n\nFigure 2.4.1: Equivalent electrical circuit model III of battery\n\nCompared to the model discussed in subsection 2.2, it includes an extra\nRC circuit (R1 and C1 ). Let the current (in continuous time) through R0 and R1\nbe i(t) and i1 (t), respectively, and let the current through and the voltage across\nc (t)\nthe capacitor C1 be, respectively, ic (t) and vc (t). Then, we have: ic (t) = C1 dvdt\n,\nc (t)\n1 (t)\n1 (t)\n1 (t)\nic (t) = i(t) − i1 (t), dvdt\n= R1 didt\n, didt\n= lim i1 (t+∆)−i\n. Using these relations\n∆\n\n∆−→0\n1\n∆\nand inserting R1 lim 1−exp(−∆/(R1 C1 )) for C1 , one can derive the following relation in\n∆−→0\n\n34\n\nthe discrete form:\n\ni1 [k + 1] = αi1 [k] + (1 − α)i[k]\n\n(2.4.1)\n\nwhere i1 [k] and i[k] are i1 (k∆) and i(k∆), respectively; ∆ is the sampling interval\n(typically 0.1 to 1 second, and assumed constant for simplicity of notation), and α is\nas follows:\n\nα = exp(−\n\n∆\n)\nR1 C1\n\n(2.4.2)\n\nThe dynamic evolution of the battery state-of-charge (SOC), s, is given by\n\ns[k + 1] = s[k] + ch i[k]\n\n(2.4.3)\n\nwhere s[k] is the SOC at time k and ch (in 1/Amperes) is the Coulomb counting\ncoefficient, given by\n\nch =\n\n∆\n3600Q\n\n(2.4.4)\n\nwhere ∆ is the time step (typically 0.1 to 1 second) and Q (in Ah) is the battery\ncapacity, assumed to be known. It is assumed that the charging process takes kf ∆\nseconds (kf unknown and to be optimized), to attain a specified final desired SOC of\nskf . That is,\n\ns[kf ] = skf\n\n35\n\n(2.4.5)\n\nWe consider a cost function composed of time-to-charge (TTC), energy loss (EL) in\nR0 and R1 , and a temperature rise index (TRI). To have more flexibility in controlling\nthe time to charge and the trajectory of SOC during charging, we also include a term\nincluding the sum of the squares of the difference of SOC at various times of the\ncharging interval from the final desired SOC.\nThe cost function is, therefore, as follows:\n\nJtEsT = ρt Jt + JE + ρs Js + ρT JT\n\n(2.4.6)\n\nJt = kf ∆\n\n(2.4.7)\n\nwhere\n\nkf −1\n\nJE = ∆\n\nX\n\n(R0 i2 [k] + R1 i21 [k])\n\n(2.4.8)\n\nk=0\n\nkf −1\n\nJs =\n\nX\n\n(s[k] − skf )2\n\n(2.4.9)\n\nk=0\n\nJT = ∆\n\nkf\nX\nk=0\n\n36\n\nT̃ [k]\n\n(2.4.10)\n\nwhere T̃ [k] is the temperature rise from the ambient temperature, Tamb ; that is\n\nT̃ [k] = T [k] − Tamb\n\n(2.4.11)\n\nSince it is the ratio of the weights that matters, we have assigned a weight of 1 to the\nenergy loss cost function, i.e., JE .\nRemark 2.4.1. In (2.4.9), one can replace skf with sd (k), the desired SOC at time\nk\n\nf\nstep k, for the charging process to follow a desired sequence of SOCs {sd (k)}k=0\n.\n\nRemark 2.4.2. The cost function can include other functions of the SOC and the\nmethod that we discuss is still applicable. One such candidate is the following term,\nwhich corresponds to sum of squares of cumulative SOC difference from the final\ndesired SOC.\n\nkf −1\n\nJS =\n\nX\n\nk−1\nX\n\nk=0\n\nl=0\n\n!2\n(s[l] − skf )\n\n(2.4.12)\n\nThe temperature dynamics are as follows (For more details about thermal\nmodels refer to [5, 146, 198, 134, 147, 199, 206, 81]):\n\nT̃ [k + 1] = (1 − a)T̃ [k] + b0 i2 [k] + b1 i21 [k]\n\n(2.4.13)\n\nwhere a is the cooling coefficient (see (B.0.21)). Note that equation (2.4.13) is\nsimilar to (2.3.4), except that here we have the effect of current i1 too. The reader\nmay refer to the “Appendix B” for details of temperature modeling.\n37\n\nb0 =\n\nR0 ∆\nmbatt Ch,batt\n\n(2.4.14)\n\nb1 =\n\nR1 ∆\nmbatt Ch,batt\n\n(2.4.15)\n\nand Ch,batt is the heat capacity of the battery (see (B.0.21)). The solution of\n(2.4.13) is as follows:\n\nT̂ [k] =\n\nk−1\nX\n\n(1 − a)k−1−l (b0 i2 [l] + b1 i21 [l])\n\n(2.4.16)\n\nl=0\n\nSimilarly to subsection 2.3, the cost function due to temperature, i.e., JT ,\ncan be written as follows:\n\nkf −1\n\nJT = ∆\n\n\nk=0\n\n\nkf −k−1\n\nX\n\nX\n\n\n(1 − a)l   (b0 i2 [l] + b1 x2 [l])\n\n(2.4.17)\n\nl=0\n\nCalculating the summation of (1 − a)l and noting that b0 /a = R0 REff and\nb1 /a = R1 REff , we can write\n\nkf −1\n\nJT = ∆\n\nX\n\nR0eq [k]i2 [k] + R1eq [k]i21 [k]\n\nk=0\n\n38\n\n(2.4.18)\n\nR0eq [k] = R0 + R0T [k]\n\nR0T [k] = ρT R0 REff 1 − (1 − a)kf −k\n\n(2.4.19)\n\n\u0001\n\nR1eq [k] = R1 + R1T [k]\n\nR1T [k] = ρT R1 REff 1 − (1 − a)kf −k\n\n(2.4.20)\n\n(2.4.21)\n\n\u0001\n\n(2.4.22)\n\nwhere R0T [k] and R1T [k] are the heating equivalent resistances respectively due\nto R0 and R1 . To simplify the equations, we define the following state vector:\n\n\ns[k] − skf\nz[k] =\n\ni1 [k]\n\n(2.4.23)\n\nThe dynamics of z[k] with its initial and final states could be written as\nfollows:\n\nz[k + 1] = Φz[k] + Γi[k]\n\n39\n\n(2.4.24)\n\n\n1 0\nΦ=\n\n0 α\n\u0014\n\u0015T\nΓ = ch , 1 − α\n\n(2.4.25)\n\n(2.4.26)\n\n\u0015T\n\n\u0014\n\nz[0] = s0 − skf , 0\n\u0014\n\u0015T\nz[kf ] = 0, free\n\n(2.4.27)\n(2.4.28)\n\nThe battery terminal voltage is then as follows:\n\u0014\n\n\u0015\n\nv[k] = OCV (s[k]) + R0 i[k] + 0 R1 z[k]\n\n(2.4.29)\n\nwith following constraints:\n\nv[k] ≤ vmax\n\n(2.4.30)\n\ni[k] ≤ imax\n\n(2.4.31)\n\nSelecting the optimal values of imax and vmax is discussed in chapter 4. In this section,\nwithout loss of generality, we use vc for vmax , where vc is the voltage corresponding to\nSOC of 1; that is\n\nvc = OCV(1)\n\n40\n\n(2.4.32)\n\nUsing the above notations, we can write the cost function as follows:\n\nJtEsT = ρt kf ∆ +\n\nkf −1 \u0010\n\nX\n\n\u0011\n∆R0eq [k]i2 [k] + z T [k]Q̃[k]z[k]\n\n(2.4.33)\n\nk=0\n\nwhere\n\n\n0\nρs\n\nQ̃[k] =\n\n0 ∆R1eq [k]\n\n(2.4.34)\n\n(2.4.35)\n\nSimilarly to section 2.2, we divide the charging process into two stages: in\nthe first stage that lasts for k1 samples, the battery terminal voltage is less than vc .\nThat is\n\nv[k] < vc\n\nk = 0, 1, ..., k1 − 1\n\n(2.4.36)\n\nand in the second stage which starts at time k1 onwards, the battery terminal voltage\nis equal to vc . That is\n\nv[k] = vc\n\nk = k1 , k1 + 1, ..., kf\n\n(2.4.37)\n\nAs the voltage hits the boundary value of vc at time k1 , and remains constant\nfrom then on, the current in stage 2 is already determined by the constrained dynamics\n\n41\n\nof the system, as follows:\nvc − OCV − R1 i1 [k]\nR0\n\nk = k1 , k1 + 1, ..., kf\n\n(2.4.38)\n\nx[k] = αi1 [k − 1] + (1 − α)i[k − 1]\n\nk = k1 , k1 + 1, ..., kf\n\n(2.4.39)\n\ni[k] =\n\nwith the following initial values\n\ni[k1 − 1] = ik1 −1\n\n(2.4.40)\n\ni1 [k1 − 1] = i1k1 −1\n\n(2.4.41)\n\nwhere ik1 −1 and i1k1 −1 are the initial values of the currents for stage 2, which are equal\nto the final values of currents for stage 1.\nThe current profile in stage 1 is obtained by solving a linear quadratic (LQ)\nproblem. The following algorithm finds the optimal current profile in stage 1.\nAlgorithm: For a given k1 value, the optimal current profile in stage 1 (the\nLQ stage) is obtained as follows:\n\ni[k] = − 2∆RΓ0eq [k] P [k + 1] (I3 + Ψ[k]P [k + 1])−1 Φz[k] − Ψ[k]g[k + 1]ν\nT\n\n\u0001\u0001\n\n+ g[k + 1]ν\n\n\u0001\n\n(2.4.42)\nwhere ν and Ψ[k] are given by:\n\nν=\n\ns1 − skf − g T [0]z[0]\nω[0]\n\n42\n\n(2.4.43)\n\nΨ[k] =\n\nΓΓT\n2∆R0eq [k]\n\n(2.4.44)\n\nz[0] is the initial state, and g[0] and ω[0] are calculated by solving the\nfollowing backward set of recursions:\n\nP [k] = 2Q̃[k] + ΦT P [k + 1] (I3 + Ψ[k]P [k + 1])−1 Φ\ng[k] = ΦT (I3 + P [k + 1]Ψ[k])−1 g[k + 1]\n\n(2.4.45)\n\nω[k] = ω[k + 1] − g T [k + 1] (I3 + Ψ[k]P [k + 1])−1 Ψ[k]g[k + 1]\nwith the following terminal values:\n\n\n0 0\nP [k1 ] =\n\n0 0\n\u0014\n\u0015T\ng[k1 ] = 1 0\n\n(2.4.46)\n\nω[k1 ] = 0\nThe derivation of this algorithm is presented in the “Appendix C”.\nBased on the above, the numerical calculation of the optimal current is\ncomputed via the following steps:\nold\nÊ Set JtEsT\nto a big value (for example, in Matlab, set it as ”Inf”).\n\nË Initialize k1 with 1.\nÌ Solve the set of equations (2.4.45) with the terminal values in (2.4.46).\nÍ Calculate the current in stage 2 (the CV stage) by assuming the terminal\n43\n\nvoltage as vc until the SOC reaches the desired value of skf .\nÎ Calculate the cost function based on the current profiles of stage 1 and\nnew\nstage 2 and assign it to JtEsT\n.\nnew\nold\nÏ If JtEsT\n> JtEsT\n, the optimal k1 is the previous value and the optimal\n\ncurrent profile was obtained in the previous step; otherwise, go to next step.\nÐ Solve the set of recursions (2.4.45) for one step with the terminal values\nobtained in the previous step.\nÑ Go to step ”Í”.\nIt is important to note that although the optimal current profile is derived for\nmodel III (see Fig. 2.4.1), the method is generic and it is applicable to any equivalent\nelectrical circuit model, with an enlarged state vector z[k].\nIt should be noted that the practical meaning of the parameters of optimization problem (e.g., ρt , ρs , and ρT in (2.4.6)) is to use them in an iterative design\nprocedure to reach the desired performance. For example, if the maximum allowed\nenergy loss is Emax and the maximum acceptable time-to-charge is T T Cmax , then in\nmax\nmax\nthe design procedure, ρt should be selected proportional to T E\n; that is ρt ∝ T E\nT Cmax\nT Cmax\n\nand then iterate on the proportionality factor.\n\n2.5\n\nSimulations\n\nIn this section, we present simulations based on the theoretical foundations of the\nprevious sections.\n\n44\n\n2.5.1\n\nModel I\n\nVerification of the Optimal Solution\nHere, we apply different levels of current and the simulation is run until the terminal\nvoltage reaches vc and after that a constant voltage of vc is applied until the battery is\ncharged to skf . Five different current profiles are chosen including the optimal current\nprofile (Fig. 2.5.1). The optimal current profile as mentioned before has the value of\nq\nρt\nin the CC stage. The battery parameters of Nokia BP-4L (Cell#3), given in\nR0\nthe “Appendix A”, are used. The following simulation parameters are used: ρ = 1,\n∆ = 1(s), s0 = 0, skf = 1.\nThe “Appendix A” also shows the parameters of the OCV curve (calculated\nbased on [20]). The OCV is a function of SOC s as in [20].\n\nss , E + s(1 − 2E)\n\n(2.5.1)\n\n−2\n−3\n−4\nOCV (ss ) = K0 + K1 s−1\ns + K2 ss + K3 ss + K4 ss + K5 ss + K6 ln(ss ) + K7 ln(1 − ss )\n\n(2.5.2)\nand E = 0.15. Fig. 2.5.1 shows the current profiles with different levels of\ncurrent in the CC stage. As seen from Fig. 2.5.1, at lower levels of current, the CC\nstage will take a longer time and the terminal voltage reaches the threshold voltage of\nvc at a later time. At higher levels of current, however, the OCV grows more rapidly.\nAs the terminal voltage is v[k] = OCV (s[k]) + R0 i[k], at higher levels of current the\nthreshold voltage of vc is reached in a shorter time.\n\n45\n\n2\n\n1.5\n\n0.105\n\nc u rren t\n\n0.1\n0.095\n\n1\n\n0.09\n\n7450\n\n7500\n\n7550\n\n7600\n\n7650\n\nprofile # 1\nprofile # 2\nprofile # 3 (optimal)\nprofile # 4\nprofile # 5\n\n0.5\n\n0\n0\n\n1000\n\n2000\n\n3000\n\n4000\ntime (sec)\n\n5000\n\n6000\n\n7000\n\n8000\n\nFigure 2.5.1: Five different current profiles (including the optimal profile)\n\nFig. 2.5.2(a) shows the cost function JtE for the five current profiles of Fig.\n2.5.1 and Fig. 2.5.2(b) shows the corresponding current levels in the CC stage. It\nis seen that the optimal current profile (i.e., profile 3) has the lowest cost function.\nDeviating from this profile, either by increasing or decreasing the current in the CC\nstage, results in an increase in the cost function. For the lower current levels (profiles\n1-2), the rise in the cost function is due to a rise in TTC and for higher current levels\n(profiles 4-5) the rise in cost function is due to rise in EL.\n\n46\n\n(a)\n9580\n\nJ\n\n9570\n9560\n9550\n1\n\n2\n\n3\nprofile number\n(b)\n\n4\n\n5\n\n1\n\n2\n\n3\nprofile number\n\n4\n\n5\n\ncurrennt\n\n2\n1.8\n1.6\n1.4\n\nFigure 2.5.2: Five different current profiles: a) cost functions b) current levels in CC stage\n\nEffect of Weights\nIn this subsection, we use different cost functions and find the corresponding optimal\nprofiles. Different values of ρt from 0.1 to 0.5 are chosen. Figures 2.5.3, 2.5.4, and\n2.5.5, respectively, show the profiles of current, state of charge and terminal voltage.\nFig. 2.5.3 shows that low values of ρt result in low values of current in the CC stage.\nIn other words, a low ρt puts less emphasis on charging time and more emphasis on\nthe energy losses; hence, it results in low level of current which provides low energy\nlosses. On the other hand, by increasing ρt , more emphasis is placed on the charging\n√\ntime. Consequently, the level of current is increased proportionally to ρt to reduce\nthe TTC.\n\n47\n\n1.4\n\nρt = 0.1\nρ = 0.25\n\n1.2\n\nt\n\nρt = 0.5\n\ncurrent (A)\n\n1\n0.8\n0.6\n0.4\n0.2\n0\n0\n\n20\n\n40\n\n60\n\n80\n\n100\ntime (min)\n\n120\n\n140\n\n160\n\n180\n\n200\n\nFigure 2.5.3: Current profiles for different values of ρt\n\nFig. 2.5.4 shows the state-of-charge profiles for different values of ρt . It is\nseen that by increasing ρt , more emphasis is placed on charging time and the SOC\nreaches the final value in a shorter time. Fig. 2.5.5 shows the terminal voltage profiles\nfor different values of ρt . Note that for low values of ρt , as the emphasis on energy loss\nis high, the corresponding current level in CC is low, and consequently, the terminal\nvoltage reaches the threshold value of vc at a later time. Hence, the duration of CC\nstage is high and the charging time is high as well.\n\n48\n\n1\n0.9\n\nρt = 0.1\n\n0.8\n\nρt = 0.25\nρt = 0.5\n\nSOC\n\n0.7\n0.6\n0.5\n0.4\n0.3\n0.2\n0\n\n20\n\n40\n\n60\n\n80\n\n100\ntime (min)\n\n120\n\n140\n\n160\n\n180\n\n200\n\nFigure 2.5.4: SOC profiles for different values of ρt\n\n4.25\n4.2\n\nv (volt)\n\n4.15\n\nρt = 0.1\nρ = 0.25\nt\n\n4.1\n\nρt = 0.5\n\n4.05\n4\n3.95\n3.9\n0\n\n20\n\n40\n\n60\n\n80\n\n100\ntime (min)\n\n120\n\n140\n\n160\n\n180\n\n200\n\nFigure 2.5.5: Voltage profiles for different values of ρt\n\nFig. 2.5.6 shows the time-to-charge, energy losses and efficiency as functions\nof ρt . As expected, high values of ρt result in lower TTC. The low TTC, however, is\n49\n\nobtained by increasing the current level; as EL is proportional to the square of current,\nthus the high values of ρt result in high values of EL. The high values of EL mean\nthat a higher fraction of input power is wasted; hence it is equivalent to a decline in\n\nEL\n\n200\n150\n0.1\n\n0.15\n\n0.2\n\n0.25\n\n0.3\n\n0.35\n\n0.4\n\n0.45\n\n0.5\n\n1400\n1200\n1000\n800\n0.1\n\n0.15\n\n0.2\n\n0.25\n\n0.3\n\n0.35\n\n0.4\n\n0.45\n\n0.5\n\nEfficiency %\n\nTTC (min)\n\nefficiency.\n\n0.15\n\n0.2\n\n0.25\n\n0.3\nρt\n\n0.35\n\n0.4\n\n0.45\n\n0.5\n\n96\n95\n94\n93\n0.1\n\nFigure 2.5.6: TTC, El and efficiency curves for different values of ρt\n\nFig. 2.5.7 shows the time-to-charge versus efficiency (ratio of effective to\ntotal energy) curve. TTC and efficiency are two counteracting objectives. For low\nvalues of ρt , as less emphasis is put on TTC, the TTC is high; however, high TTC\nis the result of low current values, which incur low energy losses and hence higher\nefficiency. For example at ρt = 0.1, the TTC is 195 minutes, but the efficiency is as\nhigh as 95.82%. On the other hand, for high values of ρt which place more emphasis on\nTTC, the TTC is reduced dramatically; however, low TTC is achieved by increasing\nthe current values, which results in high energy losses and hence lower efficiency. For\nexample, at ρt = 0.5, the TTC is as low as 148 minutes, but the efficiency decreases\nto 92.87%.\n50\n\n200\n\nρ = 0.1\nt\n\nη = 95.82%\nTTC = 195 (min)\n\n190\n\nTTC (min)\n\n180\n170\n160\n\nρ = 0.5\nt\n\nη = 92.87%\nTTC = 148 (min)\n\n150\n140\n92.5\n\n93\n\n93.5\n\n94\n94.5\nEfficiency %\n\n95\n\n95.5\n\n96\n\nFigure 2.5.7: TTC versus efficiency\n\nTemperature Effect\nIn this section, we consider the effect of temperature rise index (TRI) on optimal\ncharging. The cost function is a weighted sum of TTC (seconds), EL (Joules) and\nTRI (Kelvin seconds), given by\n\nJtET = ρt × T T C + EL + ρT × T RI\n\n(2.5.3)\n\nWe used two sets of thermal parameters, shown in Table 2.5.1. Parameter set ”A”\nis adopted from [198]. Parameter set ”B” is a scaled version of parameter set ”A”\nwith mbatt set as the weight of Nokia BP-4L. For each set of thermal parameters\n(”A” or ”B”), the weights of the cost function are chosen as ρt = 1, ρT = 1 and\nρt = 1, ρT = 4. Three schemes are used: OtE (equations (2.2.39) and (2.2.40)), OtET\n(equations (2.3.17) and (2.2.40)), and NOtET (equations (2.3.18) and (2.2.40)). The\n\n51\n\ncost function in (2.5.3) or (2.3.6) is calculated for the three schemes. Table 2.5.2\nshows the cost functions of the three schemes for different weightings. As seen from\nthis table, the cost function for the OtE has the highest value. Also the difference\nbetween the cost function of OtET and NOtET is negligible with the OtET being\nslightly smaller when thermal parameter set ”A” is used. For thermal parameter set of\n”B”, there is visually no difference between NOtET and OtET. Due to this negligible\ndifference in the cost function and also since the calculation of NOtET profile is much\neasier than that of the OtET, it is reasonable to use NOtET rather than the OtET\nscheme. Also note that the weight on TRI results in a reduction of current, as can be\nseen from Figure 2.5.8. This reduction in current level results in a lower temperature\nrise (see Figure 2.5.9 ). In other words, energy losses with Req instead of R0 can be\nused as a surrogate cost function for the TRI.\nTable 2.5.1: Battery thermal paramters\n\nParamter Set mbatt (kg) REff (K/W) Ch,batt (J/(kg.K))\nA\nB\n\n0.37824\n0.080\n\n7.8146\n1.6528\n\n795\n168.15\n\nTable 2.5.2: Cost function for different schemes\n\nρt\n\nρT\n\n1\n1\n1\n1\n\n1\n4\n1\n4\n\nOtE\n\nJtET\nNOtET\n\nOtET\n\nA 26734\nA 72023\nB 14970\nB 24966\n\n22206\n38996\n14696\n21272\n\n22198\n38960\n14696\n21271\n\nThermal Parameters\n\n52\n\nOtE\nOtET\nNOtET\n\n1.5\n\ncurrent (A)\n\n0.024\n0.022\n\n1\n\n0.02\n\n222 222.5 223 223.5 224 224.5\n\n0.5\n\n0\n0\n\n50\n\n100\ntime (min)\n\n150\n\n200\n\nFigure 2.5.8: Current profiles for ρt = 1, ρT = 1 and temperature parameter set ”A”\n\n300.5\n\ntemperature (K)\n\n300\n\nOtE\nOtET\nNOtET\n\n298.255\n298.25\n\n299.5\n\n298.245\n\n222\n\n223\n\n224\n\n299\n298.5\n298\n0\n\n50\n\n100\ntime (min)\n\n150\n\n200\n\nFigure 2.5.9: Temperature profiles for ρt = 1, ρT = 1 and temperature parameter set ”A”\n\n53\n\nAnalysis of Different Commercial Batteries\nIn this subsection, we discuss the behavior of different commercial batteries. The\nparameters of the investigated batteries are given in the “Appendix A”. Note that\nthe equivalent electrical circuit parameters given in Table A.0.1 are for model III (see\nFigure 2.2.3). In simulations, we use the summation of “R0 + R1 ” of model III as\nan estimate of resistance R0 in model I. The batteries are Samsung EB575152 (four\ncells), Samsung EB504465 (four cells), Samsung AB463651 (two cells), Nokia BP-4L\n(four cells), LG LGIP (two cells).\nNext, we apply the OtE algorithm with ρt = 0.5 to 16 commercial batteries\nto investigate the times-to-charge and efficiencies of the batteries. The parameters of\nthe batteries, i.e., the electrical parameters of the models in Fig. 2.2.2 and 2.2.3, and\nthe parameters of OCV function in (2.5.2), were calculated using experimental data\nand by applying the BFG algorithms in [20]. These parameters are listed in Tables\nA.0.1 and A.0.2 in the Appendix. Fig. 2.5.10 shows the TTC versus efficiency for\ndifferent types of batteries. Among all batteries, Sam-EB575152 (Cell 3) has the lowest\nefficiency (90.73%). This can be attributed to the high resistance of this battery, which\nmight be due to aging. Sam-EB504465 (Cell 4) has the highest TTC (102 minutes)\nand Nokia BP-4L (Cell 4) has the highest efficiency. Note that the cells of the same\nbattery are close to each other in terms of efficiency and TTC. Considering all the\ncells of a battery, we can say that LG-LGIP cells (circle markers) have the highest\nefficiency (91.4%) . Fig. 2.5.11 shows the cost function values of JtE = ρt Jt + JE .\nWhen TTC is weighted with weight value of ρt = 0.5, Sam-EB575152 (Cell 2) has the\nbest performance.\n\n54\n\nFigure 2.5.10: Time-to-charge versus efficiency of different battery types at 25◦ C\n\nFigure 2.5.11: Cost function for different battery types at 25◦ C, ρt = 0.5\n\n55\n\n2.5.2\n\nModel III\n\nEffect of Weights\nIn this subsection, we use different cost functions and find the corresponding optimal\nprofiles for Model III. First, we set ρs = ρT = 0, and we change the values of ρt from\n0.1 to 0.5. Figures 2.5.12, 2.5.13, and 2.5.14, respectively, show the profiles of current,\nstate of charge and terminal voltage. Fig. 2.5.12 shows that low values of ρt result\nin low values of current in stage 1 (LQ stage). In other words, a low ρt puts less\nemphasis on charging time and more emphasis on the energy losses; hence, it results\nin low level of current which provides low energy loss and higher charging efficiency.\nOn the other hand, by increasing ρt , more emphasis is placed on the charging time.\n\nFigure 2.5.12: Current profiles for different values of ρt\n\n56\n\nFigure 2.5.13: SOC profiles for different values of ρt\n\nFigure 2.5.14: Terminal voltage profiles for different values of ρt\n\n57\n\nFigure 2.5.15: Current profiles for different values of ρT\n\nNext, we consider the effects of ρT and ρs , and we compare the results to\nthe case when these weights are zero. Figure 2.5.15 shows the optimal current profile\nfor three different weight sets. The blue curve represents the optimal profile when\nρt = 0.5, ρs = 0, , ρT = 0. Here there is no penalty on the temperature rise and the\nsquared difference of the SOC and the final desired SOC (skf ). When we change ρT\nfrom zero to 0.5, the emphasis on the temperature rise results in a decrease in the\nmagnitude of current, as depicted by the blue and red curves in Fig. 2.5.15. The\ngreen curve shows the optimal current profile when we set ρs to 0.1 as well. Here, the\npenalty on the squares difference of the SOC and the final desired SOC (skf ) results\nin an increase in the current level.\n\n58\n\n2.6\n\nSummary\n\nThe optimal charging problem involving a weighted combination of time-to-charge\n(TTC), energy loss (EL) and temperature rise index (TRI) was considered. The\noptimal TTC and EL solution (OtE) is found to be the well-known CC-CV strategy\nwith the value of current in the CC stage being a function of the ratio of weighting\non TTC and EL and also the resistance of battery. To the best of our knowledge,\nthis is the first time that it is proved that the well-known CC-CV charging profile\nis the optimal solution of a particular optimization problem, namely, the problem\nof minimizing the weighted sum of time-to-charge and energy loss. In addition, an\nanalytical solution for the optimal TTC, EL and TRI, referred to as OtET, was\ndeveloped. Due to similarity of the structure of the OtE and OtET solutions, a\nnear-optimal version of OtET was developed (referred to as NOtET). The NOtET\nis a CC-CV strategy with the value of current in the CC stage being a function of\nthe ratio of weighting on TTC and EL, the resistance of the battery and the effective\nthermal resistance. Then, we presented a linear quadratic optimization approach and\nits solution to optimally charging a Li-ion battery in a general form. The optimal\nprofile was derived based on a cost function, which is a weighted sum of time-to-charge\n(TTC), energy loss (EL), sum of the squares of the differences of the state-of-charge\n(SOC) from the final desired SOC, and temperature rise index (TRI). The presented\nsolution strategy is generic and it is applicable to any equivalent electrical circuit\nmodel of a battery. A number of simulations were conducted to evaluate the effect\nof weighting parameters. Finally, extensive results on industrial batteries from LG,\nNokia and Samsung were presented.\n\n59\n\nChapter 3\nCapacity Fade Modeling\n\n3.1\n\nIntroduction\n\nIn this chapter, we propose two models, namely LAR-αβγ and CVD, to estimate\nthe normalized capacity (and, equivalently, the capacity fade) as a function of the\ncycle number. The motivation for developing a capacity fade model is that, for the\nlevel-I control policy (to be presented in the next chapter), we need a capacity model\nthat considers both the current and the terminal voltage as control parameters of the\nmodel. In other words, this chapter is a precursor to the next chapter. These models\nare developed by exploring a number of models with different fitting methods. The\ndevelopment of the models is based on the data obtained from the aging experiments,\nwhich are detailed in section 3.2. Let n denote the cycle number. The capacity at cycle\nn, denoted by Q[n], is calculated by trapezoidal integration of the injected current\nduring the charging process, which is also referred to as the Coulomb counting. In\neach experiment, the calculated capacities Q[n] are normalized by dividing them by\n60\n\nthe capacity of the battery at the first cycle, i.e., Q[1], and the resulting normalized\ncapacities are denoted by Qnorm [n]; that is\n\nQnorm [n] =\n\nQ[n]\nQ[1]\n\nn = 1, 2, . . .\n\n(3.1.1)\n\nThese normalized capacities are used for fitting the capacity models.\nThis chapter is organized as follows. In section 3.2, we explain how the aging\nexperiments have been conducted. In section 3.3, we propose LAR-αβγ model. Then,\nin section 3.4, we study the LS-BE model. The comparison of the LAR-αβγ and the\nLS-BE models is presented in section 3.5. In section 3.6, we present the CVD model,\nwhich is a function of control variables vmax and imax . The comparison of the CVD\nand the LS-BE models is presented in section 3.7. In section 3.8, using the CVD\nmodel, we analyze the effect of current and terminal voltage on capacity fade. Finally,\nin section 3.9, we summarize the chapter.\n\n3.2\n\nAging Experiments\n\nIn order to study the effects of aging on capacity, ten different experiments were\nperformed. The batteries used in these experiments were Samsung GS4 with a\ncapacity of 2600 mAh and a nominal terminal voltage of 4.35 volts. The batteries\nwere exposed to several (from 25 to 200) cycles of charging and discharging with a 10\nminute rest after any charge or discharge process. The experiments were performed at\nroom temperature (25 ◦ C) using Keithley 2651A [2]; descriptions of the experiments\nare provided in Table 3.2.1. Seven different charge profiles (Ch1-Ch7) were used\nand are described in Table 3.2.2. Note that 1.0C for GS4 battery corresponds to 2.6\n61\n\namperes. All the charge profiles are terminated once the charge current falls below\n1\nC or, equivalently, 130 mA. Three different discharge profiles, namely Disch1-Disch3,\n20\n\nwere used. Table 3.2.3 describes the discharge profile Disch1, which has been used in\nall experiments except 2 and 10. The profile Disch2 is similar to Disch1, except that\n0.25C is used for stage 1, 0.5C for stage 2, and 0.2C for stage 3. The profile Disch3\nconsists of only one stage: discharge at 0.2C until the terminal voltage reaches 2.8V.\nTable 3.2.1: List of aging experiments\n\nExperiment ID\n\nCharge Profile\n\nDischarge Profile\n\nNumber of Cycles\n\n1\n\nCh1\n\nDisch1\n\n200\n\n2\n\nCh2\n\nDisch1\n\n125\n\n3\n\nCh3\n\nDisch1\n\n75\n\n4\n\nCh3\n\nDisch3\n\n75\n\n5\n\nCh4\n\nDisch1\n\n50\n\n6\n\nCh4\n\nDisch2\n\n50\n\n7\n\nCh5\n\nDisch1\n\n50\n\n8\n\nCh2\n\nDisch1\n\n50\n\n9\n\nCh6\n\nDisch1\n\n25\n\n10\n\nCh7\n\nDisch1\n\n25\n\n62\n\nTable 3.2.2: Description of charging profiles\nCharge Profile\n\nDescription\n\nCh1\n\nMulti-level current at 1.25C for 1200 seconds, 0.833C for 1100 seconds\nthen 0.5C until the battery terminal voltage hits 4.35, afterwards the CV stage is activated with 4.35 volts\n\nCh2\n\nCC-CV with current at CC stage equal to 1.0C and voltage at CV stage equal to 4.35 volts\n\nCh3\n\nCC-CV with current at CC stage equal to 0.7C and voltage at CV stage equal to 4.35 volts\n\nCh4\n\nMulti-level CV at 4.45, 4.40, 4.35, 4.30, 4.25 volts each for 0.5 seconds\nwith tapering down the voltage to 4.35 volts after SOC of 70%\n\nCh5\n\nCC-CV with current at CC stage equal to 1.3C and voltage at CV stage equal to 4.35 volts\n\nCh6\n\nCC-CV with current at CC stage equal to 1.3C and voltage at CV stage equal to 4.25 volts\n\nCh7\n\nCC-CV with current at CC stage equal to 1.0C and voltage at CV stage equal to 4.25 volts\n\nTable 3.2.3: Description of discharge profile of Disch1\n\nStage\n\nDescription\n\n1\n\ndischarge at 0.5C for 1 hour\n\n2\n\ndischarge at 1C for 15 minutes\n\n3\n\ndischarge at 0.5C for few seconds (6 seconds)\n\n4\n\ndischarge at 0.2C until battery terminal voltage hits 2.8 volts\n\nFigure 3.2.1 shows a sample charge-discharge profile for one of the experiments\nand Figure 3.2.2 shows all of its 125 voltage profiles. It can be seen that, as the\nbattery ages, the time-to-charge and time-to-discharge decrease and hence the total\ntime of a charge-rest-discharge-rest cycle decreases. This decrease in time-to-charge\nand time-to-discharge is due to capacity fade. For an animation about illustration of\ncapacity fade (via the decreasing time-to-charge and time-to-discharge as the battery\nages), the reader may refer to [1].\n\n63\n\nFigure 3.2.1: A sample current profile (charge-rest-discharge-rest)\n\nFigure 3.2.2: Voltage profiles of 125 cycles (data set 2)\n\nRemark 3.2.1. Note that Fig. 3.2.2 also illustrates power fade in a battery as it\nages. A jump in the current results in a jump in the terminal voltage. The series\nresistance of a battery (R0 ) equals to the ratio of the jump in the terminal voltage to\nthe jump in the current. If the jump in the current remains fixed, as the number of\n64\n\ncycles increases, the change in the jump in the terminal voltage is proportional to the\nchange in the series resistance in the battery as it ages. One can see as the current\n1\njumps from −2.6 A(−1 Crate) to −130 mA(− 20\nCrate), the magnitude of the jump in\n\nterminal voltage increases as the number of cycles goes up. This demonstrates that\nthe series resistance in the battery increases as the battery ages, which demonstrates\npower fade in the battery due to aging.\n\n3.3\n\nLAR-αβγ Model\n\nAmong the explored models, the following model with the least absolute residuals\n(LAR) as its fitting criterion was found to better capture the trend in the normalized\ncapacity. We refer to this model as ”LAR-αβγ”.\n\nQnorm [n] = αβ n nγ\n\nn = 1, 2, . . .\n\n(3.3.1)\n\nThe LAR method is robust in that it minimizes the sum of the absolute values of the\nresiduals, rather than the squared differences as in ordinary least squares. Therefore,\nextreme values have substantially smaller influence on the fit, thereby achieving the\ndesired robustness of the fit. The Matlab function of ”fit” with the ”StartPoint” of [1\n1 1] was used for training the model.\n\n3.4\n\nLS-BE Model\n\nFor performance comparison with the LAR-αβγ model, the following bi-exponential\nmodel, which is frequently used in the literature [75], [196], [82], was chosen. We used\n65\n\nthe least squares approach as the fitting method; hence we refer to it as ”LS-BE”.\n\nQnorm [n] = α1 β1n + α2 β2n\n\nn = 1, 2, . . .\n\n(3.4.1)\n\nThe estimation of the parameters is performed as follows. First, we can\neasily verify that the following relation holds.\n\nQnorm [n + 1] = x1 Qnorm [n] − x2 Qnorm [n − 1]\n\n(3.4.2)\n\nwhere,\n\nx1 = (β1 + β2 )\n\nx2 = β 1 β 2\n\n(3.4.3)\n\nSince we have the profile of normalized capacity, the unknown variables of x1 and x2\nin (3.4.2) can easily be estimated using LS method. Since x1 and x2 are, respectively,\nthe sum and the product of β1 and β2 , we can find the estimates of β1 and β2 by\nsolving the following quadratic equation, once we estimate x1 and x2 .\nβ 2 − x1 β + x2 = 0\n\n(3.4.4)\n\nHaving the estimates of β1 and β2 , equation (3.4.1) reduces to a linear equation with\nunknown variables α1 and α2 . Hence, by applying the LS method, we can estimate\nboth α1 and α2 .\nNote that since the capacity model is in the normalized form, the capacity\n\n66\n\nfade (CF), which is defined in (3.4.5), can also be written as in (3.4.6).\nQ[1] − Q[n]\nQ[1]\n\nn = 1, 2, . . .\n\n(3.4.5)\n\nCF[n] = 1 − Qnorm [n]\n\nn = 1, 2, . . .\n\n(3.4.6)\n\nCF[n] =\n\n3.5\n\nComparison of LAR-αβγ Model and LS-BE Model\n\nFigures 3.5.1 and 3.5.2 show the data for normalized capacities in one of the experiments, along with the estimates of LAR-αβγ and LS-BE models, with 40 and 160\ntraining samples, respectively. In this experiment, as Fig. 3.5.1 and Fig. 3.5.2 show,\nthe LAR-αβγ is better at capturing the trend in the normalized capacities than LS-BE.\nWhile the outliers affect the LS-BE model significantly, they have minor effect on the\nLAR-αβγ and hence LAR-αβγ filters out the outliers. It is seen that predictions of\nLAR-αβγ are consistent with the experimental data even when just 40 samples are\nused in the fitting process.\n\n67\n\nFigure 3.5.1: Comparison of LAR-αβγ model and LS-BE model with 40 training samples\n\nFigure 3.5.2: Comparison of LAR-αβγ model and LS-BE model with 160 training samples\n\nNext, in one of the experiments, we used the data from cycles 1-175 for\ntraining the two models, and then we predicted the normalized capacity for cycles\n68\n\n176-200. We found while the average of the relative error of LS-BE prediction is 0.99%,\nthat of LAR-αβγ is only 0.35%; in addition, the maximum values of relative error for\nthese models are 1.50% and .87%, respectively. This suggests that LAR-αβγ provides\nbetter performance in capturing the trend in capacity fade than LS-BE does. This\nobservation was found to be consistently valid across all the experiments.\nNext we compare LAR-αβγ and the LS-BE models using the Akaike Information Criterion (AIC). The AIC is used to rank multiple models in the KullbackLeibler information sense [38] and values the goodness-of-fit and parsimony, two\noften-counteracting factors. However, once a model, with fewer parameters (more\nparsimonious), provides a better goodness-of-fit than a model with more parameters,\nthe AIC selects the model with less parameters. The number of parameters for the\nLAR-αβγ is 3 and for the LS-BE is 4, meaning that the LAR-αβγ model is more\nparsimonious than the LS-BE model. As for the goodness-of-fit, Fig. 3.5.3 shows\nthe ratio of MSE (Mean Squared Error) of LAR-αβγ to that of LS-BE, where in\nall experiments, this ratio is higher than 1 with it being as high as 3.6 for the first\nexperiment. In ranking models via AIC, what is important is the AIC differences\nrather than the AIC values themselves [38]. Table 3.5.1 shows the AIC differences\n(∆AIC = AICLS−BE − AICLAR−αβγ ) for the 10 aging experiments. For eight of experiments the AIC difference is greater than 10 and for the remaining two experiments,\nit is greater than 4. As rule of thumb, the level of empirical support for a model\nwith higher AIC is considerably less when the AIC difference is between 4 and 7 and\nit is essentially none when the AIC difference is greater than 10 [4]. The relative\nlikelihood of LS-BE model (with respect to LAR-αβγ) can be calculated using the\nAIC differences as lLS−BE = exp(− ∆AIC\n)[38]. These values are shown in Table 3.5.1\n2\nand it is seen that the highest value for relative likelihood of LS-BE model is 0.1,\n69\n\nwhich demonstrates that the LAR-αβγ model is better than LS-BE model in the\nKullback-Leibler information sense.\n\n3.5\n\n3\n\n2.5\n\n2\n\n1.5\n\n1\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\nExperiment ID\n\nFigure 3.5.3: MSE ratio of LS-BE to LAR\n\nTable 3.5.1: AIC differences of the LAR-αβγ and LS-BE models and relative likelihood of\nLS-BE model for all aging experiments\nExperiment ID\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n∆AIC = AICLS−BE − AICLAR−αβγ\n\n257\n\n128\n\n32\n\n16\n\n7.5\n\n16\n\n4.5\n\n11\n\n25\n\n11\n\nlLS−BE (Relative likelihood)\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\n0.02\n\n0.00\n\n0.10\n\n0.00\n\n0.00\n\n0.00\n\n70\n\nTable 3.5.2 shows the parameters of LAR-αβγ model for the ten experiments.\nTable 3.5.2: Parameters of LAR-αβγ model for all experiments\n\nExperiment ID\n\n3.6\n\nα\n\nβ\n\nγ\n\n1\n\n0.9992\n\n0.9995\n\n-0.0037\n\n2\n\n1.0015\n\n0.9996\n\n-0.0027\n\n3\n\n1.0007\n\n0.9996\n\n-0.0018\n\n4\n\n1.0007\n\n0.9996\n\n-0.0006\n\n5\n\n1.0013\n\n0.9995\n\n-0.0042\n\n6\n\n1.0008\n\n0.9996\n\n-0.0043\n\n7\n\n1.0005\n\n0.9996\n\n-0.0028\n\n8\n\n1.0016\n\n0.9996\n\n-0.0032\n\n9\n\n1.0004\n\n0.9996\n\n-0.0021\n\n10\n\n1.0004\n\n0.9996\n\n-0.0009\n\nCVD Model\n\nIn order to be able to apply the level-I control policy (as described in chapter 4)\nto select the optimal values for the maximum allowable current and the maximum\nallowable terminal voltage, we need a capacity fade model that incorporates these two\nparameters. For this reason, we developed a control variable-dependent model (CVD\nmodel), in which the αβγ parameters are dependent on vmax , and imax . The model\nchosen for this purpose is as follows:\n\nα2 α3\nβ2 β3\nQnorm,vmax ,imax [n] = (α1 vmax\nimax ) (β1 vmax\nimax )n n(γ1 +γ2 vmax +γ3 imax )\n\n71\n\nn = 1, 2, ...\n\n(3.6.1)\n\nThe fitting of model (3.6.1) is performed in three stages:\nÊ The data for each experiment are used to find the corresponding LAR-αβγ\nmodel.\nË For each experiment, the corresponding LAR-αβγ is used to generate the\nnormalized capacity data for 500 cycles.\nÌ The generated normalized capacity data in stage 2 for all experiments as well\nas the vmax and imax of the experiments are used to fit the CVD model using\nthe LS approach.\nThe CVD model of (3.6.1) can be written as follows:\n\nQnorm,u [n] = f (α, β, γ, u, n)\n\n(3.6.2)\n\n\u0015T\n\n\u0014\nα = α1 α2 α3\n\n(3.6.3)\n\n\u0015T\n\n\u0014\nβ = β1 β2 β3\n\n(3.6.4)\n\n\u0015T\n\n\u0014\nγ = γ1 γ2 γ3\n\n72\n\n(3.6.5)\n\n\u0015T\n\n\u0014\n\n(3.6.6)\n\nu = vmax imax\n\nwhere α, β, and γ are fixed parameters, once the model is trained. Therefore, the\ntrend in capacity (and consequently capacity fade) over cycles depends on the values\nof control variables u. Note that vmax and imax are expressed in normalized form with\ntheir nominal values being 4.35 V and 2.6 A, respectively.\nTable 3.6.1 shows the parameters of the CVD model.\nTable 3.6.1: Parameters of CVD model\n\nα1\n1.0007\nβ1\n0.9996\nγ1\n0.0749\n\n3.7\n\nα2\n\nα3\n\n0.0539\n\n-0.0051\n\nβ2\n\nβ3\n\n-0.0012\n\n-1.0407×10−4\n\nγ2\n\nγ3\n\n-0.0767\n\n-4.9293 ×10−4\n\nComparison of CVD and LS-BE Models\n\nFigure 3.7.1 shows a comparison of the LAR-αβγ, CVD and LS-BE models in capturing\nthe trend in capacities for two of the experiments. The CVD model and the LAR-αβγ\nmodel are indistinguishable. Figure 3.7.2 shows the relative error of the CVD and\nthe LS-BE models with respect to the LAR-αβγ model. As is evident from these\nexperiments, compared to LS-BE, the CVD model has a lower relative error.\n\n73\n\nFigure 3.7.1: Comparison of LAR-αβγ model and LS-BE model with different fitting\ndata lengths.\n\nFigure 3.7.2: Relative error of LS-BE, and CVD models with respect to LAR-αβγ\n\n74\n\n3.8\n\nEffect of Terminal Voltage and Current on Battery Capacity\n\nIn this section, using the CVD model, we consider the effect of voltage and current\n\u0014\n\u0015\non the capacity curves. For this purpose, we use the range 0.97 1.02 for both\nnormalized vmax and normalized imax . Note that these variables are in normalized\nform with 1 for vmax and imax representing 4.35 V and 2.6 A, respectively. Figure\n3.8.1 shows 80 capacity curves which are obtained by 20 linearly-spaced values in\nthe voltage range and 4 linearly-spaced values in the current range. The red and\ngreen curves show the harshest and mildest strategies, respectively, corresponding to\n\u0014\n\u0015T\n\u0014\n\u0015T\nu = 1.02 1.02 and u = 0.97 0.97 . It is seen that these 80 curves span almost\nall the area between the harshest and mildest strategies. On the other hand, Figure\n3.8.2 shows 80 capacity curves which are obtained by 4 linearly-spaced values in the\nvoltage range and 20 linearly-spaced values in the current range. Again, the red and\ngreen curves show the harshest and mildest strategies, respectively, corresponding\n\u0014\n\u0015T\n\u0014\n\u0015T\nto u = 1.02 1.02 and u = 0.97 0.97 . It is seen that there is sparsity in the\nregion between the red curves. More specifically, there are four sets (corresponding\nto the four values of vmax ) of curves each containing 20 curves (corresponding to the\n20 values of imax ) and these four sets are separated by empty spaces. In other words,\nFigures 3.8.1 and 3.8.2 confirm that vmax , rather than imax , has a salient effect on\ncapacity fade.\n\n75\n\nnormalized capacity\n\n1\n\n0.95\n\n0.9\n\n0.85\n\n0.8\n0\n\n50\n\n100\n\n150\n\n200\n\n250\ncycle\n\n300\n\n350\n\n400\n\n450\n\n500\n\nFigure 3.8.1: Plot of 80 capacity curves with high resolution in voltage (20 values) and\nlow resolution in current (4 values)\n\nnormalized capacity\n\n1\n\n0.95\n\n0.9\n\n0.85\n\n0.8\n0\n\n50\n\n100\n\n150\n\n200\n\n250\ncycle\n\n300\n\n350\n\n400\n\n450\n\n500\n\nFigure 3.8.2: Plot of 80 capacity curves with low resolution in voltage (4 values) and high\nresolution in current (20 values)\n\nIn another simulation, we used the harshest value for vmax , i.e., 1.02, and\n\u0014\n\u0015\n100 linearly-spaced values for imax in the region 0.97 1.02 . All the 100 curves had\nnormalized capacities of less than 0.80 after 500 cycles. However, by reversing the\n76\n\nscenario, i.e., using the harshest value for imax , i.e., 1.02, and 100 linearly-spaced\n\u0014\n\u0015\nvalues for vmax in the region 0.97 1.02 , only 36 curves had normalized capacities\nthat are less than 0.80 after 500 cycles. This again confirms the dominant effect of\nvmax over imax on capacity fade.\n\n3.9\n\nSummary\n\nIn this chapter, we presented two models for estimating the normalized battery capacity,\nnamely, the LAR-αβγ and the CVD. The former is a function of the number of cycles\nand the latter is a function of the number of cycles and two charge control parameters,\nviz., maximum terminal voltage of the battery (vmax ) and maximum charge current\n(imax ). The accuracies of these models were explored by experimental data gathered\nfrom aging experiments performed on Samsung GS4 battery, and their dominance\nover the bi-exponential capacity model was demonstrated using the experimental\ndata. The statistical dominance of LAR-αβγ over LS-BE was performed using Akaike\nInformation Criterion (AIC). Using the CVD model, we also analyzed the effect of\nvoltage and current on the capacity curves and we showed that vmax , rather than imax ,\nhas a salient effect on the capacity fade of a battery.\n\n77\n\nChapter 4\nBattery Life Management\n\n4.1\n\nIntroduction\n\nAs mentioned earlier, we analyze the optimal charging problem as a two-level strategy\n(level-I and level-II) that provides fast charging, while considering the battery life\nmanagement by achieving a pre-specified desired “useful cycle life”. At a lower and\nmore detailed level (level-II), the objective is to find the optimal current profile to\nminimize the time-to-charge and energy loss during charging. The optimal charging\nalgorithms require two parameters: maximum acceptable terminal voltage of the\nbattery and the maximum current during charge. As observed by other researchers as\nwell [100], these two parameters affect the life of the battery. Other factors that affect\nthe life of the battery include depth of discharge, variations in charge and discharge\ncurrents, temperature, and duty cycle and pulse duration in the case of pulse charging,\nto name a few. In this chapter, we focus on the Level-I optimization, which is in fact\nbattery life management.\n78\n\nThe block diagram of level-I optimization is shown in Fig. 4.1.1. The\nmeasured capacity data from aging experiments is fed into a capacity fade model that\nuses the present cycle and the capacity of the battery obtained from the battery fuel\ngauge (BFG) to select the optimal charging parameters vmax and imax to be used as\ncontrol parameters in the charging algorithm.\n\nFigure 4.1.1: Block diagram of level-I optimization (battery life management)\n\nThis chapter is organized as follows. In section 4.2, we present a methodology that combines fast charging and battery life management via optimal charging\nparameter selection. Then, numerical illustrations for the optimal charging parameter\nselection are presented in section 4.3. Finally, in section 4.4, we summarize the chapter.\n\n4.2\n\nFast Charging with Battery Life Management\nvia Optimal Charging Parameter Selection\n\nIn this section, we present a battery life management policy, by formulating the\nproblem as one of optimally selecting the control variables, i.e., vmax and imax . The\ngoal is to find the optimal terminal voltage and maximum current so that we preserve\nthe ”Least Permissible Normalized Capacity” LPNC (typically 80%) at the end of the\n79\n\n”Nominal Cycle Life” NCL (typically 500) cycles of battery usage, while minimizing\nthe time to charge. In this paper, for illustrative purposes, we use LPNC = 80% and\nNCL = 500 as the constraints for the optimal charging parameter selection.\nSuppose we have K different candidate values for vmax and L different\ncandidate values for imax as follows:\n\nvmax ∈ {v1 , v2 , . . . , vK }\n\n(4.2.1)\n\nimax ∈ {i1 , i2 , . . . , iL }\n\n(4.2.2)\n\nThis results in K × L different curves as follows:\n\nQnorm,kl [n] = f (α, β, γ, ukl , n)\n\n(4.2.3)\n\nFigure 4.2.1 shows a graph of normalized capacity (Qnorm ) versus cycle\nnumber (n).\n\n80\n\nFigure 4.2.1: An example of normalized capacity as a function of cycle number\n\n\u0014\nukl = vk il\n\n\u0015T\nk ∈ {1, 2, ..., K}\n\nl ∈ {1, 2, ..., L}\n\n(4.2.4)\n\nCorresponding to curve Qnorm,kl [n], we define the ”Useful Cycle Life” of UCLkl\nas the cycle number at which the normalized capacity hits the ”Least Permissible\n\n81\n\nNormalized Capacity” LPNC (say, 80%). Thus,\n\nQnorm,kl [n] = f (α, β, γ, ukl , n) ≥ LPNC\n\nfor n ≤ UCLkl\n\n(4.2.5)\n\nQnorm,kl [n] = f (α, β, γ, ukl , n) < LPNC\n\nfor n > UCLkl\n\n(4.2.6)\n\nFigure 4.2.2 illustrates the definition of UCLkl .\n\nFigure 4.2.2: Illustration of Useful Cycle Life (UCL)\n\nAssume that we have estimates of the number of cycles the battery has\nbeen exposed to and the normalized capacity of the battery at any time (for example\n82\n\nthrough BFG). Let PC denote the ”Present Cycle” of the battery and let QPC be\nthe estimated normalized capacity at cycle PC. If this battery is going to be charged\nusing the control setting ukl , its normalized capacity should correspond to the curve\nQnorm,kl [n]. Corresponding to the control setting ukl and the normalized capacity\nof the battery at present cycle (QPC ), we define the ”Virtual Present Cycle” of the\nbattery VPCkl as follows:\n\nQPC = f (α, β, γ, ukl , VPCkl )\n\nFigure 4.2.3 illustrates the definition of VPCkl .\n\nFigure 4.2.3: Illustration of Virtual Present Cycle (VPC)\n\n83\n\n(4.2.7)\n\nThen, for a charge profile with control setting ukl , the ”Remaining Useful\nCycle Life” RUCLkl is defined as the difference between useful cycle life and the virtual\npresent cycle; that is\n\nRUCLkl = UCLkl − VPCkl\n\nFigure 4.2.4 illustrates the definition of RUCLkl .\n\nFigure 4.2.4: Illustration of Remaining Useful Cycle Life (RUCL)\n\n84\n\n(4.2.8)\n\nSince the battery has already experienced PC cycles of usage, the ”Expected\nUseful Cycle Life” of the battery EUCLkl corresponding to the control setting ukl is:\n\nEUCLkl = PC + RUCLkl\n\n(4.2.9)\n\nInserting (4.2.8) into (4.2.9), we have\n\nEUCLkl = (PC − VPCkl ) + UCLkl\n\n(4.2.10)\n\nThe control setting ukl is feasible if its corresponding expected useful cycle\nlife is greater than or equal to ”Nominal Cycle Life” NCL (say, 500 cycles); that is\n\nEUCLkl ≥ NCL\n\n(4.2.11)\n\nThus, the ”Set of Feasible Control Settings” (SFCS) is\n\nSFCS = {ukl |k ∈ {1, 2, ..., K}, l ∈ {1, 2, ..., L}, EUCLkl ≥ NCL}\n\n(4.2.12)\n\nAmong all feasible control settings, we select the one that minimizes the time\nto charge. This can be done as follows by using TTCkl . For this purpose, the model-I\n[?] of the battery is simulated for different values of feasible control parameters, and\namong them the policy that results in the lowest TTC is selected. In the simulations,\nthe CC-CV charging is used with the current in CC stage is selected as il and the\nterminal voltage in CV stage as vk . This is equivalent to running the optimal charging\nalgorithm with the objective of weighted sum of time-to-charge (TTC) and energy\nloss (EL) (referred to as OtE algorithm in section 2.2) with weight on TTC, i.e. ρt ,\n85\n\nbeing equal to R0 i2l , where R0 is the series resistance of the equivalent electrical circuit\nmodel. Note that for running model-I we need to know an estimate of the resistance\nof the battery, i.e. R0 , which can obtained through BFG. In the numerical results of\nthis paper, however, we assume that R0 is known.\nRemark 4.2.1. Note that we can set a threshold SOC, sth , for which we want to\nhave the fastest TTC among all feasible strategies. The sth threshold may be different\nfrom the desired final SOC after charging, i.e., skf . For example, if we want to find\nthe best policy, which maintains the life cycle constraints and results in the lowest\ntime to charge for reaching an SOC of 50%, then we set sth = 0.50.\nRemark 4.2.2. Note that any capacity model can be used in place of the CVD model,\nas long as the model incorporates the control variables (the maximum terminal voltage\nand the maximum charge current).\nThe optimal strategy is then, selecting the control setting (among the SFCS)\nthat provides the lowest time-to-charge:\n\n∗\n\n\u0012\n\n∗\n\n(k , l ) = arg\nk,l\n\n\u0013\nmin (TTCkl )\n\nukl ∈SFCS\n\n(4.2.13)\n\nRemark 4.2.3. Another way to select the optimal strategy could be selecting the\ncontrol setting (among the SFCS) that provides the lowest useful cycle life (UCL):\n\u0010\n\u0011\n(k ∗ , l∗ ) = arg min (UCLkl )\nk,l\n\nSFCS\n\n86\n\n(4.2.14)\n\nThe optimal control setting is\n\n∗\n\n\u0014\n\n\u0015T\n\n∗\nu = vmax\ni∗max\n\n\u0014\n\n\u0015T\n\n= vk ∗ i l ∗\n\n(4.2.15)\n\nFigure 4.2.5 shows the detailed block diagram of battery life management\n(the level-I optimization problem). The setpoints of the diagram are LPNC and NCL,\nand sth , the inputs to the optimization algorithm are PC, QPC , and R0 . These inputs\nmay be estimated by BFG. In the numerical results of this thesis, we assume these\n∗\ninputs as known. The outputs of the diagram are i∗max and vmax\n, which are used in\n\nthe level-II algorithms.\n\nFigure 4.2.5: Battery life management block diagram\n\n4.3\n\nNumerical Illustration of Optimal Charging Parameter Selection\n\nIn this section, we illustrate the proposed optimal charging parameter selection method\nby numerical examples. Resolution of candidate values for control variables vmax and\n87\n\nimax are selected as 0.01 and 0.1, respectively. Note that these control variables are in\nnormalized form with the nominal value of 4.35 V and 2.6 A for voltage and current,\nrespectively. In other words, the resolution of control variables are 0.0435 volts and\n0.26 amperes. Eight different scenarios, each specified by four parameters (P C, QPC ,\nR0 , and sth ), are illustrated. In all scenarios, we assume LPNC = 0.80 and NCL = 500.\nFor a fair comparison of the effect of changing battery resistance R0 and threshold\nSOC sth , we have used the same PC (that is PC = 50) for all scenarios. The table of\nexpected useful cycle life (EUCL) is shown for each scenario, in which the EUCL’s of\nSFCS are shown in boldface, and the optimal control settings and the corresponding\nEUCL values are underlined. Note that the values for il and vk are in “normalized\n(actual)” format and the actual values for currents and voltages (the values inside the\nparentheses) are in amperes and volts, respectively.\n\n4.3.1\n\nScenario 1\n\nP C = 50, QPC = 0.96, R0 = 150mΩ, and sth = 0.50. Table 4.3.1 shows the expected\nuseful cycle life (EUCL) for this scenario. As seen from Table 4.3.1, the optimal\ncontrol setpoints for this scenario are\n\n∗\n\nu =\n\n\u0015T\n\n\u0014\n∗\nvmax\n\ni∗max\n\n\u0014\n\n\u0015T\n\n= 0.97 1.3\n\n88\n\n(4.3.1)\n\nTable 4.3.1: Expected Useful Cycle Life (EUCL), for Scenario 1: P C = 50, QPC = 0.96,\nR0 = 150mΩ, and sth = 0.50\nHH\nHH\n\nvk\n\nHH\n\nil\n\n0.7 (1.82)\n\n0.8 (2.08) 0.9 (2.34) 1.0 (2.6) 1.1 (2.86) 1.2 (3.12)\n\n1.3 (3.38)\n\nHH\nHH\n\n0.97 (4.22)\n\n590\n\n568\n\n550\n\n536\n\n523\n\n512\n\n502\n\n0.98 (4.26)\n\n567\n\n547\n\n531\n\n517\n\n505\n\n494\n\n485\n\n0.99 (4.31)\n\n546\n\n527\n\n512\n\n498\n\n488\n\n478\n\n469\n\n1.00 (4.35)\n\n526\n\n508\n\n495\n\n482\n\n472\n\n462\n\n454\n\n1.01 (4.39)\n\n507\n\n491\n\n477\n\n466\n\n456\n\n448\n\n440\n\n1.02 (4.44)\n\n489\n\n474\n\n461\n\n450\n\n442\n\n433\n\n426\n\nFigure 4.3.1 shows the expected useful cycle life (EUCL) for “Scenario 1”.\nThe infeasible strategies are shown in red and the optimal strategy is shown in green.\n\nFigure 4.3.1: Expected Useful Cycle Life (EUCL) for Scenario 1\ninfeasible strategies are in red; optimal strategy is in green\n\n89\n\n4.3.2\n\nScenario 2\n\nIn this scenario, we consider a battery that has been used more mildly than in “Scenario\n1”.\nP C = 50, QPC = 0.99, R0 = 150mΩ, and sth = 0.50. Table 4.3.2 shows the expected\nuseful cycle life (EUCL) for this scenario. As seen from Table 4.3.2, the optimal\ncontrol setpoints for this scenario are\n\n∗\n\n\u0015T\n\n\u0014\n\n∗\nu = vmax\ni∗max\n\n\u0015T\n\n\u0014\n\n= 1.00 1.3\n\n(4.3.2)\n\nAs “Scenario 2” describes a battery that has been used very mildly, we see from Table\n4.3.2 that the SFCS includes more members. Also note that for any setting, the EUCL\ncorresponding to “Scenario 2” is higher than that of “Scenario 1”. Note that compared\n∗\nto “Scenario 1”, the optimal control setting in “Scenario 2” has a higher vmax\n. This is\n\nbecause the battery has been used mildly before and hence it has more room to be\nexposed to higher terminal voltage without violating the constraint on useful life.\nTable 4.3.2: Expected Useful Cycle Life (EUCL), for Scenario 2: P C = 50, QPC = 0.99,\nR0 = 150mΩ, and sth = 0.50\nHH\nHH\n\nvk\n\nH\nHH\n\nil\n\n0.7 (1.82)\n\n0.8 (2.08) 0.9 (2.34) 1.0 (2.6) 1.1 (2.86) 1.2 (3.12)\n\n1.3 (3.38)\n\nH\nHH\n\n0.97 (4.22)\n\n681\n\n656\n\n635\n\n618\n\n603\n\n590\n\n578\n\n0.98 (4.26)\n\n652\n\n629\n\n610\n\n593\n\n579\n\n566\n\n556\n\n0.99 (4.31)\n\n624\n\n603\n\n585\n\n569\n\n556\n\n545\n\n534\n\n1.00 (4.35)\n\n599\n\n578\n\n561\n\n547\n\n534\n\n523\n\n513\n\n1.01 (4.39)\n\n573\n\n555\n\n538\n\n525\n\n513\n\n503\n\n493\n\n1.02 (4.44)\n\n549\n\n532\n\n517\n\n504\n\n493\n\n483\n\n474\n\n90\n\nFigure 4.3.2 shows the expected useful cycle life (EUCL) for “Scenario 2”.\nThe infeasible strategies are shown in red and the optimal strategy is shown in green.\n\nFigure 4.3.2: Expected Useful Cycle Life (EUCL) for Scenario 2\ninfeasible strategies are in red; optimal strategy is in green\n\nIn both “Scenario 1” and “Scenario 2”, among all members of SFCS, the\nones with higher current were selected. This may not always be the case if we increase\nsth or if the resistance of the battery increases. Note that for low values of sth , the\ncharging time is inversely proportional to the injected current as all the strategies\nare in the CC stage, but for higher sth some of the strategies may experience the CV\nstage as well; hence the best policy may not be the one with the highest current.\n\n91\n\n4.3.3\n\nScenario 3\n\nIn this scenario, we change sth form 0.50 to 0.80 and all other conditions remain the\nsame as in “Scenario 1”.\nP C = 50, QPC = 0.96, R0 = 150mΩ, and sth = 0.80. Table 4.3.3 shows the expected\nuseful cycle life (EUCL) for this scenario. As seen from Table 4.3.3, the optimal\ncontrol setpoints for this scenario are\n\n∗\n\n\u0015T\n\n\u0014\n\n∗\nu = vmax\ni∗max\n\n\u0015T\n\n\u0014\n\n= 0.98 1.1\n\n(4.3.3)\n\nTable 4.3.3: Expected Useful Cycle Life (EUCL), for Scenario 3: P C = 50, QPC = 0.96,\nR0 = 150mΩ, and sth = 0.80\nHH\nHH\n\nvk\n\nH\nHH\n\nil\n\n0.7 (1.82)\n\n0.8 (2.08) 0.9 (2.34) 1.0 (2.6) 1.1 (2.86)\n\n1.2 (3.12)\n\n1.3 (3.38)\n\nH\nHH\n\n0.97 (4.22)\n\n590\n\n568\n\n550\n\n536\n\n523\n\n512\n\n502\n\n0.98 (4.26)\n\n567\n\n547\n\n531\n\n517\n\n505\n\n494\n\n485\n\n0.99 (4.31)\n\n546\n\n527\n\n512\n\n498\n\n488\n\n478\n\n469\n\n1.00 (4.35)\n\n526\n\n508\n\n495\n\n482\n\n472\n\n462\n\n454\n\n1.01 (4.39)\n\n507\n\n491\n\n477\n\n466\n\n456\n\n448\n\n440\n\n1.02 (4.44)\n\n489\n\n474\n\n461\n\n450\n\n442\n\n433\n\n426\n\nFigure 4.3.3 shows the expected useful cycle life (EUCL) for “Scenario 3”.\nThe infeasible strategies are shown in red and the optimal strategy is shown in green.\n\n92\n\nFigure 4.3.3: Expected Useful Cycle Life (EUCL) for Scenario 3\ninfeasible strategies are in red; optimal strategy is in green\n\n4.3.4\n\nScenario 4\n\nIn this scenario, we assume that the resistance of the battery is 200mΩ instead of\n150mΩ as used in “Scenario 1” and we assume that all the other conditions remain\nthe same as in “Scenario 1”.\nP C = 50, QPC = 0.96, R0 = 200mΩ, and sth = 0.50. Table 4.3.4 shows the expected\nuseful cycle life (EUCL) for this scenario. As seen from Table 4.3.4, the optimal\ncontrol setpoints for this scenario are the same as in “Scenario 3”:\n\n∗\n\n\u0014\n\n∗\nu = vmax\ni∗max\n\n\u0015T\n\n\u0014\n\n\u0015T\n\n= 0.98 1.1\n\n93\n\n(4.3.4)\n\nTable 4.3.4: Expected Useful Cycle Life (EUCL), for Scenario 4: P C = 50, QPC = 0.96,\nR0 = 200mΩ, and sth = 0.50\nHH\nHH\n\nvk\n\nH\nHH\n\nil\n\n0.7 (1.82) 0.8 (2.08) 0.9 (2.34)\n\n1.0 (2.6) 1.1 (2.86)\n\n1.2 (3.12)\n\n1.3 (3.38)\n\nH\nHH\n\n0.97 (4.22)\n\n590\n\n568\n\n550\n\n536\n\n523\n\n512\n\n502\n\n0.98 (4.26)\n\n567\n\n547\n\n531\n\n517\n\n505\n\n494\n\n485\n\n0.99 (4.31)\n\n546\n\n527\n\n512\n\n498\n\n488\n\n478\n\n469\n\n1.00 (4.35)\n\n526\n\n508\n\n495\n\n482\n\n472\n\n462\n\n454\n\n1.01 (4.39)\n\n507\n\n491\n\n477\n\n466\n\n456\n\n448\n\n440\n\n1.02 (4.44)\n\n489\n\n474\n\n461\n\n450\n\n442\n\n433\n\n426\n\nFigure 4.3.4 shows the expected useful cycle life (EUCL) for “Scenario 4”.\nThe infeasible strategies are shown in red and the optimal strategy is shown in green.\n\nFigure 4.3.4: Expected Useful Cycle Life (EUCL) for Scenario 4\ninfeasible strategies are in red; optimal strategy is in green\n\n94\n\n4.3.5\n\nScenario 5\n\nIn this, we assume that the resistance is higher (250mΩ) than that of Scenario 4\n(200mΩ). Comparing Table 4.3.5 with Table 4.3.4, we can see that the level of optimal\ncurrent decreases further, and the optimal strategy moves down along the boundary\nbetween the feasible and infeasible control settings.\nP C = 50, QPC = 0.96, R0 = 250mΩ, and sth = 0.50. Table 4.3.5 shows the expected\nuseful cycle life (EUCL) for this scenario. As seen from Table 4.3.5, the optimal\ncontrol setpoints for this scenario are\n\n∗\n\n\u0015T\n\n\u0014\n\nu =\n\n∗\nvmax\n\ni∗max\n\n\u0015T\n\n\u0014\n\n= 0.99 0.9\n\n(4.3.5)\n\nTable 4.3.5: Expected Useful Cycle Life (EUCL), for Scenario 5: P C = 50, QPC = 0.96,\nR0 = 250mΩ, and sth = 0.50\nHH\nH\n\nHH\nH\n\nvk\n\nil\n\n0.7 (1.82)\n\n0.8 (2.08) 0.9 (2.34) 1.0 (2.6) 1.1 (2.86)\n\n1.2 (3.12)\n\n1.3 (3.38)\n\nHH\nHH\n\n0.97 (4.22)\n\n590\n\n568\n\n550\n\n536\n\n523\n\n512\n\n502\n\n0.98 (4.26)\n\n567\n\n547\n\n531\n\n517\n\n505\n\n494\n\n485\n\n0.99 (4.31)\n\n546\n\n527\n\n512\n\n498\n\n488\n\n478\n\n469\n\n1.00 (4.35)\n\n526\n\n508\n\n495\n\n482\n\n472\n\n462\n\n454\n\n1.01 (4.39)\n\n507\n\n491\n\n477\n\n466\n\n456\n\n448\n\n440\n\n1.02 (4.44)\n\n489\n\n474\n\n461\n\n450\n\n442\n\n433\n\n426\n\nFigure 4.3.5 shows the expected useful cycle life (EUCL) for “Scenario 5”.\nThe infeasible strategies are shown in red and the optimal strategy is shown in green.\n\n95\n\nFigure 4.3.5: Expected Useful Cycle Life (EUCL) for Scenario 5\ninfeasible strategies are in red; optimal strategy is in green\n\n4.3.6\n\nScenario 6\n\nIn this scenario, we assume that the resistance is even higher (300mΩ) than that of\nScenario 5 (250mΩ). Comparing Table 4.3.6 with Table 4.3.5, we can see that the\nlevel of optimal current decreases further, and the optimal strategy moves down along\nthe boundary between the feasible and infeasible control settings.\nP C = 50, QPC = 0.96, R0 = 300mΩ, and sth = 0.50. Table 4.3.5 shows the expected\nuseful cycle life (EUCL) for this scenario. As seen from Table 4.3.5, the optimal\ncontrol setpoints for this scenario are\n\n∗\n\n\u0014\n\n∗\nu = vmax\ni∗max\n\n\u0015T\n\n\u0014\n\n\u0015T\n\n= 1.00 0.8\n\n96\n\n(4.3.6)\n\nTable 4.3.6: Expected Useful Cycle Life (EUCL), for Scenario 6: P C = 50, QPC = 0.96,\nR0 = 300mΩ, and sth = 0.50\nHH\nHH\n\nil\n\n0.7 (1.82)\n\n0.8 (2.08)\n\n0.97 (4.22)\n\n590\n\n568\n\n550\n\n536\n\n523\n\n512\n\n502\n\n0.98 (4.26)\n\n567\n\n547\n\n531\n\n517\n\n505\n\n494\n\n485\n\n0.99 (4.31)\n\n546\n\n527\n\n512\n\n498\n\n488\n\n478\n\n469\n\n1.00 (4.35)\n\n526\n\n508\n\n495\n\n482\n\n472\n\n462\n\n454\n\n1.01 (4.39)\n\n507\n\n491\n\n477\n\n466\n\n456\n\n448\n\n440\n\n1.02 (4.44)\n\n489\n\n474\n\n461\n\n450\n\n442\n\n433\n\n426\n\nvk\n\nHH\n\n0.9 (2.34) 1.0 (2.6) 1.1 (2.86) 1.2 (3.12)\n\n1.3 (3.38)\n\nHH\nHH\n\nFigure 4.3.6 shows the expected useful cycle life (EUCL) for “Scenario 6”.\nThe infeasible strategies are shown in red and the optimal strategy is shown in green.\n\nFigure 4.3.6: Expected Useful Cycle Life (EUCL) for Scenario 6\ninfeasible strategies are in red; optimal strategy is in green\n\n97\n\n4.3.7\n\nScenario 7\n\nP C = 50, QPC = 0.97, R0 = 150mΩ, and sth = 0.50. Table 4.3.7 shows the expected\nuseful cycle life (EUCL) for this scenario. As seen from Table 4.3.7, the optimal\ncontrol setpoints for this scenario are\n\n∗\n\n\u0015T\n\n\u0014\n\n∗\nu = vmax\ni∗max\n\n\u0015T\n\n\u0014\n\n= 0.98 1.3\n\n(4.3.7)\n\nTable 4.3.7: Expected Useful Cycle Life (EUCL), for Scenario 7: P C = 50, QPC = 0.97,\nR0 = 150mΩ, and sth = 0.50\nH\n\nHH\nH\n\nvk\n\nHH\nH\n\nil\n\n0.7 (1.82)\n\n0.8 (2.08) 0.9 (2.34) 1.0 (2.6) 1.1 (2.86) 1.2 (3.12)\n\n1.3 (3.38)\n\nHH\nH\n\n0.97 (4.22)\n\n620\n\n598\n\n579\n\n563\n\n550\n\n538\n\n527\n\n0.98 (4.26)\n\n596\n\n575\n\n558\n\n543\n\n530\n\n519\n\n510\n\n0.99 (4.31)\n\n573\n\n554\n\n538\n\n523\n\n512\n\n502\n\n492\n\n1.00 (4.35)\n\n552\n\n533\n\n518\n\n505\n\n494\n\n484\n\n475\n\n1.01 (4.39)\n\n531\n\n514\n\n499\n\n488\n\n477\n\n468\n\n460\n\n1.02 (4.44)\n\n512\n\n496\n\n482\n\n471\n\n462\n\n452\n\n445\n\nFigure 4.3.7 shows the expected useful cycle life (EUCL) for “Scenario 7”.\nThe infeasible strategies are shown in red and the optimal strategy is shown in green.\n\n98\n\nFigure 4.3.7: Expected Useful Cycle Life (EUCL) for Scenario 7\ninfeasible strategies are in red; optimal strategy is in green\n\n4.3.8\n\nScenario 8\n\nP C = 50, QPC = 0.98, R0 = 150mΩ, and sth = 0.50. Table 4.3.8 shows the expected\nuseful cycle life (EUCL) for this scenario. As seen from Table 4.3.8, the optimal\ncontrol setpoints for this scenario are\n\n∗\n\n\u0014\n\n∗\nu = vmax\ni∗max\n\n\u0015T\n\n\u0014\n\n\u0015T\n\n= 0.99 1.3\n\n99\n\n(4.3.8)\n\nTable 4.3.8: Expected Useful Cycle Life (EUCL), for Scenario 8: P C = 50, QPC = 0.98,\nR0 = 150mΩ, and sth = 0.50\nHH\nHH\n\nvk\n\nHH\n\nil\n\n0.7 (1.82)\n\n0.8 (2.08) 0.9 (2.34) 1.0 (2.6) 1.1 (2.86) 1.2 (3.12)\n\n1.3 (3.38)\n\nHH\nHH\n\n0.97 (4.22)\n\n651\n\n627\n\n607\n\n591\n\n577\n\n564\n\n553\n\n0.98 (4.26)\n\n624\n\n603\n\n584\n\n568\n\n555\n\n543\n\n533\n\n0.99 (4.31)\n\n599\n\n579\n\n562\n\n547\n\n535\n\n524\n\n514\n\n1.00 (4.35)\n\n576\n\n557\n\n541\n\n527\n\n515\n\n505\n\n496\n\n1.01 (4.39)\n\n553\n\n536\n\n520\n\n508\n\n497\n\n487\n\n479\n\n1.02 (4.44)\n\n532\n\n516\n\n501\n\n489\n\n479\n\n470\n\n462\n\nFigure 4.3.8 shows the expected useful cycle life (EUCL) for “Scenario 8”.\nThe infeasible strategies are shown in red and the optimal strategy is shown in green.\n\nFigure 4.3.8: Expected Useful Cycle Life (EUCL) for Scenario 8\ninfeasible strategies are in red; optimal strategy is in green\n\n100\n\nRemark 4.3.1. That in Scenarios 4-6, increasing the resistance resulted in an optimal\npolicy with lower current. This suggests that imax , rather than vmax , has a salient\neffect on power fade. Figure 4.3.9 shows the effect of power fade (increase in the series\nresistance) on the expected useful cycle life (EUCL) of battery.\n\nFigure 4.3.9: Effect of power fade (increase in the series resistance) on the expected useful\ncycle life (EUCL) of battery\n\nThe animation of the effect of power fade on EUCL can be downloaded from [1].\nRemark 4.3.2. That in Scenarios 1-2 and 7-8, increasing the present capacity (QPC )\nresulted in an optimal policy with higher voltage. This suggests that vmax , rather than\nimax , has a salient effect on capacity fade. This is consistent with the results from\nsection 3.8. Figure 4.3.10 shows the effect of capacity fade on the expected useful\ncycle life of battery.\n\n101\n\nFigure 4.3.10: Effect of capacity fade on the expected useful cycle life (EUCL) of battery\n\nThe animation of the effect of capacity fade on EUCL can be downloaded\nfrom [1].\nFigure 4.3.11 summarizes the above remarks visually. The width of the\ncausal arrows represents their strength.\n\nCapacity\nFade\n\nPower\nFade\n\nFigure 4.3.11: Effect of vmax and imax on power fade and capacity fade\n\n102\n\nSince the main cause of increasing the resistance is solid-electrolyte interphase\n(SEI) formation and the main cause of decreasing capacity is Li plating, we can say\nthat higher currents are significant causal factors for SEI formation, while higher\nterminal voltages are major causes of Li plating.\n\n4.3.9\n\nSummary of Scenarios and Some Insights\n\nTable 4.3.9 shows the parameters and the optimal policy for each scenario.\nTable 4.3.9: Scenarios: parameters and optimal policy\nScenario\n\nParameters\n\nOptimal Policy (normalized)\n\nOptimal Policy (actual)\n\nPC\n\nQPC\n\nR0 (mΩ)\n\nsth\n\n∗\nvmax\n\ni∗max\n\n∗\nvmax\n(V)\n\ni∗max (A)\n\n1\n\n50\n\n0.96\n\n150\n\n0.50\n\n0.97\n\n1.3\n\n4.22\n\n3.38\n\n2\n\n50\n\n0.99\n\n150\n\n0.50\n\n1.00\n\n1.3\n\n4.35\n\n3.38\n\n3\n\n50\n\n0.96\n\n150\n\n0.80\n\n0.98\n\n1.1\n\n4.26\n\n2.86\n\n4\n\n50\n\n0.96\n\n200\n\n0.50\n\n0.98\n\n1.1\n\n4.26\n\n2.86\n\n5\n\n50\n\n0.96\n\n250\n\n0.50\n\n0.99\n\n0.9\n\n4.31\n\n2.34\n\n6\n\n50\n\n0.96\n\n300\n\n0.50\n\n1.00\n\n0.8\n\n4.35\n\n2.08\n\n7\n\n50\n\n0.97\n\n150\n\n0.50\n\n0.98\n\n1.3\n\n4.26\n\n3.38\n\n8\n\n50\n\n0.98\n\n150\n\n0.50\n\n0.99\n\n1.3\n\n4.31\n\n3.38\n\nThe following insights can be drawn form Tables 4.3.1 through 4.3.9:\n1. For scenarios with mild usage of battery and low values of sth (as in “Scenario 1”\nand “Scenario 2”), the optimal strategy is the one among the feasible candidates\n(members of SFCS) that has the highest current.\n∗\n2. If the battery is treated mildly, the optimal strategy yields higher values of vmax\n\nand i∗max . For example, the battery in “Scenario 2” is treated more mildly than\n103\n\n∗\nthe battery in “Scenario 1”, and consequently, the vmax\n(1.00 normalized or 4.35\n\nvolts) in “Scenario 2” is higher than that (0.97 normalized or 4.22 volts) of\n“Scenario 1”.\n3. For scenarios with higher values of sth (as in “Scenario 3”), the optimal strategy\n∗\nyields lower values of i∗max and higher values of vmax\n.\n\n4. The increase in battery resistance (compare Scenarios 4, 5, and 6) results in\n∗\nlower values of i∗max and higher values of vmax\n.\n\n5. imax , rather than vmax , has a salient effect on power fade.\n6. vmax , rather than imax , has a salient effect on capacity fade. This is consistent\nwith the results from section 3.8.\n\n4.4\n\nSummary\n\nIn this chapter, we presented a battery life management policy by developing a\nprocedure for optimal charging parameter selection. The proposed approach finds\nthe best vmax and imax to achieve a desired cycle life (for example, 500 cycles), while\nmaintaining the normalized capacity above a desired threshold (for example, 80%) and\nattaining the fastest possible time-to-charge. The method was illustrated via numerical\nresults. The optimal setpoint depends on the desired state of charge (denoted by\nsth ) for which we aim to attain the fastest charging time. It also depends on the\nresistance of the battery, i.e., R0 . Simulation results show that a low threshold on\nstate of charge (sth ) and a low battery resistance result in an optimal setpoint with\nthe highest imax among the set of feasible control settings, while increasing sth and the\n104\n\nbattery resistance result in moving the optimal setpoint to lower values of imax and\nhigher values of vmax . From the discussion of the different scenarios, we concluded\nthat imax , rather than vmax , has a salient effect on power fade, and vmax , rather than\nimax , has a salient effect on capacity fade. The latter is consistent with the results\nfrom section 3.8.\n\n105\n\nChapter 5\nFault Detection, Diagnosis and\nPrognosis\n\n5.1\n\nIntroduction\n\nWith increasing number of subsystems and components in complex engineered systems,\nthe need for system monitoring, anomaly (fault) detection and root cause analysis is\nparamount for improved system availability. However, the process of detecting and\nisolating faults in complex systems is challenging. This is because:\n\n\nThe numbers of faults and monitoring signals (“processed sensor measurements”,\n“tests”, “symptoms”, “visual observations”) in these systems are large (running\ninto tens of thousands).\n\n\n\nEach test outcome may be caused by faults in multiple components of possibly\nmultiple subsystems (“many-to-many” fault-test relationships).\n\n106\n\n\n\nFaults propagate from one subsystem to another (“cross-subsystem fault propagation”) with delays.\n\n\n\nTest outcomes, which are uncertain, are observed with delays caused by fault\npropagation, computation and communication.\n\n\n\nSimultaneous occurrence of multiple faults is frequent.\nThis makes traditional single-fault diagnosis approaches untenable. Uncertain\n\ntest outcomes pose particularly difficult challenges to fault diagnosis: while, in a perfect\nbinary test outcome situation, a passed test indicates the normal status of its associated\ncomponents and a failed test implies the existence of at least one faulty component\nassociated with the test, neither can be inferred when the tests are imperfect. In the\nbinary test outcome case, an imperfect test outcome may be reported as passed, even\nwhen there are faulty component(s) associated with the test, a situation referred to as\nimperfect (missed) detection. On the other hand, an imperfect test outcome may be\nreported as failed, even though there is no faulty component associated with the test,\na condition referred to as a false alarm.\nIn broad terms, fault diagnosis problems can be categorized into two groups:\npassive monitoring and active monitoring (“probing”). In passive monitoring, the fault\ndiagnosis subsystem (“diagnoser”) relies on synchronous or asynchronous availability\nof test outcomes to detect abnormal conditions in the system and to isolate the faulty\ncomponent or components in the system. This is also termed abductive reasoning.\nOne application of passive monitoring is in disease diagnosis, such as Quick Medical\nReference Decision-Theoretic (QMR-DT) problem, wherein bi-partite belief networks\nare used to model the probabilistic cause-effect relations of a set of diseases and a set\nof findings [169], [200]. On the other hand, in active probing, the aim is to adaptively\n107\n\nsequence the application of tests based on the outcomes of previously applied tests\nin order to minimize the expected troubleshooting time or the expected testing cost.\nEvidently, hybrid passive and active monitoring (e.g., passive monitoring followed by\nactive probing to troubleshoot problems) is a common practice in complex system\ndiagnosis.\n\nFigure 5.1.1: Tripartite digraph of fault diagnosis system\n\nGraphical models combine graph theory and probability theory into an\nelegant formalism for visualizing models, gaining insights into conditional independence\nproperties, inference and learning. Since fault diagnosis is inherently an inference\nproblem, it is natural to employ graphical models for fault diagnosis. In this vein, a\nfault diagnosis system can be conceptualized as a tripartite directed graph (digraph)\nas shown in Fig. 5.1.1. The first (top) layer contains the components (failure modes or\nfailure sources) and the second (middle) layer is comprised of test outcomes. The causeeffect relations between the component health states (herein termed failure source\nstates) and the test outcomes may be perfect or imperfect (probabilistic). The third\n\n108\n\n(bottom) layer encompasses the observations of test outcomes, which may be perfect\nor imperfect, observed synchronously or asynchronously and, in the synchronous case,\nnot all observations of test outcomes may be available at each epoch. Note that the\nobservations may be different from the test outcomes, for example, due to uncertainty\nand communication errors. When the observations are perfect, we have oj (k) = tj (k)\nand the tri-partite digraph is reduced to a bipartite one. In the following, we assume\nthat observations are perfect and represent the system as a bipartite digraph. Also in\nthe case of static fault diagnosis, the dependence on time is omitted in the bipartite\ndigraph.\nThe problem has three basic elements, namely, failure sources (associated\nwith components), tests, and dependency relations between failure sources and tests.\nEach of these elements can be abstracted in various ways to capture the nature of fault\ndiagnosis problem in a complex system. For example, failure sources associated with\na component can be permanent (static) or intermittent (dynamic). They may have\nbinary states (normal, abnormal) or multi-valued states (nominal and various degraded\nmodes of operation). The failure sources may be independent or coupled (see Fig.\n5.1.2). In the same vein, a test can be categorized as having binary or multi-valued\noutcomes, and the relationship between the failure sources and test outcomes can be\nperfect or imperfect, as alluded to earlier.\nFor ease of exposition and simplicity of notation, we consider failure sources\nand test outcomes with binary states. Fig. 5.1.3(a) shows a component having\nbinary (0-1) states and a test outcome also with binary (0-1) states having a perfect\ndependency relationship. Evidently, in this case, with probability one, xi = 1 is\nmapped to tj = 1, and xi = 0 to tj = 0.\nFig. 5.1.3(b) shows the dependency relationship of a failure source and a test\n109\n\nFigure 5.1.2: Modeling abstractions in fault diagnosis subsystems\n\noutcome in an imperfect test setting. An imperfect binary relation can be represented\nby probability of detection and probability of false alarm as follows.\nProbability of Detection: If xi = 1, then there is a probability P dij\nthat test tj fails. Here, P dij denotes the probability of detection. Formally, P dij =\nPr (tj = 1|xi = 1).\nProbability of False Alarm: If xi = 0, then there is a probability P fij\nthat test tj fails. Here, P fij denotes the probability of false alarm. Formally, P fij =\nPr (tj = 1|xi = 0).\nIn the sequel, we discuss the static and dynamic form of multiple fault\n\n110\n\nFigure 5.1.3: Perfect and imperfect relations of a failure source and a test outcome\n\ndiagnosis and also passive and active monitoring using this simplified model. Extensions\nof the method to coupled and delayed failure source state propagation, and delayed\nobservations can be found in [170], [103], [180], [104], and [204].\n\n5.2\n\nStatic Multiple Fault Diagnosis\n\nIn this section, we consider the multiple fault diagnosis problem in a static context,\nand we refer to it as static multiple fault diagnosis (SMFD). The SMFD problem is\ncomprised of the following:\n\n\nThe system consists of m components c1 , c2 , · · · , cm . Without loss of generality,\na single failure mode is associated with each component. The failure modes are\nassumed to be conditionally independent. We let S = {s1 , s2 , . . . , sm } be the set\nof independent potential failure modes (failure sources), respectively, associated\n\n111\n\nwith the system components c1 , c2 , · · · , cm .\n\n\nTo each component (potential failure source), ci (si ) is assigned a binary state\nvariable xi , where xi = 1 represents the fault state of the component and xi = 0\nrepresents the normal state of the component.\n\n\n\nEach potential failure source is assumed to have a prior probability psi of being\nfaulty; in other words, Pr (xi = 1) = psi .\n\n\n\nThe system is assumed to have n tests, t = {t1 , t2 , · · · , tn }.\n\n\n\nTests are assumed to be independent.\n\n\n\nWhen test tj has a pass outcome, it is represented by tj = 0, otherwise by tj = 1.\n\n\n\nThe cause-effect relation between the potential failure sources and the tests\nare assumed to be probabilistic with detection probabilities and false alarm\nprobabilities, as discussed in the previous section.\n\n\n\nIn a real-world system, if component ci is associated with test tj , the detection\nprobability P dij is a number close to 1, for example, in the range [0.75, 1] and\nthe false alarm probabilityP fij is a number close to 0, for example, in the range\n[0, 0.20]. The situation that the component ci is not associated with test tj is\nrepresented by P dij = P fij = 0.\n\n\n\nWe represent the states of failures sources as x. In other words x = {x1 , x2 , . . . , xm }.\n\nBased on the above assumptions, the problem of SMFD is defined as follows:\nStatic Multiple Fault Diagnosis (SMFD) Problem: Given T , a subset\nof all test outcomes t, i.e., T ⊆ t, what are the most likely states of failure sources, x?\n112\n\nFormally, we can represent the problem as follows:\n\nx̂ = arg max Pr (x|T ) .\nx\n\n(5.2.1)\n\nUsing Bayes' rule, we can write Pr (x|T ) as\n\nPr (x|T ) =\n\nPr (T |x) Pr (x)\n.\nPr (T )\n\n(5.2.2)\n\nSince maximization of Pr (x|T ) is equivalent to maximization of Pr (T |x) Pr (x), we\ncan simplify the problem further by maximizing the logarithm of Pr (T |x) Pr (x). Thus,\nthe problem is:\n\nx̂ = arg max ln (Pr (T |x) Pr (x)) .\nx\n\n(5.2.3)\n\nIn tackling the problem, we first classify the given tests T into two subsets of passed\ntests and failed tests, respectively, represented by Tp and Tf . Since the test outcomes\nare assumed to be conditionally independent, we have Pr (T |x) = Pr (Tp |x) Pr (Tf |x).\nTherefore, by converting the logarithm of the product to the sum of logarithms, we\ncan write (5.2.3) as follows:\n\nx̂ = arg max {ln (Pr (Tf |x)) + ln (Pr (Tp |x)) + ln (Pr (x))} .\nx\n\n(5.2.4)\n\nSince the potential failure sources are assumed to be independent, we have\n\nPr (x) =\n\nm\nY\n\nPr (xi ).\n\ni=1\n\n113\n\n(5.2.5)\n\nBased on problem assumptions, we have Pr (xi = 1) = psi ; therefore Pr (xi ) =\np\n\n(psi )xi (1 − psi )1−xi , which by defining pi = 1−psis can be simplified as:\ni\n\nPr (xi ) = (pi )xi (1 − psi ) .\n\n(5.2.6)\n\nTaking the logarithm of (5.2.5) and using (5.2.6), we have\n\nln (Pr (x)) =\n\nm\nX\n\nln(pi )xi +\n\ni=1\n\nNote that\n\nm\nP\n\nm\nX\n\nln (1 − psi ).\n\n(5.2.7)\n\ni=1\n\nln (1 − psi ) is a known constant. The next term to calculate is ln (Pr (Tp |x)).\n\ni=1\n\nSince the test outcomes are assumed to be conditionally independent, we can write:\n\nPr (Tp |x) =\n\nY\n\nPr (tj = pass|x) =\n\ntj ∈T\n\nY\n\nPr (tj |x).\n\n(5.2.8)\n\ntj ∈Tp\n\nIn order that test tj has pass outcome conditioned on x, it should pass conditioned on\neach component state. In other words,\n\nPr (tj = pass|x) =\n\nm\nY\n\nPr (tj = pass|xi ).\n\n(5.2.9)\n\ni=1\n\nFrom Fig. 5.1.3(b), we have\n\nPr (tj = pass|xi ) =\n\n\n1 − P fij\n\nxi = 0\n\n\n1 − P dij\n\nxi = 1\n\n114\n\n.\n\n(5.2.10)\n\nEquation (5.2.10), can compactly be written as follows\n\nPr (tj = pass|xi ) = (1 − P dij )xi (1 − P fij )1−xi\n\n(5.2.11)\n\nBy defining P dij = 1 − P dij and P fij = 1 − P fij , we can write (5.2.11) as follows\n\nPr (tj = pass|xi ) = P fij P dij /P fij\n\n\u0001 xi\n\n.\n\n(5.2.12)\n\nInserting (5.2.12) into (5.2.9) and taking the logarithm, we have\n\nln (Pr (tj = pass|x)) = ln (yj ) = hj +\n\nm\nX\n\nβij xi ,\n\n(5.2.13)\n\ni=1\n\nwhere βij = ln\n\n\u0010\n\nP dij\nP fij\n\n\u0011\n\n, hj =\n\nm\nP\n\n\u0001\nln P fij , and the continuous variable yj is defined as\n\ni=1\n\nyj = Pr (tj = pass|x) .\n\n(5.2.14)\n\nNote that βij and hj are known constants. By taking the logarithm of both sides of\n(5.2.8) and then using relation (5.2.13), we can write:\n\nln (Pr (Tp |x)) =\n\nX\ntj ∈Tp\n\nNote that the summation\n\nP\n\nX\n\nln (yj ) =\n\nhj +\n\ntj ∈Tp\n\nm\nXX\n\nβij xi .\n\n(5.2.15)\n\ntj ∈Tp i=1\n\nhj is simply a constant. The last term to be charac-\n\ntj ∈Tp\n\nterized from (5.2.4) is ln (Pr (Tf |x)). Similarly to the passed tests, for failed tests\nQ\nQ\nwe have Pr (Tf |x) =\nPr (tj = fail|x) =\nPr (tj |x) and as Pr (tj = fail|x) =\ntj ∈T\n\ntj ∈Tf\n\n115\n\n1 − Pr (tj = pass|x) = 1 − yj , we have the following relation:\nY\n\nPr (Tf |x) =\n\n(1 − yj ),\n\n(5.2.16)\n\ntj ∈Tf\n\nwhere based on (5.2.13) and the definition of yj , we have\n\nln(yj ) = hj +\n\nm\nX\n\nβij xi .\n\n(5.2.17)\n\nln (1 − yj ).\n\n(5.2.18)\n\ni=1\n\nBy taking the logarithm of (5.2.16), we have:\nX\n\nln (Pr (Tf |x)) =\n\ntj ∈Tf\n\nNow inserting (5.2.7), (5.2.15), and (5.2.18) into (5.2.4), and discarding the constant\nm\nP\nP\nterms of\nln (1 − psi ) and\nhj , the SMFD problem simplifies to:\ntj ∈Tp\n\ni=1\n\nx̂ = arg max J(x, y),\nx,y\n\n(5.2.19)\n\nsubject to :\nln(yj ) = hj +\n\nm\nP\n\nβij xi\n\n∀tj ∈ Tf .\n\ni=1\n\nwhere J(x, y), the primal objective function, is as follows:\n\nJ(x, y) =\n\nX\ntj ∈Tf\n\nln (1 − yj ) +\n\nm\nXX\ntj ∈Tp i=1\n\nβij xi +\n\nm\nX\n\nln(pi )xi .\n\n(5.2.20)\n\ni=1\n\nBefore we proceed to solve this problem, let us consider the case where the\n\n116\n\ntests are perfect, i.e., P dij = 1 and P fij = 0, for components associated with tests.\nProperty 1: If tests are perfect, for any passed test tj , i.e., tj ∈ Tp , the set\nof all components that are associated with test tj should be healthy.\nProof. Using the definition of perfect test, if a component ci is faulty, i.e., xi = 1, and\nif it is associated with test tj , i.e., P dij = 1, then test tj should fail. In other words,\nxi = 1 ⇒ tj = fail, whose contrapositive is: tj = pass ⇒ xi = 0. Therefore,\nxi = 0 ∀tj ∈ Tp & P dij > 0; in other words, for any test tj where tj ∈ Tp , the set of\nall components that are associated with test tj , i.e., P dij > 0, should be healthy.\nProperty 1 substantially reduces the cardinality of failure sources, S, by\ndiscarding the failure sources covered by passed tests. Let the reduced set of failure\nsources be denoted by S − .\nProperty 2: If tests are perfect, for any failed test tj , i.e., tj ∈ Tf , among\nall components associated with the failed test, i.e. P dij > 0, at least one should be\nfaulty.\nProof. Since, for perfect tests, we have P fij = 0 ∀i, j, hj =\n0, the constraints in (5.2.17) are reduced to ln(yj ) =\n\nm\nP\n\nm\nP\n\nm\n\u0001 P\nln P fij =\nln(1) =\n\ni=1\n\ni=1\n\nβij xi ∀tj ∈ Tf . Suppose\n\ni=1\n\nall components that are associated with the failed test tj are healthy, that is xi =\n0 ∀xi , P dij > 0, then, ln(yj ) = 0. Equivalently, ln (1 − yj ) in the objective function\n(5.2.20) will be unbounded. Therefore, for any tj ∈ Tf , for all P dij > 0 at least one of\nthe xi 's should be 1.\nP\n\nP dij xi ≥ 1 ∀tj ∈ Tf .\n\u0010\n\u0011\n\u0001\nPd\n1−1\nNote that for any tj ∈ Tf , and for any P dij > 0, we have βij = ln P fij = ln 1−0\n=\nThis condition can be compactly expressed as\n\nxi ∈S −\n\nij\n\n117\n\n−∞. Since at least one of the corresponding xi 's is 1, ln(yj ) = −∞ ∀tj ∈ Tf or\nP\nP\nyj = 0 ∀tj ∈ Tf , hence\nln (1 − yj ) =\nln(1) = 0.\ntj ∈Tf\n\ntj ∈Tf\n\nTherefore, the SMFD problem reduces to the following set covering problem:\n\nmax\n\nP\n\nln(pi )xi ,\n\ni∈S −\n\n(5.2.21)\n\nsuch that\nP\nxi P dij ≥ 1, ∀tj ∈ Tf .\ni∈S −\n\nSince the set covering problem is NP-hard, the general problem in (5.2.19) is\nNP-hard as well. We solve the problem in (5.2.19) using Lagrangian relaxation. Note\nthat in (5.2.19) and in the following discussion, the tests are in general imperfect.\nBy relaxing the constraints in (5.2.19), performing some simple manipulations, and\nP\nP\ndefining αi = ln(pi ) +\nβij , ci (λ) = αi −\nλj βij , the relaxed objective function\ntj ∈Tp\n\ntj ∈Tf\n\nwill be as follows:\n\nL(x, y, λ) =\n\nX\n\n{ln (1 − yj ) + λj ln(yj ) − hj λj } +\n\ntj ∈Tf\n\nm\nX\n\nci (λ)xi .\n\n(5.2.22)\n\ni=1\n\nThe advantage of (5.2.22) is that the maximization with respect to x and y can be\ndone separately. As λj ≥ 0, by taking derivative with respect to yj and equating to\nλ\n\nzero, we obtain yj∗ = 1+λj j , where yj∗ denotes the optimal value of yj . By inserting yj∗\ninto (5.2.22) and simplifying, we obtain:\n\nL(λ, x) =\n\nX\n\n{λj ln(λj ) − (1 + λj ) ln(1 + λj ) − hj λj } +\n\ntj ∈Tf\n\nm\nX\ni=1\n\n118\n\nci (λ)xi .\n\n(5.2.23)\n\nIn [167], the above problem is solved iteratively by initializing λj 's to unity, obtaining\nthe optimal solution x∗ of (5.2.23) via a set covering algorithm and then updating\nλj 's via a subgradient approach until a stopping condition is met. For details, the\nreader is referred to [167]. Here, we discuss a purely dual approach to the problem in\n(5.2.23). For any given value of λ, the first summation in (5.2.23) is just a constant and\ntherefore can be discarded, and the maximization of the second summation completely\ndepends on the sign of ci (λ) terms. For any component ci , if ci (λ) is positive, then\nx∗i = 1, and if it is negative, x∗i = 0. Therefore:\n\nx∗i (λ) = u (ci (λ)) = u  αi −\n\n\nX\n\nλj βij   .\n\n(5.2.24)\n\ntj ∈Tf\n\nwhere u(.) is the unit step function. Hence, the SMFD problem in the dual form is as\nfollows:\n\n119\n\nQ(λ) = L(λ, x∗ ) = Q1 (λ) + Q2 (λ),\nP\nQ1 (λ) =\nqj (λj ), qj (λj ) = λj ln(λj ) − (1 + λj ) ln(1 + λj ) − hj λj ,\nQ2 (λ) =\n\ntj ∈Tf\nm\nP\n\nm\nP\n\ni=1\n\ni=1\n\nci (λ)u (ci (λ)) =\n\n(5.2.25)\n\nmax (0, ci (λ)).\n\nNote that ci (λ) is negative with a high magnitude, if\n\n\nFailure source si has a low a priori probability, i.e., psi is close to zero.\n\n\n\nPassed tests have high detection probabilities as long as false alarm probabilities\nare reasonable (less than 0.25).\n\n\n\nFailed tests have low detection probabilities as long as false alarm probabilities\nare reasonable (less than 0.25).\nNext we characterize some properties of the SMFD problem using the dual\n\ncost function.\nProperty 3: In a real-world system, any failure source which is not associated\nwith any of the failed tests, is healthy based on maximum likelihood estimation.\nProof. Since in a real-world system the probability of a failure source being faulty,\ni.e. psi , is small (for example around 0.01 to 0.2), ln(pi ) < 0 and since βij ≤ 0 ∀i, j,\nP\nαi = ln(pi ) +\nβik < 0. If a failure source xi is not related to any of the failed\ntk ∈Tp\n\ntests (tj ∈ Tf ), it is equivalent to saying that it gives neither a false alarm nor a\n\u0001\ndetection to test tj ∈ Tf , that is, P fij = P dij = 0, therefore βij = ln P dij /P fij =\nln (1/1) = 0 ∀tj ∈ Tf . Evidently, ci (λ) = αi , which is always negative. As a result,\nx∗i = u (ci (λ∗ )) = u(αi ) = 0.\n120\n\nProperty 3 can be used to substantially reduce the size of the fault diagnosis\nproblem. Let N = {1, 2, · · · , m} and remove any failure source which is not related\nto any of the failed tests. Let us call the remaining indices as S 0 ⊆ N . Consequently,\nP\nci (λ)u (ci (λ)). Since αi < 0 ∀i and βij ≤ 0 ∀i, j, for a\nQ2 (λ) can be simplified as\ni∈S 0\n\nfailure source to be inferred faulty, the norm kλ∗ k should be sufficiently large. As a\nresult for a given λ∗ , the more negative αi is, the more likely component ci is healthy.\nP\nSince αi = ln(pi ) +\nβik if a component ci is associated with some failed tests (that\ntk ∈Tp\n0\n\nP\n\nis, i ∈ S ) and if it is not associated with any passed tests (that is\n\nβik = 0) then\n\ntk ∈Tp\n\nαi = ln(pi ) < 0. However, if the failure source is associated with some of the passed\nP\ntests (that is\nβik ) then αi < ln(pi ) < 0; hence, in this case the probability of\ntk ∈Tp\n\nx∗i = 1 reduces even further. In other words, the more passed tests a failure source\nsi is associated with, the more negative αi becomes and consequently, the less likely\nfailure source si is in state 1.\n,\nProperty 4: In a real-world system, for any tj ∈ Tf , we have λ∗j ≤ λmax\nj\nhj\n\ne\nwhere λmax\n= 1−e\nhj .\nj\n\nProof. Note that Q1 (λ) is composed of |Tf | separate elements, each equal to qj (λj ),\nhj\n\ne\nand each qj (λj ) is a convex function whose minimum value occurs at 1−e\nhj . As Q2 (λ)\nhj\n\ne\ndoes not contribute a decrease in Q(λ), increasing λj at most up to 1−e\nhj may help in\nhj\n\ne\ndecreasing Q(λ); thus, λmax\n= 1−e\nhj .\nj\n\nProperty 5: In a real-world system, for any i ∈ S 0 if we have αi <\n\nP βij ehj\ntj ∈Tf\n\n1−ehj\n\n,\n\nthen x∗i = 0.\nProof. Since λ∗j ≤ λmax\nbased on property 4, therefore if αi <\nj\nP βij ehj\ntj ∈Tf\n\n1−ehj\n\nP\ntj ∈Tf\n\n, then ci (λ∗ ) ≤ ci (λmax ) < 0. Thus, x∗i = u (ci (λ∗ )) = 0.\n121\n\nβij λmax\nor αi <\nj\n\nBased on Property 5, we can exclude from S 0 any i such that αi <\n\nP βij ehj\ntj ∈Tf\n\n1−ehj\n\n,\n\ncall the remaining indices S 00 and search for failure sources among S 00 . Therefore,\nP\nQ2 (λ) can be simplified as\nci (λ)u (ci (λ)).\ni∈S 00\n\nIn the remainder of this section, we consider a simple example to gain insights\ninto the SMFD problem. Consider a system with three components and two tests,\nwhere test t1 is affected by components c1 and c2 ; test t2 is affected by components\nc2 and c3 . The prior probabilities are ps = [0.15, 0.10, 0.05]T , and the non-zero\ndetection and false alarm probabilities are P d11 = 0.85, P d21 = 0.90, P d22 = 0.80,\nP d32 = 0.95, P f11 = 0.06, P f21 = 0.03, P f22 = 0.07, P f32 = 0.08.\nIn the sequel, we consider the individual terms in the dual function to gain\ninsights into the nature of the dual function. First, consider the function f1 = λj ln(λj ),\nλj > 0. At λj = 1, f1 = 0. For the extreme value of λj → 0+ , we have f1 → 0− and for\nthe other extreme value of λj → +∞, we have f1 → +∞. Therefore, for λj ∈ (0, 1),\nthe convex function f1 is negative (see Fig. 5.2.1(a)) with the minimum value of\nf1∗ = −e−1 occurring at λ∗j = e−1 , and for λj ∈ [1, ∞), the function monotonically\nincreases from zero to infinity (see Fig. 5.2.1(a)).\nNext, we consider f2 = −(λj + 1) ln(λj + 1), which is the negative and timeshifted version of f1 . Note that f2 can be sketched by shifting graph of f1 by one unit\nto the left and then flipping it around the x-axis; thus it is evident that for positive\nλj , the function f2 is always negative (see Fig. 5.2.1(a) and 5.2.1(b)). Therefore, for\nλj ∈ (0, 1) as both f1 and f2 are negative, the summation of these two functions, i.e.\nf3 = f1 + f2 , is also negative (see Fig. 5.2.1). For λj ∈ [1, ∞), the magnitude of f2\nis always bigger than the magnitude of f1 and as f2 is always negative, therefore f2\ndominates f1 . Thus, f3 is negative for all positive values of λj and it goes unboundedly\n\n122\n\nto −∞ as λj → +∞. In fact, it can be shown that as λj → +∞, the function f3\nasymptotically approaches f3asymptotic = −1 − ln(λj + 1) (see Fig. 5.2.1(b)). Note that\nin the case of multiple faults, there exist multiple Lagrangian multipliers. First, we look\nP\n{λj ln(λj )}, which\ninto the Q1 (λ) part of the dual function. For now, we consider\ntj ∈Tf\n\nP\n\nis actually\n\nf1 (λj ) and\n\ntj ∈Tf\n\nP\n\nP\n\n{λj ln(λj ) − (1 + λj ) ln(1 + λj )}, which is actually\n\ntj ∈Tf\n\nf3 (λj ). From the equations, it is clear that both of these functions are symmetric\n\ntj ∈Tf\n\nwith respect to the Lagrange multipliers. Figures 5.2.1(c) and 5.2.1(d) show the plots\nof these functions in a two dimensional space (which corresponds to a two-failed-tests\nP\nscenario). The plot of\nf1 (λj ) has a cup-shape surface which first heads down and\ntj ∈Tf\nT\n\nreaches the minimum value of −2e−1 at λ∗ = [e−1 , e−1 ] , and thereafter, it heads up\nand monotonically goes to infinity (see Fig. 5.2.1(c)).\n\n(c)\n\n(a)\n\n-2\n\nf (λ)\n\n-3\n\n1\n\n0\n\n1\n\n-0.5\n1.5\n\n-4\n0\n\n0.5\n\n1\nλ\n\n1.5\n\n1\n\n2\n\n0.5\n\n0 0\n\nλ2\n\n(b)\n\n1\n\n1.5\n\n(d)\n3\nfasymptotic(λ)\n3\n\n2\n\n-2\n-3\n\n3\n\n-1\n\n-4\n0\n\n0.5\nλ1\n\nf (λ)\n\n0\n\n-1\n\n1\n\n3\n\n0.5\n\n-2\n\n3\n\n2\n\nf (λ )+f (λ )\n\n1\n\n2\n\n-1\n\nf (λ)\n\n1\n\nf (λ)\n\nf (λ )+f (λ )\n\n0\n\n5\n\n10\n\n15\nλ\n\n20\n\n25\n\n30\n\n-3\n0\n\n0.5\n\n1\nλ2\n\n1.5 1.5\n\n0.5\n\n1\nλ1\n\nFigure 5.2.1: Some plots regarding the dual function\n\n123\n\n0\n\nAs we saw, f3 (λ) is a monotonically decreasing function (Fig. 5.2.1(b)). Thus\nP\n\nf3 (λj ) is also a monotonically decreasing function. The function for the case of\n\ntj ∈Tf\n\nthe two-failed-tests scenario is shown in Fig. 5.2.1(d). For clarity of presentation,\nthe direction of λ1 and λ2 in Fig. 5.2.1(d) is chosen to be opposite of those in Fig.\n5.2.1(c).\nNext, we consider the effects of −hj λj in the Q1 (λ) part of the dual function.\nm\n\u0001\nP\nln P fij is always negative, and in the above example |h2 | > |h1 |,\nNote that hj =\ni=1\n\nbecause false alarm probabilities form components to test t2 are greater than those\nto t1 (h1 = −0.092, h2 = −0.156). The line −hj λj has always a positive slope,\nand it finally dominates f3 , because f3 is asymptotic to the logarithmic function\n−1 − ln(λj + 1); thus (f3 − hj λj ) → +∞ as λj → +∞. Figure 5.2.2(a) shows the plots\nof f3 (λ), −h1 λ, −h2 λ, f3 (λ) − h1 λ, and f3 (λ) − h2 λ. Figure 5.2.2(b) shows the Q1 (λ)\npart of the dual cost function, which is asymmetric in the Lagrangian dimensions\ndue to unequal hj 's, with a sharper slope in the direction of λ2 , because |h2 | > |h1 |.\nIntuitively, if the probabilities of the false alarms from different failure sources to\nthe failed tests are high, the magnitudes of hj 's are high, which in turn results in\nan increase in the slope of −hj λj line and this results in λ∗j 's to have low values. As\nthe parameters αi and βij are always negative, the low values of λ∗j 's result in more\narguments of ci (λ∗ ) to become negative; hence more components will likely be healthy.\nP\n(ci (λ)) u (ci (λ)). Note that for\nNext, we consider the Q2 (λ), which is\ni∈S 00\n\neach failure source of this summation, ci (λ) = 0 is a hyperplane in |Tf | dimensions;\nthe failure source makes no contribution to the dual cost function if ci (λ) ≤ 0 (because\nu (ci (λ)) = 0), while it makes a positive linear contribution if ci (λ) > 0; thus sharp\ncorners are created in the dual cost function and make the dual cost function nondifferentiable. In our example, as we have three components (failure sources), there\n124\n\nexist three hyperplanes (here they are just lines because |Tf | = 2), one for each\ncomponent. Figure 5.2.2(c) shows these three lines and also the place where the\nminimum dual cost occurs. Figure 5.2.2(d) shows the dual cost function, which is\nobtained by adding the contributions of the non-differentiable function Q2 (λ) to the\ndifferentiable function Q1 (λ) shown in Fig. 5.2.2(b).\n\n(a)\nf (λ)\n\n(c)\n\n10\n\n1.5\n\n5\n\n1\n\n3\n\n(0.95, 1.01)\n(λ*1, λ*2)=(0.48, 0.73)\n\nλ2\n\n-h λ\n1\n-h λ\n2\nf (λ)-h λ\n3\n1\n\n0\n\nf (λ)-h λ -5\n3\n2\n0\n\n0.5\n\n10\n\n20\n\n30\n\n40\n\n0\n0\n\n50\n\n(0.97, 0)\n\n0.2\n\n0.4\n\n0.6\n\nλ\n\nλ1\n\n(b)\n\n(d)\n\n0.8\n\n1\n\n6\nQ(λ , λ )\n\n2\n\n0\n\n1\n\nf (λ )-h λ +f (λ )-h λ\n3 1\n1 1 3 2\n2 2\n\n(0, 1.43)\n\n-2\n-4\n40\n\n40\n\n20\nλ2\n\n0 0\n\n20\n\n4\n2\n0\n2\n1\nλ2\n\nλ1\n\n0\n\n0\n\n1\n\n0.5\n\n1.5\n\n2\n\nλ1\n\nFigure 5.2.2: Dual cost function analysis\n\nNote that, at the optimal point λ∗ , if ci (λ∗ ) is negative, then x∗i = 0 and if\nit is positive, then x∗i = 1. However, for some components, we may have ci (λ∗ ) = 0,\nand we cannot decisively assign a value to x∗i because the contribution of (ci (λ∗ )) x∗i\nto Q(λ) is zero irrespective of x∗i being one or zero. For these cases, we should either\ncheck the primal cost function or use the set-covering ideas. Note that for the following\nreasons, there are not many cases of this kind:\n\n125\n\n1. In practice, the number of failed tests |Tf | is not large. As a result, the probability\nthat ci (λ∗ ) = 0 tends to be low.\n2. In practice, the cause-effect relation of failure sources and tests is sparse (not all\nfailure sources affect all tests). Therefore, not all hyperplanes have full dimension\n(|Tf − 1|).\n3. As we saw in the illustrative example, the optimal point may occur on one\nhyperplane or few hyperplanes whose intersection is not a point but lower\ndimensioned hyperplanes.\n4. The possibility of the optimal point being on a low-dimension hyperlane dramatically restricts the number of hyperplanes that include the optimal point. For\nexample, given that the optimal point is on a hyperplane with dimension one (a\nline), then there exist only two generic possibilities: a) the only hyperplane that\nincludes the optimal point, is that line, b) a line generally can intersect only a\nfull-dimension (with dimension |Tf | − 1) hyperplane.\nIn our example, the optimal Lagrange multipliers (to three digits of accuracy)\nare λ∗1 = 0.476, λ∗2 = 0.726. The evaluation of ci (λ∗ ) for the three components are,\nrespectively, -0.86, 7.2 × 10−5 , and -0.83. Evidently, x∗1 = 0 and x∗3 = 0. Since for\nx2 , the argument is very close to zero, we should either evaluate the primal cost for\nboth candidates of x2 = 1 and x2 = 0, or use the set-covering idea for deciding on the\nassignment for x∗2 . Thus, we need to evaluate the primal cost for x1 x2 x3 = 000 and\nx1 x2 x3 = 010 and choose the one with the maximum value. The primal cost function\nfor these two candidates are, respectively, -4.36 and -2.50, therefore x1 x2 x3 = 010 is\nthe most likely candidate. Also, since component c2 covers both failed tests, it should\n126\n\nbe faulty; thus we reach the same conclusion either way.\nThe non-differentiability of dual cost function demands the use of numerical\noptimization tools, such as subgradient algorithm, to find its optimal point. Recently,\nsurrogate Lagrangian relaxation (SLR) method [37], which provides a general purpose\nrapidly converging algorithm for mixed-integer programming problems, has been\nproposed. The method, fundamentally, is based on two key ideas: a) decreasing\nthe distance between Lagrange multipliers in consecutive iterations, by selecting\nappropriate step sizes, and b) preventing the algorithm from premature termination,\nby keeping step sizes sufficiently large. This algorithm has been used for solving the\ndual problem in (5.2.25).\n\n5.3\n\nDynamic Multiple Fault Diagnosis\n\nIn this section, we discuss the dynamic multiple fault diagnosis (DMFD) problem.\nThe difference between the DMFD and SMFD is that the states of the potential failure\nsources and the tests and their observations are functions of time. The additional\nassumptions for DMFD are the following:\n\n\nTime epochs of the system evolve in a discrete manner, from k = 0 to k = K.\n\n\n\nAt any time epoch k, the state variable of component ci (or failure source si ) is\nxi (k) and the test outcomes are tj (k).\n\n\n\nPrior probability psi is defined as psi = Pr (xi (0) = 1).\n\n\n\nThe dynamics of states of components are assumed to be Markovian; in other\nwords, there is a probability of fault appearance and probability of fault vanishing\n127\n\n(disappearance) as follows:\nProbability of Fault Appearance: P ai (k) = Pr (xi (k) = 1|xi (k − 1) = 0).\nProbability of Fault Vanishing: P vi (k) = Pr (xi (k) = 0|xi (k − 1) = 1).\nBased on the above assumptions, the DMFD problem is defined as follows:\nDynamic Multiple Fault Diagnosis (DMFD) Problem : Given a set\nof test observations in K + 1 epochs (namely, T K ) where T K ⊆ tK , and given the\ninitial states of components (namely, x(0)),what is the most likely evolution of state\nsequence xK of each potential failure source?\nNote that the observed test outcome sequence T K may not include all of the\ntest outcomes. Formally, we can represent the problem as follows:\n\n\u0001\nx̂K = arg max Pr xK |T K , x(0) .\nxK\n\n(5.3.1)\n\nAs before, using Bayes' rule, the problem is equivalent to\n\n\u0001\n\u0001\nx̂K = arg max Pr T K |xK , x(0) Pr xK |x(0) .\nxK\n\n(5.3.2)\n\nUsing the assumptions that (i) passed and failed tests at a given epoch and the tests\nat different epochs are conditionally independent, (ii) invoking the Markovian nature\nof failure source state evolution, and (iii) using the fact that maximizing the posterior\nis equivalent to maximizing the log-posterior, we can simplify (5.3.2) as follows:\n\nK\n\nx̂ = arg max\nxK\n\nK\nX\n\nfk (x(k), x(k − 1)),\n\nk=1\n\n128\n\n(5.3.3)\n\nwhere\nfk (x(k), x(k − 1)) = ln (Pr (Tp (k)| x(k))) + ln (Pr (Tf (k)| x(k)))\n\n(5.3.4)\n\n+ ln (Pr (x(k)|x(k − 1))) .\nNow, let us find each of the three elements in the right hand side of (5.3.4). The first\ntwo terms are similar to the SMFD case. Therefore,\n\nln (Pr (Tp (k)|x(k))) = ln(yj (k)) = γ(k) +\n\nX\n\nm\nX\n\nβij xi (k),\n\n(5.3.5)\n\ntj (k)∈Tp (k) i=1\n\nwhere\nX\n\nγ(k) =\n\nhj ,\n\n(5.3.6)\n\ntj (k)∈Tp (k)\n\nX\n\nln (Pr (Tf (k)| x(k))) =\n\nln (1 − yj (k)).\n\n(5.3.7)\n\ntj (k)∈Tf (k)\n\nThe third term in (5.3.4), using the Markov property, can be computed as follows:\n\nln (Pr (x(k)|x(k − 1))) =\n\nm\nX\n\nln (Pr (xi (k)|xi (k − 1))).\n\n(5.3.8)\n\ni=1\n\nAs each of xi (k − 1) and xi (k) has two possible values, there exist four combinations\nfor Pr (xi (k)|xi (k − 1)). Therefore, Pr (xi (k)|xi (k − 1)) can be compactly represented\n\n129\n\nas follows:\nPr (xi (k)|xi (k − 1)) = (1 − P ai (k))(1−xi (k−1))(1−xi (k)) (P ai (k))(1−xi (k−1))xi (k)\nxi (k−1)(1−xi (k))\n\n(1 − P vi (k))\n\nxi (k−1)xi (k)\n\n(P vi (k))\n\n(5.3.9)\n\n.\n\nInserting (5.3.9) into (5.3.8), and after some simplifications, we get the following\nformula:\nln (Pr (x(k)|x(k − 1))) =\n\nm\nP\n\nμi (k)xi (k) +\n\ni=1\n\nm\nP\n\nm\nP\n\nσi (k)xi (k − 1)\n\ni=1\n\nhi (k)xi (k)xi (k − 1) + g(k),\n\u0010\n\u0011\nP vi (k)\nσi (k) = ln 1−P\n,\nai (k)\nm\nP\ng(k) =\nln (1 − P ai (k)).\n\n+\n\ni=1\n\n\u0011\n\nμi (k) = ln\n\n\u0010\n\nP ai (k)\n1−P ai (k)\n\nhi (k) = ln\n\n\u0010\n\n(1−P ai (k))(1−P vi (k))\nP ai (k)P vi (k)\n\n,\n\u0011\n\n,\n\n(5.3.10)\n\ni=1\n\nThus, the DMFD problem is as follows:\nX̂ K = arg max\nXK\n\nK\nP\n\nfk (x(k), x(k − 1), y(k)),\n\nk=1\n\nfk (x(k), x(k − 1)) =\n\nP\n\nm\nP\n\nP\n\nln (1 − yj (k))\n(5.3.11)\nm\nm\nP\nP\n+ μi (k)xi (k) +\nσi (k)xi (k − 1)\nβij xi (k) + γ(k) +\n\ntj (k)∈Tp (k) i=1\n\n+\n\ni=1\nm\nP\n\ntj (k)∈Tf (k)\n\ni=1\n\nφi (k)xi (k)xi (k − 1) + g(k),\n\ni=1\n\nsubject to\n\nln (yj (k)) = hj +\n\nm\nX\n\nln(βij )xi (k).\n\n(5.3.12)\n\ni=1\n\nThe next step, as we did in SMFD, is to use Lagrangian relaxation. For this purpose,\nthe constraint (5.3.12) is relaxed using Lagrange multipliers λj (k). The resulting\n\n130\n\nLagrangian function is:\n\nL(x, y, λ) =\n\nK\nP\nk=1\n\nfk (x(k), x(k − 1), y(k))\n\u0012\n\u0013 (5.3.13)\nm\nP\nP\n+\nλj (k) ln (yj (k)) − hj −\nln(βij )xi (k) ,\ni=1\n\ntj (k)∈Tf (k)\n\nwhere λ = {λj (k) ≥ 0, k ∈ {1, ..., K}, tj (k) ∈ Tf (k)} is the set of Lagrange multipliers.\nThe dual of primal DMFD problem can be written as\nmin Q(λ),\nλ\n\n(5.3.14)\n\nsubject to: λ = {λj (k) ≥ 0, k ∈ {1, ..., K}, tj (k) ∈ Tf (k)} ,\nwhere the dual function is\n\nQ(λ) = max L(x, y, λ).\nx,y\n\n(5.3.15)\n\nTaking derivative of L(x, y, λ) with respect to yj (k) and equating it to zero yields the\nλ (k)\n\noptimal yj∗ (k) as 1+λj j (k) . Inserting y∗ (k) into (5.3.15), we get Q(x, λ) = L(x, y∗ , λ),\nwhich, after some manipulation, yields:\n\nQ(λ) = max\nx\n\nm\nX\n\nQi (xi , λ),\n\n(5.3.16)\n\ni=1\n\nwhere,\n\u001b\nK \u001a\nX\n1\nQi (xi , λ) =\nξi (xi (k), xi (k − 1), λj (k)) + ωk (λ) ,\nm\nk=1\n\n131\n\n(5.3.17)\n\n!\nP\n\nξi (xi (k), xi (k − 1), λj (k)) =\n\nβij + μi (k) +\n\ntj (k)∈Tp (k)\n\nP\ntj (k)∈Tf (k)\n\nβij λj (k) xi (k)\n(5.3.18)\n\n+σi (k)xi (k − 1) + φi (k)xi (k)xi (k − 1),\n\nωk (λ) = γ(k) + g(k) +\n\nP\n\nλj (k) ln (λj (k)) − λj (k)hj\n\ntj (k)∈Tf (k)\n\n−\n\nP\n\n(5.3.19)\n\n(1 + λj (k)) ln (1 + λj (k)).\n\ntj (k)∈Tf (k)\n\nNote that the original problem has been converted to a separable problem in (5.3.16),\nwhere the problem is one of solving m (one problem per component) much simpler\nproblems. The dual problem can be solved in an iterative two-level strategy where\nseparable problems of maximization Qi (xi , λ) with respect to xi is performed using\nthe Viterbi algorithm (dynamic programming) and then the Lagrange multipliers are\nupdated using surrogate subgradient methods. For more details about the implementation of the algorithm, extensions of this method to coupled, delayed failure source\nstate propagation, and delayed observations, the reader is referred to [170], [103], [180],\n[104], and [204].\n\n5.4\n\nFault Diagnosis in Active Probing (Sequential\nFault Diagnosis) and Fault Diagnosis Applications\n\nPassive monitoring, discussed as SMFD and DMFD in the previous sections, may\nstill result in residual ambiguity as to sources of failure. The diagnosis from passive\nmonitoring is followed by active probing to troubleshoot the source of failures. In this\n\n132\n\nsection, we consider the active probing problem used for sequential fault diagnosis and\npoint to the applications of fault diagnosis in a number of industrial contexts, including\nautomotive, aerospace, and power systems. In the context of a static single fault\ndiagnosis problem with perfect binary tests and failure sources with binary outcomes,\nthe test sequencing problem can be conceptualized as a four-tuple (S, p, T, c), where\nS is the finite set of system states composed of the fault-free state s0 and m failure\nsources denoted by s1 , s2 , . . . , sm . Associated with each failure source si and fault-free\nstate s0 is the a priori probability denoted by p = [p0 , p1 , . . . , pm ]T . The vector p\nis therefore the a priori probability vector. The test set T is composed of n tests,\ni.e., T = {t1 , t2 , . . . , tn } and the cost vector c = [c1 , c2 , . . . , cn ]T associates a cost to\neach test. The diagnostic dictionary (code book) matrix D has the dimension of\n(m + 1) × n whose ij-th element is one if test tj is able to detect the fault state of si\n(i.e., si is associated with tj ) and zero otherwise. The problem is to design a sequential\ntesting algorithm that unambiguously identifies the fault states using the set of tests,\nwhile minimizing the expected test cost given by\n\nT\n\nJ = p Ac =\n\nm X\nn\nX\n\naij pi cj ,\n\n(5.4.1)\n\ni=0 j=1\n\nwhere A is an (m + 1) × n matrix whose ij-th element is one if test tj is used in\nthe path leading to the identification of failure source si and zero otherwise. The\nproblem is a perfectly observed Markov decision problem (MDP), whose solution is a\ndeterministic AND/OR binary decision tree. In this tree, each OR node is labeled by\na subset of S, which is called the ambiguity subset (state in an MDP), and each AND\nnode denotes a test at an OR node (control or action in an MDP), and divides its\ninput ambiguity subset into two disjoint ambiguity subsets at the output. As shown in\n133\n\n[87], however, the construction of the optimal decision tree is NP-complete. Therefore,\na way of tackling the problem is to use heuristic search strategies with tight bounds\non the cost-to-go [55], [62], [138].\nIn [138], the test sequencing problem (TSP) is solved using an ordered, bestfit search on an AND/OR graph using different heuristic evaluation functions (HEF)\nbased on Huffman coding and entropy. It is shown that among the HEFs used [138],\na HEF based on Hufmann code length is the best choice for medium-sized problems\n(m < 100) and that a HEF based on entropy plus one is suitable for larger problems.\nRollout strategies have been employed to extend the range of applicability to even\nlarger problems [179]. Reference [139] generalizes the test sequencing problem (TSP)\n[138] to modular diagnosis, wherein testing stops when a faulty module is isolated.\nThe dynamic programming recursion for this generalized TSP is derived in [139] and\nlower bounds on the optimal cost-to-go are derived based on information theory. The\nproblem is generalized to include test setups, precedence constraints on tests, multiple\ntest outcomes, multiple system modes, and hierarchical test sequencing in [154], [161],\n[36]. In [155], the TSP was extended to consider the following cases:\n\n\nMinimize the maximum test cost.\n\n\n\nTSP with an upper bound on expected test time.\n\n\n\nTSP that achieves the lowest average ambiguity group size subject to a constraint\non the number of tests.\n\n\n\nTSP that achieves the lowest expected test storage cost.\nReference [156] extends the test sequencing problem to the case where the\n\ntests are imperfect. Optimal and near-optimal test sequence construction methods for\n134\n\nmultiple fault diagnosis are discussed in [168]. The test sequencing problem becomes\neven more difficult in hybrid systems with multiple modes of operation. This is\nbecause, in a multimode system, the availability of tests depends on the mode of the\nsystem and even the same test may have different diagnostic capabilities in different\nmodes. The multimode test sequencing problem is discussed in detail in [161]. TEAMS\n(Testability Engineering And Maintenance System) [137], [57] is a package designed\nfor automatic test sequencing and testability analysis of complex modular systems\nfor multi-mode systems with multi-valued failure source states and multi-valued test\noutcomes [3].\nBefore we close this section, we mention some of the real world applications\nof fault diagnosis. Two of the applications of passive monitoring appear in tools\nsuch as QMR-DT [169], [200] and ARES-I [3]. Some of the Aerospace applications of\nactive probing include UH-60, SH-60B, and Sikorsky S92 helicopters (transmission\nsystem, engine subsystem, landing gear control unit) and a receiver synthesizer (e.g.\nJTIDS-RS). A few of these applications can be found in [179], [180]. Fault diagnosis in\nautomotive systems (engine control systems, antilock breaking systems, electric power\ngeneration and storage systems) is discussed in [120], [46], [119], [105]. Model-based\ndiagnosis of an automotive engine is discussed in [133]. In [18], the fault diagnosis\ntechnique is used for identifying and evaluating power quality problems. Ref. [45]\ndiscusses fault diagnosis in Heating, Ventilation and Air Conditioning (HVAC) systems.\nApplication of hierarchical test sequencing in a lithographic machine can be found\nin [36]. TSP has been effectively used to troubleshoot problems in semiconductor\nfabrication facilities as well.\n\n135\n\n5.5\n\nRelevant Work\n\nIn this section, we place passive monitoring and active probing discussed in the previous\nsections in the context of literature on fault detection and diagnosis (FDD). FDD\nmethods have mainly evolved upon three major paradigms, viz., model-based, datadriven and knowledge-based approaches. The FDD model-based approaches require\nmathematical representation of the system, hence, they are effectively applicable\nwhen satisfactory physics-based models of the system and an adequate number of\nsensors for state observation are available. Most applications of model-based diagnosis\nare restricted to systems with a relatively small number of inputs, outputs, and\nstates. The main advantage of a model-based approach is incorporating a physical\nunderstanding into the process monitoring scheme. However, it is difficult to apply the\nmodel-based approach to large-scale systems because it requires detailed analytical\nmodels of failures in order to be effective.\nThe FDD data-driven approaches are preferred when system models are\nnot available, but instead system monitoring data is available. This situation arises\nfrequently when subsystem vendors seek to protect their intellectual property by not\nproviding internal system details to the system integrators. In these cases, experimental\ndata from an operating system or simulated data from a black-box simulator will\nbe the major source of system knowledge for FDD. Neural network and statistical\nclassification methods are illustrative of data-driven techniques. Significant amount\nof data is needed from monitored variables under nominal and faulty scenarios for\ndata-driven analysis.\nThe FDD knowledge-based approaches require qualitative models for process\nmonitoring and troubleshooting. These approaches are especially well-suited for sys-\n\n136\n\ntems for which detailed mathematical models are not available. Most knowledge-based\ntechniques are based on casual analysis, expert systems, and/or ad hoc rules. Because\nof the qualitative nature of these models, knowledge-based approaches have been\napplied to many complex systems. Graphical models such as Petri nets, multi-signal\nflow graphs and Bayesian networks are applied for diagnostic knowledge representation\nand inference in automotive systems. Bayesian Networks subsume the deterministic\nfault diagnosis models embodied in the Petri net and multi-signal models. Model\nbased, data-driven and knowledge-based approaches provide the sand box that test\ndesigners can use to experiment with, and systematically select relevant models or\ncombinations thereof to satisfy the requirements on diagnostic accuracy, computational speed, memory, on-line versus off-line diagnosis, and so on. Ironically, no single\ntechnique alone can serve as the diagnostic approach for complex systems. Thus, an\nintegrated diagnostic process that naturally employs data-driven techniques, graphbased dependency models and mathematical/physical models is necessary for fault\ndiagnosis, thereby enabling efficient maintenance of these systems.\nThe graphical methods we discussed in previous sections belong to knowledgebased methods using cause-effect relations between the failure sources and test outcomes using false-alarm and detection probabilities. When the false alarm probabilities\nof all tests are zero, the problem simplifies to the parsimonious covering theory [56],\n[158], [144], [145]. In [144], based on probabilistic causal methods, a competitionbased connectionist method is proposed to overcome the combinatorial explosion of\ncomputing the posterior probability of all possible combinations of failure sources.\nThis method, however, does not guarantee a global optimum and is computationally\nexpensive, even for small problems (e.g., m = 26). Genetic algorithm-based methods\nfor MFD are used in [127], [31]. These algorithms, however, converge extremely slowly\n137\n\nand have been applied to small-size problems (e.g., m = 20, n = 20). In [197], a\nsymptom clustering method is used which exploits the weak causal intersections in\npartially decomposable diagnosis structures. This approach, however, does not scale to\nsystems with large numbers of non-decomposable causes and symptoms. In [167], the\nMFD problem is formulated as one of maximizing the log of the posterior probability\nof the hypothesized faults and the resulting constrained optimization problem is solved\nusing Lagrangian relaxation [27], [64] and a subgradient method [29], [30]. It is shown\nthat when tests are perfect (no false alarms and no missed detections), the MFD is\nreduced to a set covering problem [167]. However, it is well-known that set covering\nproblem (SCP) is NP-hard [72], and different algorithms have been proposed for\nSCP, including tree-search procedures [182], [26] , genetic algorithm [28] , and greedy\nheuristics [48].\nThe dynamic fault diagnosis problem is discussed in [172], [173], using linear\ndifference equations relating HMM and neural network based pattern recognition. The\ndrawback of this approach is that building a neural network for a large number of\nclasses (here, faults) is difficult [131], [189]. Graph theory has been widely used in fault\ndiagnosis and safety-critical systems can be modeled at an abstract level as directed\ngraphs [157], [106], [99], [44]. In [52], [63], the multiple fault diagnosis algorithms are\nproposed, assuming that at most k components in the system are faulty (the system is\nk-diagnosable). In [53], [33], [19], probabilistic models are proposed for fault diagnosis\nin these contexts.\nThe fault diagnosis problem has also been extensively studied in the control\nand estimation literature. A classic survey on the traditional model-based fault\ndetection techniques is by Willsky [194]. Here, a system is represented by two sets of\n\n138\n\nequations: system dynamics and sensor equations.\n\nx(k + 1) = Φ(k)x(k) + B(k)u(k) + w(k),\n\n(5.5.1)\n\nz(k) = H(k)x(k) + J(k)u(k) + v(k),\n\n(5.5.2)\n\nwhere x, u, and z are, respectively, the state vector, input vector, and\nmeasurement vector, Φ, B, H, and J are matrices, w and v are zero-mean, independent,\nwhite Gaussian noise processes, defined by the following covariances [194]:\n\n\b\nE w(k)wT (j) = Qδ(k, j),\n\n\b\nE v(k)vT (j) = Rδ(k, j),\n\n(5.5.3)\n\nwhere δ(k, j) is the Kronecker delta function, which is “one” if k = j and “zero”\notherwise. Equations (5.5.1)-(5.5.2) represent the “normal operation” or “no failure”\nmodel of the system [194]. A failure is defined as an abrupt change in the behavior of\nthe system which could be caused, for example, by a malfunction in actuators, plant,\nor sensors. The failure diagnosis problem here is comprised of three tasks: alarm,\nisolation, and estimation [194]. The alarm task is a binary decision of existence or\nnonexistence of failure in the system. The isolation task is determining the source of\nfailure, and the estimation task is to evaluate the extent of failure; for example is it a\ncomplete failure such as a sensor burn-out or is it a partial failure such as a sensor bias?\n[194]. In recent terminology, however, “alarm” is often referred to as “detection”, and\n“isolation with or without estimation” as “diagnosis”. Among elementary algorithms\nfor failure detection are the Shewhart control chart, geometric moving average (GMA),\nfinite moving average (FMA), filtered derivative algorithm, and some more advanced\n139\n\napproaches such as cumulative sum (CUSUM)-type algorithms, Bayes-type algorithms,\nand generalized likelihood ratio (GLR) test [24]. The traditional approaches discussed\nin [194] include “failure-sensitive” filters [61], [176], [94], [95], [101], [25], [98], voting\nsystems (for systems with high degree of redundancy in parallel hardware), multiple\nhypothesis filter-detectors [111], [16], [50], jump process techniques [35], [34], and\ninnovation-based detection systems [123], [125], [166], [80], [149], [193].\nThe failure-sensitive filters are categorized into two groups: indirect and\ndirect approaches. Indirect failure detection approaches, such as exponentially ageweighted filter [61], [176], limited memory filter [94], noise covariance increase [95],\nrespond faster than a normal filter and one can make failure detection decision by\nabrupt changes in state estimates. Direct failure detection approaches, however, assign\n“failure states” to failure modes (e.g., bias onset in a sensor), and failure is detected once\na failure state deviates notably from its nominal value [101]. This method provides\nfailure alarm, isolation, and estimation, all at once, at the cost of dimensionality\nenlargement and also performance degradation during normal conditions [194]. A\nsystematic direct approach, which is applicable to a wide variety of abrupt changes\nin linear time-invariant (LTI) systems, is discussed in [25], [98], where a filter, with\nthe dynamical form of (5.5.4), is assigned to the LTI system of ẋ(t) = Ax(t) + Bu(t)\nwith the measurement equation of z(t) = Cx(t).\nd\nx̂(t) = Ax̂(t) + D (z(t) − Cx̂(t)) + Bu(t).\ndt\n\n(5.5.4)\n\nHere, the gain matrix D is designed in a manner to highlight the effects of\ncertain failures in the residuals of z(t) − Cx̂(t). In other words, D is chosen so that\nspecific failure modes have distinct directions (“signatures”) in the space of residuals\n140\n\n[194].\nA geometrical formulation of the filter is presented in [121]. The method\nin [25], [98] was reformulated as an eigensystem assignment problem in [190], which\ngreatly simplifies the design process. Multiple hypothesis filter-detectors are based\non using a bank of filters based on different hypotheses for the system behavior;\ninnovations from these hypothesized models are used to find the most likely model\n[194]. A simple innovation-based detection approach is the chi-squared test [123],\n[195]. The chi-squared test is an alarm method with a binary decision output and it\nis useful in detecting failure modes that have noticeable effects on innovations, but\nis not sensitive in detecting subtle failure modes [194]. The drawbacks of the simple\nchi-squared test was partly the motivation for developing the generalized likelihood\nratio (GLR) test [193], [195]; a modified version of GLR test was proposed in [23]\nto overcome the two drawback of GLR, namely, the coupling effect between the\nwindow size and hypothesis testing threshold and the possibly high sensitivity to the\nhypothesis testing threshold [22]. Since both faults and model uncertainties affect the\nresiduals, the task of a “robust” FDI system is to be sensitive to faults and insensitive\nto uncertainties [142]. The various aspects of robustness in fault diagnosis systems\nare discussed in [47], [142], [67].\nAnother line of attack for fault diagnosis is the knowledge-based approaches\nusing artificial intelligence techniques, such as qualitative reasoning, fuzzy systems\nand neural networks [69], [129]. The QSIM algorithm is a purely qualitative algorithm\nthat is used in the medical context [108], [109], [110]. An example of the use of\nqualitative reasoning in the automotive industry is [174]. Fault diagnosis using fuzzy\nand neuro-fuzzy methods are discussed in [58], [17], [112], [91], [141]. Both shallow\nknowledge and deep knowledge fuzzy models are used for fault diagnosis [58]. The\n141\n\nneural network is another fault diagnosis method, which acts as a mapping from\nobservations of sensor outputs and the alarms (which themselves are the outputs of\nsome fault detection systems) to the faults or the hypothesized failure modes. However,\nthe use of neural networks as a fault diagnosis tool is viable only in the absence of an\naccurate system model and abundance of process history data [181].\nAnother work related to the diagnosis problem is discriminability, diagnosability and optimal sensor placement [178], [107]. Discriminability level of a system is the\nnumber of faults that can be discriminated given a set of sensors [178]. Diagnosabilty\ndegree is how the discriminability level is related to the total anticipated faults in\nthe system [178], and sensor placement deals with optimal placement of sensors to\nincrease the diagnosability of the system.\nAnother direction in the literature is diagnosis approaches for discrete-even\nsystem (DES) [171], [163], [164], [96], which are based on the hypothesis that any\nexecuted faulty event in a DES is diagnosed within a bounded number of statetransitions/events [96].\nFor more information on fault diagnosis methods, the interested reader is\nreferred to the following papers and books: [194], [47], [90], [126], [129], [22], [73],\n[65], [140], [66], [67], [93], [142], [70], [184], [185], [183], [13], [92], [203], [86], [54], [71],\n[163], [24], [74], [143], [95], [40].\n\n5.6\n\nSummary\n\nIn this chapter, we discussed the problem of fault diagnosis in complex systems using\nknowledge-based probabilistic graphical models in two different contexts: static and\n\n142\n\ndynamic. The fault diagnosis problem is represented using a tri-partite probabilistic\ngraphical model. The first layer of this tri-partite graph is composed of components of\nthe system, which are the potential sources of failures. The healthy or faulty condition\nof each component is represented by a binary state variable which is zero if the\ncomponent is healthy and one otherwise. The second layer is composed of tests with\nbinary outcomes (pass or fail) and the third layer is the noisy observations associated\nwith the test outcomes. The cause-effect relations between the states of the components\nand the test outcomes can be compactly modeled in terms of detection and false alarm\nprobabilities. When the probability of fault detection is one and the probability of\nfalse alarm is zero, the test is termed perfect; otherwise it is deemed imperfect. In the\ncase of perfect tests, the static multiple fault diagnosis (SMFD) problem reduces to a\nset-covering problem, which itself is an NP-hard problem. We discussed the SMFD\nproblem in its general form by maximizing the posterior probability of component\nstates given the fail or pass outcomes of tests. Since the solution to this problem\nis known to be NP-hard, we used a Lagrangian (dual) relaxation technique to find\nnear-optimal diagnostic solutions, which has the desirable property of providing a\nmeasure of sub-optimality in terms of the approximate duality gap. Indeed, the\nsolution would be optimal if the approximate duality gap is zero. The static problem\nis discussed in detail and a pure dual cost function is derived. By presenting some\ngraphical illustrations, we provided insights into the properties of the non-differentiable\ndual function.\nWe also discussed the multiple fault diagnosis in a dynamic context (DMFD),\nwhere it is assumed that the states of components evolve as independent Markov\nchains and that, at each time epoch, we have access to some of the test outcomes.\nFinally, we discussed the fault diagnosis problem in the context of active probing\n143\n\n(also termed sequential testing or troubleshooting), where information is sequentially\nacquired to isolate the faults in minimum time, cost or other economic factors, and\nwe briefly mentioned some of the applications of fault diagnosis.\n\n144\n\nChapter 6\nUnification of Leaky Noisy OR and\nLogistic Regression Test Models\n\n6.1\n\nIntroduction\n\nIn this chapter, we discuss two widely-used graphical test models for fault diagnosis,\nnamely, Detection-False Alarm (DFA) and leaky noisy OR (LNOR) test models, and\nwe prove that they are equivalent. Two realizations of logistic regression (LR) are\nalso discussed and their similarities with DFA and LNOR test models are discussed.\nThen, we propose a unified test model that includes LNOR and LR test models, and\ndefine the resulting fault diagnosis problem as one of MAP inference in a bi-partite\ndigraph. The MAP problem is solved using the Lagrangian relaxation method and\na dual cost function is derived. Comparisons of the LNOR and LR test models are\npresented using a simple example.\nThis chapter is organized as follows. In section 6.2, we discuss two test\n\n145\n\nmodels based on probabilistic graphical models, viz., Detection-False Alarm (DFA)\nand leaky noisy OR (LNOR), that are used for fault diagnosis, and we prove that for\neach DFA test model, there exists a unique LNOR test model. Then, in section 6.3,\nwe discuss logistic representation of test models for fault diagnosis and present the\nlogistic combinatorial, restricted logistic, and logistic regression (LR) test models. We\nshow that restricted and regression versions of logistic test models are equivalent in a\nway that is reminiscent of DFA and LNOR test models. In section 6.4, we present a\nunified test model that includes the LNOR and the LR test models as special cases.\nIn section 6.5, we present the maximum a posteriori (MAP) inference problem for the\nunified test model, and derive its solution using the Lagrangian relaxation method,\nand then we derive the dual cost function for the MAP problem. In section 6.6, we\npresent the simulation results, where we compare the performance of the LNOR and\nLR test models and also discuss the dual cost function of the MAP inference problem\nfor the unified test model. Finally, in section 6.7, we summarize the chapter.\n\n6.2\n\nEquivalence of Detection-False Alarm (DFA)\nand Leaky Noisy OR (LNOR) Test Models\n\nIn this section, we show the equivalence of two widely-used graphical models in fault\ndiagnosis. In the binary case, the probabilistic relation between a failure source and a\ntest outcome can be represented in terms of detection and false alarm probabilities\n[167], [11]. The detection probability (P dij ) is the probability that test tj has a fail\noutcome, given that the failure source xi is in a failure state; mathematically,\n\nP dij = Pr{tj = 1|xi = 1}.\n146\n\n(6.2.1)\n\nFalse alarm probability (P fij ) is the probability that test tj has a fail outcome, given\nthat the failure source xi is in a non-failure state; mathematically,\n\nP fij = Pr{tj = 1|xi = 0}.\n\n(6.2.2)\n\nFigure 6.2.1: Detection-False Alarm (DFA) test model\n\nFigure 6.2.2: Leaky Noisy OR (LNOR) test model\n\nFigure 6.2.1 shows the Detection-False Alarm (DFA) test model for a system\n147\n\nwith m failure sources and one test tj . In this model, in order for the test tj to pass,\nall failure sources should be in no-failure state. Based on conditional independence\nassumption of test outcomes given the states of failure sources, we can write:\n\nPr{tj = 0|x} =\n\nm\nY\n\n(1 − P fij )1−xi (1 − P dij )xi .\n\n(6.2.3)\n\ni=1\n\nFigure 6.2.2 shows the LNOR test model. In this model, for failure sources\nx1 to xm a value of zero leads to test outcome tj of pass; that is,\n\nPr{tj = 0|xi = 0} = 1.\n\n(6.2.4)\n\nHowever, when xi = 1, the test outcome would be zero with probability θij so that\n\nPr{tj = 0|xi = 1} = θij .\n\n(6.2.5)\n\nThus far, it is called noisy OR. In fact, if θij = 0 for i = 1, 2, ..., m, then it is a logical\nOR for which the output (tj ) is 1, if at least one of the inputs (xi ) is 1. However,\nwhen θij 6= 0, the output (tj ) could be 0 even when one or more inputs (xi ) are 1.\nHence, it is called a noisy OR model. For this model, however, if all inputs are equal\nto 0, the output would be 0. To inject the possibility of the output being 1 even when\nall the inputs are 0, a leaky node is added (shown as x0 ), whose value is always 1.\nThe noisy OR test model with a leaky node is called a leaky noisy OR (LNOR) test\nmodel and the leaky node in fact represents the unmodeled dynamics in the system\n\n148\n\n[130]. For a LNOR test model\n\nPr{tj = 0|x} = θ0j\n\nm\nY\n\nxi\nθij\n.\n\n(6.2.6)\n\ni=1\n\nProposition 6.2.1. For a DFA test model with m failure sources and n tests, and\nwith detection probabilities P dij and false alarm probabilities P fij , there exist a unique\nLNOR test model with the following parameters:\n\nθ0j =\n\nm\nY\n\n(1 − P fij ),\n\n(6.2.7)\n\ni=1\n\nθij =\n\n1 − P dij\n,\n1 − P fij\n\ni = 1, 2, . . . , m.\n\n(6.2.8)\n\nProof. The following relation proves the existence of a unique LNOR test model for\neach DFA test model.\nPr{tj = 0|x} =\n=\n=\n\nm\nQ\n\n(1 − P fij )\n\ni=1\n\u0012\nm\nQ\ni=1\n\nm\nQ\n\n(1 − P fij )1−xi (1 − P dij )xi\ni=1\n\u0010\n\u0011 xi\n\n(1 − P fij )\n\n1−P dij\n1−P fij\n\n\u0013 m \u0010\nQ 1−P dij \u0011xi\ni=1\n\n1−P fij\n\n= θ0j\n\nm\nQ\n\n(6.2.9)\n\nxi\n.\nθij\n\ni=1\n\nRemark 6.2.2. The mapping from the LNOR parameters to the DFA parameters is\nnot unique.\nNote that false alarms occur for two reasons: errors in sensor measurements\nand processing, or unmodeled parameters. The DFA test model views the occurrence\n149\n\nof false alarms from a sensor measurement and processing error perspective, while the\nLNOR test model views them from an unmodeled dynamics perspective. However,\nin both models, once the parameters are learned from the fault injection-test output\nobservations, both sensor measurement processing error and unmodeled parameter\neffects are reflected in the parameters of the respective models.\n\n6.3\n\nLogistic Representation of Test Models\n\nThe problem of fault diagnosis in the binary case can be formulated in the following\nform using the logistic function.\n\nPr(tj = 0|x) =\n\nexp (fj (x))\n,\n1 + exp (fj (x))\n\n(6.3.1)\n\nSince the sum of probabilities of all possible outcomes must add up to 1, it is required\nthat:\n\nPr(tj = 1|x) =\n\n1\n,\n1 + exp (fj (x))\n\n(6.3.2)\n\nBy dividing equations (6.3.1) and (6.3.2), and taking the logarithm, we obtain:\n\u0012\nfj (x) = ln\n\nPr(tj = 0|x)\nPr(tj = 1|x)\n\n150\n\n\u0013\n(6.3.3)\n\n6.3.1\n\nLogistic Combinatorial Test Models\n\nThe simplest way of modeling fj (x) is to assign a weight ωj for each configuration of\nfailure states as1 :\n\nPr(tj = 0|x) =\n\nexp (ωj (xm , . . . , x1 ))\n,\n1 + exp (ωj (xm , . . . , x1 ))\n\n(6.3.4)\n\nThat is\n\nfj (x) = ωj (xm , . . . , x1 )\n\n(6.3.5)\n\nAnother way of constructing a logistic combinatorial model is to use a\npolynomial of degree m for fj (x), as follows:\n\nfj (x) =\n\n1\nX\n\n···\n\nkm =0\n\n6.3.2\n\n1\nX\n\nνkm ···k1 j xkmm · · · xk11\n\n(6.3.6)\n\nk1 =0\n\nRestricted Logistic Test Model\n\nA method to reduce the number of parameters is to assign a weighting to each failure\nsource and restricting its dependency on the state of that failure source; that is,\nexp\n\n\u0012m\nP\n\nPr (tj = 0|x) =\n1 + exp\n\n\u0013\nωij (xi )\n\ni=1\n\u0012m\nP\n\n\u0013\n\n(6.3.7)\n\nωij (xi )\n\ni=1\n\nAs an example, consider two failure sources x1 , x2 and one test tj . The state\n1\n\nIndexing in reverse order is intentional for decimal representation of the configuration states\n\nlater.\n\n151\n\nconfiguration and the corresponding fj (x) are shown in Table 6.3.1.\nTable 6.3.1: Input and fj (x) for two failure sources and a single output\n\nx2\n\nx1\n\nfj (x2 , x1 )\n\n0\n\n0\n\nω2j (0) + ω1j (0)\n\n0\n\n1\n\nω2j (0) + ω1j (1)\n\n1\n\n0\n\nω2j (1) + ω1j (0)\n\n1\n\n1\n\nω2j (1) + ω1j (1)\n\nNote that the logistic test model of (6.3.7) is analogous to the DFA test\nmodel in the sense that in both models a zero state of any of the failure sources affects\nthe probability of tj , via P fij in the DFA test model and via ωij (0) in the logistic test\nmodel.\n\n6.3.3\n\nLogistic Regression Test Model\n\nSimilar to the derivation of LNOR test model from a DFA test model, we can derive\nthe LR test model from (6.3.7). We showed that the LNOR test model can aggregate\nthe effect of the zero-states of the failure sources by introducing a leaky node and\nthat the LNOR test model is equivalent to the DFA test model. This suggests us to\nconsider the effect of ωij (0) for all i = 1, 2, . . . , m into one parameter. To illustrate\nthis point, we consider a system with two failure sources x1 and x2 and one test tj ,\nall binary. For the new logistic test model we neglect the effect of each failure source\nwhen its state is zero. Therefore, corresponding to ω1j (0) and ω2j (0), we do not have\nany parameter in the new test model, but we assign a parameter ξ0j that is applied\nin any combination of the failure states. Therefore, we have the following relations\n152\n\nbetween the ω parameters of model (6.3.7) and the ξ parameters of the new logistic\nmodel.\nω2j (0) + ω1j (0) = ξ0j\nω2j (0) + ω1j (1) = ξ0j + ξ1j\n\n(6.3.8)\n\nω2j (1) + ω1j (0) = ξ0j + ξ2j\nω2j (1) + ω1j (1) = ξ0j + ξ2j + ξ1j\nSolving the above equations for the ξ parameters, yields:\nξ0j = ω2j (0) + ω1j (0)\n(6.3.9)\n\nξ1j = ω1j (1) − ω1j (0)\nξ2j = ω2j (1) − ω2j (0)\n\nRemark 6.3.1. In general, for m failure sources x1 , x2 , . . . , xm and one test tj , all\nbinary, we can write:\nξ0j =\n\nm\nP\n\nωij (0)\n(6.3.10)\n\ni=1\n\nξij = ωij (1) − ωij (0), i = 1, . . . , m\nThe general formulation for pass outcome would be:\n\u0012\n\u0013\nm\nP\nexp ξ0j +\nξij xi\ni=1\n\u0012\n\u0013\nPr (tj = 0|x) =\nm\nP\n1 + exp ξ0j +\nξij xi\n\n(6.3.11)\n\ni=1\n\nRemark 6.3.2. Note that ξ0j is the sum of all ωij (0)’s, analogous to θ0j being the\nmultiplication of all (1 − P fij )’s. This is because ωij (0) is related to the logarithm of\n\n153\n\nthe probability (see (6.3.3)). Also, note the similarity to a logistic neuron [177].\nRemark 6.3.3. Note that ξij is the difference between ωij (1) and ωij (0), analogous\nto θij being the ratio of (1 − P dij ) and (1 − P fij ).\n\n6.4\n\nUnified Representation of Leaky Noisy OR and\nLogistic Regression Test Models\n\nIn this section, we present a unified representation for the LNOR and LR test models.\nBoth models can be represented as follows:\n\nzj (x) = θ0j\n\nm\nY\n\nxi\nθij\n.\n\n(6.4.1)\n\ni=1\n\nwith\n\u0010\n\u0011−d\nzj (x) = Pr (tj = 0|x) 1 − Pr (tj = 0|x)\n\n(6.4.2)\n\nwhere,\n\nd=\n\n\n0\n\n\nLeaky noisy OR\n\n\n1\n\nLogistic regression\n\n(6.4.3)\n\nNote that in the LNOR test model, zj (x) is the probability of test tj being zero given\nx, that is, zj (x) = Pr (tj = 0|x), and in the LR test model, zj (x) is the odds of test\nPr(t =0|x)\n\ntj being zero given x, that is zj (x) = 1−Pr(tj j =0|x) . The parameters θij , i = 0, 1 . . . , m\nfor the LNOR test model are as they were defined in section 2, and for the LR test\n154\n\nmodel, they are as follows:\n\nθ0j = exp (ξ0j )\n\n(6.4.4)\n\nθij = exp (ξij ) , i = 1, . . . , m\n\n(6.4.5)\n\nThe unified representation can be written as follows, as well:\n\nln (zj (x)) = β0j +\n\nm\nX\n\nβij xi\n\n(6.4.6)\n\ni=1\n\nwhere for the LNOR, βij = ln(θij ), and for the LR test model, β0j = ξ0j , and βij = ξij\nfor i = 1, . . . , m.\nRemark 6.4.1. Note that (6.4.6) states that for the LNOR test model, the logarithm\nof probability of test tj being zero is an affine linear function of the failure source\nstates (linearity in probability) while, for the LR the logarithm of the odds of tj being\nzero is an affine linear function of the failure source states (linearity in odds).\nRemark 6.4.2. For the same observed data, the parameters of βij , i = 0, 1 . . . , m\nfor the LNOR test model are different from those of the LR test model.\nRemark 6.4.3. For the LNOR test model, the parameters βij for i = 0, 1, . . . , m are\nnon-positive, because θij for i = 0, 1, . . . , m, being probabilities, are restricted to be in\nthe interval [0, 1].\n\n155\n\n6.5\n\nMaximum A Posteriori (MAP) Inference for\nthe Unified Test Model\n\nIn this section, we present the fault diagnosis problem as the maximum a posterior\n(MAP) inference problem for the unified test model, and derive its solution using the\nLagrangian relaxation method. Then, we derive the dual cost function for this MAP\ninference problem.\nLet x denote the vector of all failure sources, and T be the test outcomes.\nGiven T , the inference problem can be expressed as follows:\n\nx̂ = arg max Pr (x|T ) .\nx\n\n(6.5.1)\n\nThe MAP estimation for the above inference problem can be written as\nfollows:\n\nx̂ = arg max ln (Pr (T |x) Pr (x)) .\nx\n\n(6.5.2)\n\nBy categorizing the observed test outcomes T into two disjoint sets of passed test\noutcomes Tp , and failed test outcomes Tf , we can write the MAP problem (6.5.2),\nafter taking logarithm, as follows:\n\nx̂ = arg max {ln (Pr (Tf |x)) + ln (Pr (Tp |x)) + ln (Pr (x))}\nx\n\n(6.5.3)\n\nAssuming each failure source xi has the prior probability psi of being in the fail state,\n\n156\n\nwe can write:\n\u0012\nPr (xi ) = (1 − psi )\n\nps i\n1 − ps i\n\n\u0013xi\n(6.5.4)\n\nValidity of (6.5.4) can be verified by checking Pr (xi ) for the two possible values xi = 0\nand xi = 1. Using the conditional independence of failure sources, we can write:\n\nPr (x) =\n\nm\nY\n\nPr (xi )\n\n(6.5.5)\n\ni=1\n\nTaking logarithm of (6.5.5), and using (6.5.4), we can write:\n\nln (Pr (x)) = γ0 +\n\nm\nX\n\nγi xi\n\n(6.5.6)\n\ni=1\n\nwhere,\n\nγ0 =\n\nm\nX\n\nln (1 − psi )\n\n(6.5.7)\n\ni=1\n\n\u0012\nγi = ln\n\npsi\n1 − ps i\n\n\u0013\n(6.5.8)\n\nTo calculate ln (Pr (Tp |x)), we start by equation (6.4.6) and (6.4.2), rewritten\nbelow for ready reference:\n\nln (zj (x)) = β0j +\n\nm\nX\ni=1\n\n157\n\nβij xi\n\n(6.5.9)\n\n\u0010\n\u0011−d\nzj (x) = Pr (tj = 0|x) 1 − Pr (tj = 0|x)\n\n(6.5.10)\n\nInserting (6.5.10) into (6.5.9) yields:\nm\nP\n\n\u0010\n\n\u0011\n\nln (Pr (tj = 0|x)) = β0j +\nβij xi\ni=1\n\u0010\n\u0011\n+d ln 1 − Pr (tj = 0|x)\n\n(6.5.11)\n\nSince test outcomes are independent, we can write\n\nPr (Tp |x) =\n\nY\n\nPr (tj = 0|x)\n\n(6.5.12)\n\ntj ∈Tp\n\nTaking logarithm of (6.5.12), and using (6.5.11), we have:\n\nln (Pr (Tp |x)) = β0 +\n\nm\nX\n\nβi xi + d\n\nX\n\nln (1 − yj )\n\n(6.5.13)\n\ntj ∈Tp\n\ni=1\n\nwhere,\n\nβi =\n\nX\n\nβij ,\n\ni = 0, 1, . . . , m\n\n(6.5.14)\n\ntj ∈Tp\n\nyj = Pr(tj = 0|x)\n\n(6.5.15)\n\nTo calculate ln (Pr (Tf |x)), based on independence of test outcomes, we first note that:\n\nPr (Tf |x) =\n\nY\n\nPr (tj = 1|x)\n\ntj ∈Tf\n\n158\n\n(6.5.16)\n\nTaking logarithm of (6.5.16), and noting that probability of a fail outcome is the\ncomplement of probability of the pass outcome, we can write:\n\nln (Pr (Tf |x)) =\n\nX\n\nln (1 − yj )\n\n(6.5.17)\n\ntj ∈Tf\n\nUsing equations (6.5.6), (6.5.13), and (6.5.17), and by discarding constants\nγ0 and β0 , we can write the MAP inference problem (6.5.3) as follows:\n\nx̂ = arg max\nx\n\nX\n\nln (1 − yj ) +\n\ntj ∈Tz\n\nm\nX\n\nα i xi\n\n(6.5.18)\n\nβij xi , ∀tj ∈ Tz\n\n(6.5.19)\n\ni=1\n\nsubject to:\n\nln (yj ) − d ln (1 − yj ) = β0j +\n\nm\nX\ni=1\n\nwhere,\n\nTz =\n\n\nTf\n\n\nLeaky noisy OR\n\n\nT\n\nLogistic regression\n\n(6.5.20)\n\nαi = γi + βi , i = 1, . . . , m\n\n(6.5.21)\n\nNote that, for the LR test model, we have used the relation Tp ∪ Tf = T .\nThe problem in (6.5.18), in the ideal case (θ0j = 1, θij = 0, i = 1, . . . , m)\nfor the LNOR test model, reduces to a set covering problem. Since the set covering\n\n159\n\nproblem is NP-hard [128], the general problem in (6.5.18) is NP-hard as well.\nNote that, while in the second summation in (6.5.18), the effect of the failure\nsources are decoupled, the first summation through yj couples all the failure source\nstates nonlinearly. To relax this coupling, we use Lagrange relaxation method. The\nrelaxed version of optimization problem becomes:\n\nm\nP\nln (1 − yj ) +\nαi xi\ni=1\ntj ∈Tz\n\u0012\n\u0013\nm\nP\nP\n+\nλj ln (yj ) − d ln (1 − yj ) − β0j −\nβij xi\n\nL=\n\nP\n\ntj ∈Tz\n\n(6.5.22)\n\ni=1\n\nBy taking the derivative of (6.5.22) with respect to yj and equating it to zero, we get:\n\nyj =\n\nλj\n, ∀tj ∈ Tz\n1 + (1 − d)λj\n\n(6.5.23)\n\nInserting (6.5.23) into (6.5.22) and rearranging it, we have:\n\nL(λ, x) =\n\nX\n\nL1j (λj ) +\n\ntj ∈Tz\n\nm\nX\n\nci (λ)xi\n\n(6.5.24)\n\ni=1\n\nwhere\n\nci (λ) = αi −\n\nX\ntj ∈Tz\n\n160\n\nλj βij\n\n(6.5.25)\n\nL1j (λj ) = λj ln(λj ) + (1 − dλj ) ln(1 − dλj )\n\n(6.5.26)\n\n− (1 + (1 − d)λj ) ln (1 + (1 − d)λj ) − β0j λj\nNote that given λ, the first summation in (6.5.24) is a constant and can be\ndiscarded, and the optimization in the second summation can be performed for each\nfailure source separately. Therefore,\n\n\nx∗i (λ) = u (ci (λ)) = u  αi −\n\nX\n\nλj βij\n\n(6.5.27)\n\ntj ∈Tz\n\nwhere, u(.) is the unit step function. The pure dual cost function then is as follows:\n\nL(λ) =\n\nX\n\nL1j (λj ) +\n\ntj ∈Tz\n\nm\nX\n\nL2i (λ)\n\n(6.5.28)\n\ni=1\n\nwhere,\n\nL2i (λ) = ci (λ)u (ci (λ)) = max (0, ci (λ))\n\n(6.5.29)\n\nand L1j (λj ) is as in (6.5.26), which can also be written as in (6.5.30) and (6.5.31),\nrespectively, for the LNOR and the LR test models.\nL1j (λj ) = λj ln(λj ) − (1 + λj ) ln(1 + λj ) − β0j λj\n\n(6.5.30)\n\n∀tj ∈ Tf\n\nL1j (λj ) = λj ln(λj ) + (1 − λj ) ln(1 − λj ) − β0j λj\n= −H(λj ) − β0j λj , ∀tj ∈ T\n161\n\n(6.5.31)\n\nwhere, H(λj ) is the binary entropy. Thus, one needs Lagrange multipliers for failed\ntests only in the case of LNOR, while the Lagrange multipliers are need for all tests\nin the case of LR.\n\n6.6\n\nSimulation Results\n\n6.6.1\n\nComparison of the Leaky Noisy OR and Logistic Regression Test Models\n\nIn this section, using an example we compare the LNOR and LR test models. Consider\na system with three failure sources x1 , x2 , and x3 and two tests t1 and t2 . Assume\nthat test t1 is affected by failures source x1 and x2 , and test t2 is affected by failure\nsources x1 and x3 . From a DFA test modeling perspective, the non-zero detection\nand false alarm probabilities are P d11 = 0.85, P d21 = 0.90, P d22 = 0.80, P d32 = 0.95,\nP f11 = 0.06, P f21 = 0.03, P f22 = 0.07, P f32 = 0.08. Using (6.2.7) and (6.2.8), we\ncan calculate the parameters of its equivalent LNOR test model. Then, we can find\nthe least squares estimate of LR test model. Let Pr(tj = 0|x)for these models be,\nrespectively, denoted as POrgLNOR (x) and POrgLR (x), where the subscripts “OrgLNOR”\nand “OrgLR” represent the best estimates for the original DFA test model, respectively\nfor the LNOR and the LR test models. A wighted sum of the test probabilities of\nthese two models is used as the training data.\nPrObs (tj = 0|x) =\n\n(6.6.1)\n\nwLNOR PjOrgLNOR (x) + (1 − wLNOR )PjOrgLR (x)\n\n162\n\nwhere 0 ≤ wLNOR ≤ 1 and j = 1, 2. When wLNOR = 1, the observations have a linear\nstructure in the logarithm of probability of test pass, and when wLNOR = 0 they have\na linear structure in the logarithm of the odds of test pass, and when 0 < wLNOR < 1\nthe observations have neither linear structure in the logarithm of probability of test\npass, nor in the logarithm of the odds of test pass.\nWe use PrObs (tj = 0|x), j = 1, 2 to train the LNOR and the LR test models.\nThe results for probability of test pass given for two models and the training data\nare shown in Fig. 6.6.1 and Fig. 6.6.2, respectively for t1 and t2 . Note that as\nPr(t1 = 0|x = 1x2 x1 ) = Pr(t1 = 0|x = 0x2 x1 ) and Pr(t2 = 0|x = x3 x2 1) = Pr(t2 =\n0|x = x3 x2 0), for each test only the combinations of the two contributing failure\nsources are shown. It is seen that for the extreme values of wLNOR = 0 and wLNOR = 1,\nas we expect, respectively, the LR and the LNOR test models have perfect performance.\nAs wLNOR becomes less than 1 the performance of the LNOR test model degrades\nand, especially, for Pr(t1 = 0|x2 x1 = 00) and Pr(t2 = 0|x3 x2 = 00), the LNOR\ntest model has poor performance for low values of wLNOR . The LR test model,\nhowever, provides robust performance as the structure of observed data varies from a\nlog-probability-linearity to log-odds-linearity.\n\n163\n\nblue: training data, red: leaky noisy OR, magenta: logistic regression\n1\n\n0.24\n0.22\n\n0.95\n0.2\n0.18\n0.9\n0.16\n0.85\n\n0.14\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\nwLNOR\n0.16\n\n0.016\n\n0.14\n\n0.014\n\n0.12\n\n0.012\n\n0.1\n\n0.01\n\n0.08\n\n0.008\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.5\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\nw LNOR\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\nwLNOR\n\n0.5\n\nw LNOR\n\nFigure 6.6.1: Comparison of probability of t1 is passed given x for the LNOR and the LR\ntest models\n\nblue: training data, red: leaky noisy OR, magenta: logistic regression\n1\n\n0.26\n\n0.95\n\n0.24\n\n0.9\n0.22\n0.85\n0.2\n\n0.8\n0.75\n\n0.18\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\nw\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\nw\n\nLNOR\n\n0.075\n\n0.7\n\n0.8\n\n0.9\n\n1\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\n10 -3\n\n11\n\n0.07\n\n0.6\n\nLNOR\n\n10\n\n0.065\n9\n0.06\n8\n0.055\n7\n\n0.05\n0.045\n\n6\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\n0\n\nw LNOR\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\nwLNOR\n\nFigure 6.6.2: Comparison of probability of t2 is passed given x for the LNOR and the LR\ntest models\n\nFigures 6.6.3 and 6.6.4 show Pr(t2 t1 = 11|x) Pr(x) for all eight combinations\n164\n\nof failure sources, for ps1 = 0.15, ps2 = 0.10, and ps3 = 0.05. It is seen that while\nthe LR test model provides robust results, the LNOR test model results are off for\nlow values of wLNOR and for three combinations x3 x2 x1 = 000, x3 x2 x1 = 001, and\nx3 x2 x1 = 100. The reason is that, for x3 x2 x1 = 100, both inputs of test t1 are zero,\nwhile for x3 x2 x1 = 001, both inputs of test t2 are zero, and for x3 x2 x1 = 000, inputs\nof both tests t1 and t2 are zero, and we saw in Figures 6.6.1 and 6.6.2 that, the\nLNOR test model poorly estimates Pr(tj |00) when wLNOR is low. In reality, as the\nnumber of failure sources become large and since tests are connected to some of them\nonly, in many combinations of the failure sources, one or more tests are subjected\nto all-zero inputs, and hence in those combinations, the error would be large when\nwLNOR is low. Figure 6.6.4 also shows that when both tests fail for any value of wLNOR ,\nPr(t2 t1 = 11|x Pr(x)) has its highest value at x = 010 and both test models provide\nthe same inference.\n\nblue: training data, red: leaky noisy OR, magenta: logistic regression\nx3 x2 x 1 =000\n\nx 3 x2 x1 =001\n\n0.02\n\n0.02\n\n0.005\n\n0.005\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\n0\n\n0.2\n\n0.4\n\nwLNOR\n\n0.6\n\n0.8\n\n1\n\n0.8\n\n1\n\n0.8\n\n1\n\n0.8\n\n1\n\nw LNOR\n\nx3 x2 x 1 =010\n\nx 3 x2 x1 =011\n\n0.058\n\n0.011\n0.0105\n\n0.052\n0\n\n0.2\n\nw\n\n0.6\n\n0.8\n\n1\n\n0\n\n0.2\n\n0.4\n\nLNOR\n\n0.6\nw LNOR\n\nx3 x2 x 1 =100\n\n10-3\n\n5\n\n0.4\n\nx 3 x2 x1 =101\n\n10-3\n5.4\n5\n\n1\n0\n\n0.2\n\n0.4\n\n0.6\nw\n\n1\n\n0\n\n0.2\n\n0.4\n\n0.6\nw\n\nLNOR\n\nx3 x2 x 1 =110\n\n10-3\n\n3.8\n\n0.8\n\n3.6\n\nx 3 x2 x1 =111\n\n10-4\n\n7.38\n\nLNOR\n\n7.32\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\n0\n\nwLNOR\n\n0.2\n\n0.4\n\n0.6\n\nwLNOR\n\nFigure 6.6.3: Comparison of Pr(T = 11|x) Pr(x) for the LNOR and the LR test models\n\n165\n\n0.06\noriginal data\nlogistic regression estimation\nleaky noisy OR estimation\n\n0.05\n\n0.04\n\n0.03\n\n0.02\n\n0.01\n\n0\n0\n\n1\n\n2\n\n3\n4\nx= digital representation of (x3x2x1)\n\n5\n\n6\n\n7\n\nFigure 6.6.4: Comparison of Pr(T = 11|x) Pr(x) for the LNOR and the LR test models\n\n6.6.2\n\nDual Cost Function and the MAP Estimate\n\nFigures 6.6.5 and 6.6.6, respectively, show the dual cost function, i.e., equation (6.5.28),\nfor the LNOR and the LR test models. For the training of these models, we used\nwLNOR = 0.5. Due to nonlinearities in (6.5.29), that is, L2i (λ) = ci (λ)u (ci (λ)), both\ndual cost functions have sharp corners making them non-differentiable. Note that for\nthe LR test model, based on (6.5.23), we have λj = yj , and since yj , as defined in\n(6.5.15), is a probability, the dual cost function for λj > 1 is undefined. However, for\ny\n\nthe LNOR test model based on (6.5.23), we have λj = 1−yj j , which is an odds function,\nand thus can take any nonnegative value.\n\n166\n\n3\n2\n1\n0\n-1\n-2\n-3\n1.5\n1.5\n\n1\n1\n0.5\n\n0.5\n0\n\n0\n\n2\n\n1\n\nFigure 6.6.5: Dual cost function for the LNOR test model\n\n2\n1\n0\n-1\n-2\n-3\n1\n0.8\n\n1\n0.6\n\n0.8\n0.6\n\n0.4\n0.4\n\n0.2\n\n0.2\n0\n\n0\n\n2\n\n1\n\nFigure 6.6.6: Dual cost function for the LR test model\n\nThe minimum value of the dual cost function for the LNOR test model occurs\n167\n\nat (λ∗1 , λ∗2 ) = (0.444, 0.716), and that for the LR occurs at (λ∗1 , λ∗2 ) = (0.343, 0.418).\nThese result in c1 (λ∗ ) and c3 (λ∗ ) to be negative for both models, which means, based\non (6.5.27), that x∗1 = 0 and x∗2 = 0. The value of c2 (λ∗ ) for both models is close\nto zero. When ci (λ∗ ) = 0, as the contribution of ci (λ∗ ) u (ci (λ∗ )) to the dual cost\nfunction is zero, irrespective of assigning 1 or 0 to u (ci (λ∗ )), decision based on (6.5.27)\nwill be ambiguous. Therefore, for ci (λ∗ ) close to zero, we should either check the\nprimal cost function or use the set-covering ideas. As discussed in [11] for the DFA test\nmodel, in practice, there are not many such cases. In the above example, comparing\nthe primal cost function at x3 x2 x1 = 000 and x3 x2 x1 = 010 gives the optimal solution\nas x∗3 x∗2 x∗1 = 010.\n\n6.7\n\nSummary\n\nIn this chapter, we discussed two test models, viz., DFA (Detection False Alarm) and\nleaky noisy OR (LNOR); we proved the equivalence of these models in a proposition\nand showed that the parameters of the LNOR test model can be uniquely determined\nvia the parameters of the DFA test model. The reverse mapping, however, is not\nunique. The false alarms are viewed as errors in sensor measurements and processing in\nthe DFA test model, and as unmodeled parameters in the LNOR test model. However,\nin both models, once the parameters are obtained via the fault injection-test output\nobservations, both sensor measurement errors and unmodeled parameter effects are\nreflected in the respective parameters of the models. In logistic test modeling, we\npresented two realization of the combinatorial case, one by assigning a weight to each\nfailure combination and the other using a polynomial of degree m. Then, we showed a\n\n168\n\nmore tractable model by restricting the weights on the possible states of each failure\nsource, rather than the combination of all failure states. This resulted in a logistic test\nmodel similar to the DFA test model in structure, in the sense that a zero state of any\nof the failure sources affects the probability of test outcomes in both models. Using the\nsame approach that we used for showing the equivalence of the DFA and the LNOR\ntest models, we showed the equivalence of the restrictive test model and the logistic\nregression (LR) test model. Then, we devised a unified test model that encompasses\nboth the LNOR and the LR test models. We presented the fault diagnosis problem as\nthe maximum a posterior (MAP) inference problem for the unified test model, and\nderived its solution using a Lagrangian relaxation method. Finally, we derived the\ndual cost function for this unified MAP inference problem. Using an example, we\ndiscussed the dual cost function. Simulation results show that the LR test model is\nmore robust with respect to the structure of the training data than the LNOR test\nmodel.\n\n169\n\nChapter 7\nConclusion and Future Work\nIn this thesis, we discussed two problem, namely, (a) optimal battery charging and\nbattery life management; (b) fault diagnosis using probabilistic graphical models. We\napplied optimization techniques to the first problem and Bayesian inference to the\nsecond one.\nIn optimal battery charging and battery life management, we tackled the\nproblem in a two-time-scale algorithm which performs fast-charging at the lower-level\n(fast time-scale), while managing the battery life cycle at the higher-level (low timescale). In the lower-level, we derived optimal charging algorithms for Li-ion batteries\nusing equivalent electrical circuit models and quadratic optimization approaches.\nThe objective function is considered as linear combination of time-to-charge (TTC),\nenergy-loss (EL), temperature rise index (TRI), and any other arbitrary function of\nstate-of-charge.\nIn the lower-level problem, with a simple battery model composed of an\nOpen-Circuit Voltage (OCV) and a resistance, the optimal solution with objective\n170\n\nfunction being a weighted sum of TTC and EL, the solution (referred to as OtE\n(Optimal-time-Energy)) was proved to be the well-known CC-CV strategy with the\nvalue of current in the CC stage being a function of the ratio of weighting on TTC\nand EL and also the resistance of battery. To the best of our knowledge, this is the\nfirst time that it is proved that the well-known CC-CV charging profile is the optimal\nsolution of a particular optimization problem, namely, the problem of minimizing the\nweighted sum of time-to-charge and energy loss.\nIn addition, we developed an analytical solution for the optimal TTC, EL\nand TRI, referred to as OtET, was developed. Due to similarity of the structure of\nthe OtE and OtET solutions, a near-optimal version of OtET (referred to as NOtET).\nThe NOtET is a CC-CV strategy with the value of current in the CC stage being a\nfunction of the ratio of weighting on TTC and EL, the resistance of the battery and\nthe effective thermal resistance. Then, we presented a linear quadratic optimization\napproach and its solution to optimally charging a Li-ion battery in a general form.\nThe optimal profile was derived based on a cost function, which is a weighted sum\nof time-to-charge (TTC), energy loss (EL), sum of the squares of the differences of\nthe state-of-charge (SOC) from the final desired SOC, and temperature rise index\n(TRI). The presented solution strategy is generic and it is applicable to any equivalent\nelectrical circuit model of a battery. A number of simulations were conducted to\nevaluate the effect of weighting parameters. Finally, extensive results on industrial\nbatteries from LG, Nokia and Samsung were presented.\nAt the higher-level, we proposed a battery life management algorithm to\ndetermine the optimal values for the control parameters of charging process, namely,\nmaximum allowable current and maximum allowable terminal voltage. As a precursor\nto the battery life management algorithm, we proposed two new battery capacity fade\n171\n\nmodels that are shown to be statistically superior to the bi-exponential capacity fade\nmodel.\nThe two models for estimating the normalized battery capacity are called\nthe LAR-αβγ and the CVD. The former is a function of the number of cycles and\nthe latter is a function of the number of cycles and two charge control parameters,\nviz., maximum terminal voltage of the battery (vmax ) and maximum charge current\n(imax ). The accuracies of these models were explored by experimental data gathered\nfrom aging experiments performed on Samsung GS4 battery, and their dominance\nover the bi-exponential capacity model was demonstrated using the experimental\ndata. The statistical dominance of LAR-αβγ over LS-BE was performed using Akaike\nInformation Criterion (AIC). Using the CVD model, we also analyzed the effect of\nvoltage and current on the capacity curves and we showed that vmax , rather than imax ,\nhas a salient effect on capacity fade.\nThe proposed battery life management algorithm finds the best vmax and\nimax to achieve a desired cycle life (for example, 500 cycles), while maintaining the\nnormalized capacity above a desired threshold (for example, 80%) and attaining the\nfastest possible time-to-charge. The method was illustrated via numerical results. The\noptimal setpoint depends on the desired state of charge (denoted by sth ) for which\nwe aim to attain the fastest charging time. It also depends on the resistance of the\nbattery, i.e., R0 . Simulation results show that low fast-charging threshold on state of\ncharge (sth ) and low battery resistance result in an optimal setpoint with the highest\nimax among the set of feasible control settings, while increasing sth and the battery\nresistance result in moving the optimal setpoint to lower values of imax and higher\nvalues of vmax . From the discussion of the different scenarios, we concluded that imax ,\nrather than vmax , has a salient effect on power fade, and vmax , rather than imax , has a\n172\n\nsalient effect on capacity fade.\nIn the second part of the thesis, for fault diagnosis, we considered the fault\ndiagnosis problem using probabilistic graphical models. We discussed the DetectionFalse Alarm (DFA), the Leaky Noisy OR (LNOR), and the logistic regression (LR)based test models. First, we proved the equivalence of DFA and LNOR test models.\nThen, we proposed a unified test model that includes both the LNOR and the LR\ntest models as specific cases, and derived a Maximum a posteriori solution for the\nmultiple fault diagnosis problem using the unified test model with the Lagrangian\nrelaxation method, by deriving a dual cost function for the problem.\nWe discussed the problem of fault diagnosis in complex systems using\nknowledge-based probabilistic graphical models in two different contexts: static and\ndynamic. The fault diagnosis problem is represented using a tri-partite probabilistic\ngraphical model. The first layer of this tri-partite graph is composed of components of\nthe system, which are the potential sources of failures. The healthy or faulty condition\nof each component is represented by a binary state variable which is zero if the component is healthy and one otherwise. The second layer is composed of tests with binary\noutcomes (pass or fail) and the third layer is the noisy observations associated with\nthe test outcomes. The cause-effect relations between the states of the components\nand the test outcomes can be compactly modeled in terms of detection and false alarm\nprobabilities. When the probability of fault detection is one and the probability of\nfalse alarm is zero, the test is termed perfect; otherwise it is deemed imperfect. In the\ncase of perfect tests, the static multiple fault diagnosis (SMFD) problem reduces to a\nset-covering problem, which itself is an NP-hard problem. We discussed the SMFD\nproblem in its general form by maximizing the posterior probability of component\nstates given the fail or pass outcomes of tests. Since the solution to this problem\n173\n\nis known to be NP-hard, we used a Lagrangian (dual) relaxation technique to find\nnear-optimal diagnostic solutions, which has the desirable property of providing a\nmeasure of sub-optimality in terms of the approximate duality gap. Indeed, the\nsolution would be optimal if the approximate duality gap is zero. The static problem\nis discussed in detail and a dual cost function is derived. By presenting some graphical\nillustrations, we provided insights into the properties of the non-differentiable dual\nfunction.\nWe also discussed the multiple fault diagnosis in a dynamic context (DMFD),\nwhere it is assumed that the states of components evolve as independent Markov\nchains and that, at each time epoch, we have access to some of the test outcomes.\nFinally, we discussed the fault diagnosis problem in the context of active probing\n(also termed sequential testing or troubleshooting), where information is sequentially\nacquired to isolate the faults in minimum time, cost or other economic factors, and\nwe briefly mentioned some of the applications of fault diagnosis.\nWe discussed two widely-used graphical models, viz., DFA (Detection False\nAlarm) and leaky noisy OR (LNOR) test models; we proved the equivalence of these\nmodels in a proposition and showed that the parameters of the LNOR test model\ncan be uniquely determined via the parameters of the DFA test model. The reverse\nmapping, however, is not unique. The false alarms are viewed as errors in sensor\nmeasurements and processing in the DFA test model, and as unmodeled parameters\nin the LNOR test model. However, in both models, once the parameters are obtained\nvia the fault injection-test output observations, both sensor measurement errors and\nunmodeled parameter effects are reflected in the respective parameters of the models.\nIn logistic test modeling, we presented two realization of the combinatorial case, one\nby assigning a weight to each failure combination and the other using a polynomial of\n174\n\ndegree m. Then, we showed a more tractable model by restricting the weights on the\npossible states of each failure source, rather than the combination of all failure states.\nThis resulted in a logistic test model similar to the DFA test model in structure, in\nthe sense that a zero state of any of the failure sources affects the probability of test\noutcomes in both models. Using the same approach that we used for showing the\nequivalence of the DFA and the LNOR test models, we showed the equivalence of\nthe restrictive model and the logistic regression (LR) test model. Then, we devised a\nunified test model that includes both the LNOR and the LR test models as special\ncases. We presented the fault diagnosis problem as the maximum a posterior (MAP)\ninference problem for the unified test model, and derived its solution using a Lagrangian\nrelaxation method. Finally, we derived the dual cost function for this unified MAP\ninference problem. Using an example, we discussed the dual cost function. Simulation\nresults show that the LR model is more robust with respect to the structure of the\ntraining data than the LNOR test model.\nThe primary contributions of this thesis are:\n1. Derived a closed form solution for optimal battery charging profile to minimize\na weighted sum of time-to-charge and energy loss;\n2. Proved that for an OCV-Resistance battery model, CC-CV is the optimal\nsolution with respect to an objective function, composed of linear combination\nof time-to-charge and energy-loss.\n3. Derived a semi-closed form solution for optimal battery charging profile by\nadding the temperature rise index to the cost function;\n4. Showed that the effect of temperature rise can be approximated as an equivalent\n175\n\nheating resistance;\n5. Derived the optimal battery charging profile for general equivalent electrical\ncircuit models as a linear quadratic - constant voltage (LQ-CV) strategy;\n6. Derived two new battery capacity fade models that are shown to be statistically\nsuperior to the bi-exponential capacity fade model.\n7. Developed an optimal charging parameter selection method for selecting the\nbest settings for the control variables to achieve a desired “useful cycle life”,\nwhile attaining the fastest possible time-to-charge;\n8. Proved the equivalence of the Detection-False Alarm (DFA) and the Leaky Noisy\nOR (LNOR) test models;\n9. Proposed a unified test model to include both the LNOR and the logistic\nregression (LR) test models;\n10. Solved the maximum a posteriori (MAP) inference problem associated with the\nunified test model;\n11. Derived a dual cost function for fault diagnosis problem both with the DFA test\nmodel and with the unified test model\n12. Developed an algorithm for fault prognosis in systems using the unified test\nmodel.\nThe broader impacts of this thesis are:\n1. Minimizing the life cycle cost of systems;\n\n176\n\n2. Enhancing the safety and reliability of systems;\n3. Improving customer satisfaction through enhanced system availability;\n4. The proposed research has utility in different application areas. Representative\napplications include automotive systems, aerospace systems, electrification of\ntransportation, medical equipment, smart buildings/smart grid, and communication networks, to name a few.\nThe future work on battery management system, can include SOC-dependent\nand temperature-dependent parameters in the optimal battery charging. In the present\nwork, the electrical parameters (e.g. R0 , R1 , C1 and so on) are considered constant;\nwhile in reality they depend on SOC and temperature.\nThe above research can be done in two perspectives: (a) using look-up\ntables for parameters (b) using analytic equations for parameters. In the former, a\ngeneral numerical method can be used. However, it has the benefit of being general\nfor any chemistry, because for each chemistry, one can find the corresponding lookup tables using experiments, and then use the look-up-table-based devised method.\nAnother advantage is that look-up tables are more favorable in industry; therefore,\nsuch a method would have more practical potential. The latter has the advantage of\nusing analytic methods, but for any new chemistry one has to find proper analytical\napproximations for the parameters and different chemistries may result in different\nanalytical formulae for electrical parameters and this makes the developed method\nlimited. Also analytical formulae for parameters are less favorable than the look-uptable-based method in industry.\nFor modeling battery capacity, a future work could include not only modeling\nthe cycle life of a battery but also modeling its calendar life, because battery capacity\n177\n\nnot only fades with the way it is charged and discharged, but also it fades just by\npassing time even when the battery is not used. The study of interaction of battery\ncycle-life and battery calendar-life could be a challenging and interesting topic. For\nexample, how a stand-still calendar-life affects the cycle-life behavior of a battery.\nThis interaction, however, has practical importance in the initial calendar-life of a\nbattery, because once a battery is bought by a user, normally it is not exposed to a\nlong stand-still condition.\nAnother topic for future work could be analysis of efficiency degradation.\nWhile the efficiency of a battery mostly considered as one, in reality we get less energy\nfrom a battery during discharge process than what we put into the battery during a\ncharge process. How this charging efficiency changes over the cycle life and calendar\nlife of a battery could be interesting.\nAnother research track with practical outcomes is to use the typical usage of\nusers that have somehow predictable loads, for example electric buses that undergo a\ntypical load profile every week, and then using this data and the interaction of vmax\nand imax with capacity fade and power fade, to determine a default charging profile\nthat considers capacity fade and power fade in the whole useful life of the battery.\nThis charging profile can be used as an initialization for a condition-based charging\nprocess.\n\n178\n\nAppendices\n\n179\n\nAppendix A\nOCV and electrical parameters for\ncommercial batteries\nThe following tables show the parameters of the equivalent electrical circuit model III\nfor different commercial batteries.\nTable A.0.1: Electrical parameters of model III for commercial batteries\nMake\n\nModel\n\nSamsung\nSamsung\nSamsung\nSamsung\nSamsung\nSamsung\nSamsung\nSamsung\nSamsung\nSamsung\nNokia\nNokia\nNokia\nNokia\nLG\nLG\n\nEB575152\nEB575152\nEB575152\nEB575152\nEB504465\nEB504465\nEB504465\nEB504465\nAB463651\nAB463651\nBP-4L\nBP-4L\nBP-4L\nBP-4L\nLGIP\nLGIP\n\nCell# R0 (mΩ) R1 (mΩ) C1 (F)\n1\n2\n3\n4\n1\n2\n3\n4\n1\n2\n1\n2\n3\n4\n1\n2\n\n253\n209\n418\n200\n259\n268\n272\n287\n451\n294\n263\n264\n258\n228\n264\n297\n\n180\n\n106\n94\n58\n142\n106\n168\n211\n224\n198\n214\n100\n64\n95\n50\n101\n76\n\n4581\n5203\n6222\n3046\n4598\n2493\n1680\n1589\n2100\n1950\n5031\n8141\n5306\n10502\n4747\n6654\n\nα\n\nCbatt (Ah)\n\n0.997934\n0.997962\n0.99724\n0.997689\n0.997941\n0.997615\n0.997186\n0.997189\n0.997597\n0.997602\n0.998012\n0.99808\n0.998028\n0.998106\n0.997919\n0.998021\n\n1.1875\n1.2187\n1.2001\n1.485\n1.5001\n1.5293\n1.5261\n1.4831\n0.9791\n0.9614\n1.5514\n1.5691\n1.5612\n1.613\n1.1141\n1.1121\n\nTable A.0.2: OCV parameters for commercial batteries\nMake\n\nModel\n\nCell #\n\nSamsung\nSamsung\nSamsung\nSamsung\nSamsung\nSamsung\nSamsung\nSamsung\nSamsung\nSamsung\nNokia\nNokia\nNokia\nNokia\nLG\nLG\n\nEB575152\nEB575152\nEB575152\nEB575152\nEB504465\nEB504465\nEB504465\nEB504465\nAB463651\nAB463651\nBP-4L\nBP-4L\nBP-4L\nBP-4L\nLGIP\nLGIP\n\n1\n2\n3\n4\n1\n2\n3\n4\n1\n2\n1\n2\n3\n4\n1\n2\n\nK0\n\nK1\n\nK2\n\n-1.1288\n-1.6976\n-1.0802\n-4.3113\n0.0218\n1.8254\n0.2510\n2.9648\n-1.6972\n-1.2526\n-3.2203\n-2.7537\n-3.2084\n-2.7140\n0.5267\n0.4788\n\n65.0931\n68.3306\n68.3600\n22.9007\n54.9000\n61.0951\n55.0370\n59.8808\n41.8528\n40.3216\n51.9246\n52.9707\n51.8554\n60.3626\n61.5448\n59.0975\n\n-10.5332\n-11.1189\n-11.0617\n-4.2921\n-9.1299\n-10.0031\n-9.1256\n-9.7283\n-7.0700\n-6.7711\n-8.8187\n-8.9327\n-8.7993\n-10.0810\n-10.1553\n-9.7677\n\n181\n\nOCV Parameters\nK3\nK4\n1.0640\n1.1290\n1.1178\n0.4926\n0.9668\n1.0470\n0.9634\n1.0127\n0.7522\n0.7166\n0.9344\n0.9407\n0.9314\n1.0533\n1.0682\n1.0290\n\n-0.0457\n-0.0487\n-0.0480\n-0.0239\n-0.0442\n-0.0474\n-0.0439\n-0.0457\n-0.0343\n-0.0326\n-0.0421\n-0.0422\n-0.0419\n-0.0469\n-0.0485\n-0.0468\n\nK5\n\nK6\n\nK7\n\n-52.2654\n-54.5366\n-55.3010\n-10.3460\n-44.6447\n-52.6013\n-45.0942\n-52.9562\n-30.6508\n-29.7536\n-38.1050\n-39.6357\n-38.0572\n-46.2542\n-51.2165\n-48.9737\n\n94.1916\n98.4237\n99.0817\n27.2251\n78.9622\n89.7801\n79.3945\n88.9546\n58.1983\n56.3932\n71.7162\n73.7620\n71.6483\n85.0092\n89.3849\n85.6643\n\n-0.7417\n-0.7882\n-0.8059\n0.0226\n-0.7934\n-1.0640\n-0.8297\n-1.1311\n-0.4098\n-0.3814\n-0.5991\n-0.6418\n-0.5996\n-0.7139\n-0.9091\n-0.8748\n\nAppendix B\nTemperature Modeling for\nOCV-Resistance Model\nReferences [146] and [198] describe the temperature model as a linear system with\ntwo states. By discretizing the formulation in [146] and performing mathematical\nsimplifications, we obtain a linear temperature model for a battery. The power\ngenerated at time t can be written as\n\nQg (t) = R0 i2 (t)\n\n(B.0.1)\n\nQg [k] = R0 i2 [k]\n\n(B.0.2)\n\nwhose discrete form is\n\n182\n\nThe relation of core temperature and air temperature is as follows\n\nQp (t) =\n\nT (t) − Tair (t)\nRef f\n\n(B.0.3)\n\nQp [k] =\n\nT [k] − Tair [k]\nRef f\n\n(B.0.4)\n\nor in discrete form :\n\nwhere Ref f is the effective thermal resistance and is assumed constant [146]\nbut varying in [198]. Also, from [146], we have\n\nTair (t) = Tamb +\n\n0.5Qp (t)\nṁair Cair\n\n(B.0.5)\n\n0.5Qp [k]\nṁair Cair\n\n(B.0.6)\n\nor in discrete form:\n\nTair [k] = Tamb +\n\nBased on [146], the formula for T (t) is\n\nZt\nT (t) =\n\nQg (t) − Qp (t)\ndt\nmbat Cbat\n\n0\n\n183\n\n(B.0.7)\n\nWe can write it in the discrete form as:\n\nT [k + 1] = T [k] +\n\nQg [k] − Qp [k]\n∆\nmbat Cbat\n\n(B.0.8)\n\nWe rewrite the required four formulas again:\n\nQg [k] − Qp [k]\n∆\nmbat Cbat\n0.5Qp [k]\nTair [k + 1] = Tamb +\nṁair Cair\n\nT [k + 1] = T [k] +\n\nQg [k] = R0 i2 [k]\nQp [k] =\n\nT [k] − Tair [k]\nRef f\n\n(B.0.9)\n(B.0.10)\n(B.0.11)\n(B.0.12)\n\nNow we can write:\n\nQg [k] − Qp [k]\n∆\nmbat Cbat\n\u0012\n\u0013\n∆\nT [k] − Tair [k]\n2\n= T [k] +\nR0 i [k] −\n(B.0.13)\nmbat Cbat\nRef f\n\u0012\n\u0013\n∆\n∆\nR0 ∆ 2\n= 1−\nT [k] +\nTair [k] +\ni [k]\nmbat Cbat Ref f\nmbat Cbat Ref f\nmbat Cbat\n\nT [k + 1] = T [k] +\n\nor\n\nT [k + 1] = (1 − a)T [k] + aTair [k] + bi2 [k]\n\n184\n\n(B.0.14)\n\na=\n\n∆\nmbat Cbat Ref f\n\n(B.0.15)\n\nR0 ∆\nmbat Cbat\n\n(B.0.16)\n\nb=\n\n0.5Qp [k]\nṁair Cair\n\u0012\n\u0013\n0.5\nT [k] − Tair [k]\n= Tamb +\nṁair Cair\nRef f\n0.5\n0.5\n=\nT [k] −\nTair (k) + Tamb\nṁair Cair Ref f\nṁair Cair Ref f\n\nTair [k + 1] = Tamb +\n\n(B.0.17)\n\nor\n\nTair [k + 1] = cT [k] − cTair [k] + Tamb\n\nc=\n\n0.5\nṁair Cair Ref f\n\n(B.0.18)\n\n(B.0.19)\n\nPutting (B.0.14) to (B.0.19) together, we can write the temperature equation\nin state variable form:\n\n\nT [k + 1]    1 − a a     T [k]     b   2\n0\n\n=\n\n+     i [k] +     Tamb\nTair [k + 1]\nc\n−c\nTair [k]\n0\n1\n\n185\n\n(B.0.20)\n\na=\n\n∆\nmbat Cair Ref f\n\n(B.0.21)\n\nR0 ∆\nmbat Cbat\n\n(B.0.22)\n\n0.5\nṁair Cair Ref f\n\n(B.0.23)\n\nb=\n\nc=\n\nThe block diagram of the temperature model is shown in Fig. B.0.1\n\nFigure B.0.1: Block diagram of temperature modeling\n\nNote that Tair [k] deviates from the ambient temperature by a negligible\namount and therefore we can assume Tair [k] ' Tamb . Hence, we can write (B.0.14) as\n\n186\n\nT [k + 1] = T [k] − a(T [k] − Tamb ) + bi2 [k]\n\n(B.0.24)\n\nActually, as we will see in the following, equation (B.0.24) is the linear part\nof heat transfer equation.\nNow let us discuss temperature modeling based on heat transfer equation.\nReferences [134] and [147] discuss nonlinear temperature model based on the heat\ntransfer equation. The heat transfer equation is as follows:\n\nq − hb Abs (Tbs − Tf ) − σεFbf (Tbs4 − Tf4 ) = Mb Cb\n\ndTba\ndt\n\n(B.0.25)\n\nAssuming Tbs = Tba = Tcore , Tf = Tamb , q = R0 i2 and discretizing (B.0.25)\nyields\n\n4\n4\nTcore [k + 1] = Tcore [k] − a(Tcore [k] − Tamb ) − e(Tcore\n[k] − Tamb\n) + bi2 [k] (B.0.26)\n\na=\n\nhb Abs ∆\nMb Cb\n\n(B.0.27)\n\nb=\n\nR0 ∆\nMb Cb\n\n(B.0.28)\n\n187\n\ne=\n\nσεFbf ∆\nMb Cb\n\n(B.0.29)\n\n1\nNote that based on [146], Ref f = hb A\n. Therefore, the a coefficient in (B.0.27)\nbs\n\nis exactly the same as the a coefficient in (B.0.21) in the previous section. Actually, if\n4\n4\nwe neglect the (Tcore\n[k] − Tamb\n) part of (B.0.26), then (B.0.26) reduces to (B.0.24) in\n\nthe previous section. Also, note that in equation (B.0.26) the temperature should be\nin Kelvin. Let for notational simplicity from now on call Tcore as T . Therefore, we\nwrite (B.0.26) as:\n\n4\nT [k + 1] = T [k] − a(T [k] − Tamb ) − e(T 4 [k] − Tamb\n) + di2 [k]\n\n(B.0.30)\n\n4\nNeglecting the nonlinear part of states, i.e., (T 4 [k] − Tamb\n), we have\n\nT [k + 1] = T [k] − a(T [k] − Tamb ) + bi2 [k]\n\n188\n\n(B.0.31)\n\nAppendix C\nDerivation of the LQ-CV algorithm\n\nC.1\n\nConcise Version\n\nIn this appendix, we derive the LQ-CV algorithm stated in section 2.4. This is a\nconcise version of “Appendix C.2”. We assumed that at time k1 , the SOC reaches the\nvalue vc . Therefore, we can relax the constraint s[k1 ] = s1 with Lagrangian multiplier\nν. Also, the dynamics of the system are relaxed by co-state vector λ. Hence, the LQ\nproblem is to minimize the following Lagrangian:\n\nL[k] = JtEsT + ν(s[k1 ] − s1 ) +\n\nkX\n1 −1\n\nλT [k + 1] (Φz[k] + Γi[k] − z[k + 1])\n\n\u0001\n\n(C.1.1)\n\nk=0\n\nBy inserting (2.4.33) into (C.1.1), and using Hamiltonian function H[k] and\n\n189\n\n\u0014\n\n\u0015\n\nnoting that ν 0 z[k1 ] = ν(s[k1 ] − skf ), we can write L[k] as in (C.1.2)\n\u0013\nkP\n1 −1\n\u0001\nH[k] − λT [k]z[k] (C.1.2)\nν 0 − λ [k1 ] z[k1 ] + H[0] +\n\n\u0012\u0014\nL[k] = ν(skf − s1 ) +\n\n\u0015\n\nT\n\nk=1\n\nApplying the necessary conditions for optimality results in:\nΓT\nλ[k + 1]\n2∆R0eq [k]\n\n(C.1.3)\n\n∂H[k]\n= 2Q̃[k]z[k] + ΦT λ[k + 1]\n∂z[k]\n\n(C.1.4)\n\ni[k] = −\n\nλ[k] =\n\nFrom (2.4.24), (C.1.3) and (C.1.4), we can write the dynamics of z[k] and\nλ[k] in the following forward/backward form:\n\n\n−Ψ[k]    z[k]\nz[k + 1]    Φ\n\n\n=\n\nλ[k]\n2Q̃[k]\nΦT\nλ[k + 1]\n\n\n(C.1.5)\n\nwhere\n\nΨ[k] =\n\nΓΓT\n2∆R0eq [k]\n\n(C.1.6)\n\nIn order to obtain the optimal current profile, we first consider the following\nevolutions:\n\nλ[k] = P [k]z[k] + g[k]ν\n\n190\n\n(C.1.7)\n\ns1 = uT [k]z[k] + ω[k]ν + d[k]\n\n(C.1.8)\n\nIn order that the above equations hold at time k1 , we need to have: P [k1 ] =\n\u0014\n\u0015T\n02×2 , g[k1 ] = u[k1 ] = 1 0 , ω[k1 ] = 0, and d[k1 ] = skf . Using (C.1.5) and (C.1.7),\nwe can write:\n\nλ[k] = 2Q̃[k]z[k] + ΦT P [k + 1]z[k + 1] + g[k + 1]ν\n\n\u0001\n\n(C.1.9)\n\nUsing (C.1.5) and (C.1.7), we can derive z[k + 1] in terms of z[k] and ν,\nwhich once inserted into (C.1.9) yields λ[k] as a function of z[k] and ν. Comparison\nof the so-obtained function for λ[k] to (C.1.7) and using Woodbury matrix identity\n[83] results in the following relations for the evolution of P [k] and g[k]:\nP [k] = 2Q̃[k] + ΦT P [k + 1] (I3 + Ψ[k]P [k + 1])−1 Φ\n\n(C.1.10)\n\ng[k] = ΦT (I3 + P [k + 1]Ψ[k])−1 g[k + 1]\n\n(C.1.11)\n\nNext, from (C.1.8) for times k and k +1, we can write two equivalent relations.\nInserting in z[k + 1], the function we obtained earlier in terms of z[k] and ν, and then\nequating the corresponding coefficients on both sides of the equations, we derive:\nu[k] = ΦT (I3 + P [k + 1]Ψ[k])−1 u[k + 1]\n\n(C.1.12)\n\nω[k] = ω[k + 1] − g T [k + 1] (I3 + Ψ[k]P [k + 1])−1 Ψ[k]g[k + 1]\n\n(C.1.13)\n\n191\n\nu[k] = g[k]\n\nd[k] = skf\n\n(C.1.14)\n\n∀k\n\n(C.1.15)\n\nFrom (C.1.8), (C.1.14), and (C.1.15) we can write\n\nν=\n\ns1 − skf − g T [k]z[k]\nω[k]\n\n(C.1.16)\n\nKnowing k1 , we can solve the dynamical equations for P [k], g[k], and ω[k]\nin a backward fashion to calculate g[0] and ω[0]. Inserting these values into (C.1.16)\nyields:\n\nν=\n\ns1 − skf − g T [0]z[0]\nω[0]\n\n(C.1.17)\n\nFinally, we can write the optimal current as follows:\n\ni[k] = − 2∆RΓ0eq [k] P [k + 1] (I3 + Ψ[k]P [k + 1])−1 Φz[k] − Ψ[k]g[k + 1]ν\nT\n\n\u0001\u0001\n\n+ g[k + 1]ν\n\n\u0001\n\n(C.1.18)\n\nNote that this is a state feedback (closed-loop) policy.\n\nC.2\n\nDetailed Version\n\nIn this appendix, we derive the LQ-CV algorithm stated in section 2.4. For a concise\nversion of derivation, the reader may see “Appendix C.1”. We assumed that at time\n\n192\n\nk1 , the SOC reaches the value vc . Therefore, we can relax the constraint s[k1 ] = s1\nwith Lagrangian multiplier ν. Also, the dynamics of the system are relaxed by co-state\nvector λ. Hence, the LQ problem is to minimize the following Lagrangian:\n\nL[k] = JtEsT + ν(s[k1 ] − s1 ) +\n\nkX\n1 −1\n\nλT [k + 1] (Φz[k] + Γi[k] − z[k + 1])\n\n\u0001\n\n(C.2.1)\n\nk=0\n\nInserting (2.4.33) into (C.2.1), we have\n\nL[k] = ρt k1 ∆ +\n\nkX\n1 −1 \u0010\n\n\u0011\n∆R0eq [k]i2 [k] + z T [k]Q̃[k]z[k] + ν(s[k1 ] − s1 )\n\nk=0\n\n+\n\nkX\n1 −1\n\nλT [k + 1] (Φz[k] + Γi[k] − z[k + 1])\n\n\u0001\n\nk=0\n\n= ν(s[k1 ] − s1 ) +\n\nkP\n1 −1 \u0010\n\n\u0011\nρt ∆ + ∆R0eq [k]i2 [k] + z T [k]Q̃[k]z[k] + λT [k + 1] (Φz[k] + Γi[k])\n\nk=0\n\n−\n\nkX\n1 −1\n\n\u0001\nλT [k]z[k] − λT [k1 ]z[k1 ]\n\nk=0\n\n(C.2.2)\n\u0014\n\n\u0015\n\nBy defining Hamiltonian H[k] as follows and noting that ν 0 z[k1 ] =\nν(s[k1 ] − skf ), we can write L[k] as in (C.2.4)\nH[k] = ρt ∆ + ∆R0eq [k]i2 [k] + z T [k]Q̃[k]z[k] + λT [k + 1] (Φz[k] + Γi[k]) (C.2.3)\n\n\u0013\nkP\n1 −1\n\u0001\nT\n−\nλ\n[k\n]\nz[k1 ] + H[0] +\nH[k] − λT [k]z[k] (C.2.4)\nν 0\n1\n\n\u0012\u0014\nL[k] = ν(skf − s1 ) +\n\n\u0015\n\nk=1\n\n193\n\nThe differential of L[k] for small changes in current profile is\n\u0012\n\u0013\n\u0013\n\u0010\n\u0011T\nkP\n1 −1\n∂H[k]\n∂H[k]\n∂H[0]\nT\nδi[0]\n+\nδi[k]\n+\n−\nλ[k]\n[k\n]\nδz[k\n−\nλ\n]\n+\n(C.2.5)\nδz[k]\nν 0\n1\n1\n∂i[0]\n∂i[k]\n∂z[k]\n\n\u0012\u0014\nδL[k] =\n\n\u0015\n\nk=1\n\nEquating the coefficients of δi[k] and δz[k] to zero, we obtain the necessary conditions\nfor optimality as follows:\n∂H[k]\n=0\n∂i[k]\n\nλ[k] =\n\nk = 0, 1, ..., k1 − 1\n\n(C.2.6)\n\nk = 1, ..., k1 − 1\n\n(C.2.7)\n\n∂H[k]\n∂z[k]\n\n\u0014\n\n\u0015T\n\nλ[k1 ] = ν 0\n\n(C.2.8)\n\nFrom (C.2.3) and (C.2.6), we can write:\n\ni[k] = −\n\nΓT\nλ[k + 1]\n2∆R0eq [k]\n\n(C.2.9)\n\nFrom (C.2.3) and (C.2.7), we can write:\n\nλ[k] =\n\n∂H[k]\n= 2Q̃[k]z[k] + ΦT λ[k + 1]\n∂z[k]\n\n(C.2.10)\n\nFrom (2.4.24), (C.2.9) and (C.2.10), we can write the dynamics of z[k] and\n\n194\n\nλ[k] in the following forward/backward form:\n\n\n−Ψ[k]    z[k]\nz[k + 1]    Φ\n=\n\n\nλ[k]\nλ[k + 1]\n2Q̃[k]\nΦT\n\n\n(C.2.11)\n\nwhere\n\nΨ[k] =\n\nΓΓT\n2∆R0eq [k]\n\n(C.2.12)\n\nIn order to obtain the optimal current profile, we first consider the following\nevolutions:\n\nλ[k] = P [k]z[k] + g[k]ν\n\n(C.2.13)\n\ns1 = uT [k]z[k] + ω[k]ν + d[k]\n\n(C.2.14)\n\nIn order that the above equations hold at time k1 , we need to have:\n\n\n0 0\nP [k1 ] =\n\n0 0\n\u0014\n\u0015T\ng[k1 ] = u[k1 ] = 1 0\n\n(C.2.16)\n\nω[k1 ] = 0\n\n(C.2.17)\n\nd[k1 ] = skf\n\n(C.2.18)\n\n195\n\n(C.2.15)\n\nFrom (C.2.11), we have\n\nλ[k] = 2Q̃[k]z[k] + ΦT λ[k + 1]\n\n(C.2.19)\n\nInserting λ[k] from (C.2.13) into (C.2.19), we have\n\nλ[k] = 2Q̃[k]z[k] + ΦT P [k + 1]z[k + 1] + g[k + 1]ν\n\n\u0001\n\n(C.2.20)\n\nFrom (C.2.11) we have\n\nz[k + 1] = Φz[k] − Ψ[k]λ[k + 1]\n\n(C.2.21)\n\nInserting λ[k + 1] from (C.2.13) into (C.2.21) we have\n\nz[k + 1] = Φz[k] − Ψ[k] P [k + 1]z[k + 1] + g[k + 1]ν\n\n\u0001\n\n(C.2.22)\n\nRearranging (C.2.22), we can find z[k + 1] in terms of z[k] and ν as follows\nz[k + 1] = (I3 + Ψ[k]P [k + 1])−1 Φz[k] − Ψ[k]g[k + 1]ν\n\n\u0001\n\n(C.2.23)\n\nInserting z[k + 1] from (C.2.23) into (C.2.20), we have\n\nλ[k] = 2Q̃[k]z[k] + ΦT P [k + 1] (I3 + Ψ[k]P [k + 1])−1 Φz[k] − Ψ[k]g[k + 1]ν\n\n\u0001\u0001\n\n\u0001\n+ g[k + 1]ν (C.2.24)\n\nComparing (C.2.24) with (C.2.13), we can write the following relations for the evolution\n\n196\n\nof P [k] and g[k]:\nP [k] = 2Q̃[k] + ΦT P [k + 1] (I3 + Ψ[k]P [k + 1])−1 Φ\n\n(C.2.25)\n\n\u0001\ng[k] = ΦT I3 − P [k + 1] (I3 + Ψ[k]P [k + 1])−1 Ψ[k] g[k + 1]\n\n(C.2.26)\n\nUsing Woodbury matrix identity, shown below, we can write (C.2.26) as\n(C.2.28)\n\u0001\n(A + BCD)−1 = A−1 − A−1 B C −1 + DA−1 B DA−1\n\n(C.2.27)\n\ng[k] = ΦT (I3 + P [k + 1]Ψ[k])−1 g[k + 1]\n\n(C.2.28)\n\nNext, from (C.2.14) for times k and k + 1, we can write\n\nuT [k]z[k] + ω[k]ν + d[k] = uT [k + 1]z[k + 1] + ω[k + 1]ν + d[k + 1]\n\n197\n\n(C.2.29)\n\nInserting z[k + 1] from (C.2.23) into (C.2.29), we have\nuT [k]z[k] + ω[k]ν + d[k] = uT [k + 1] (I3 + Ψ[k]P [k + 1])−1 Φz[k] − Ψ[k]g[k + 1]ν\n\n\u0001\u0001\n\n+ ω[k + 1]ν + d[k + 1]\n= uT [k + 1] (I3 + Ψ[k]P [k + 1])−1 Φz[k]\n\u0001\n+ ω[k + 1] − uT [k + 1] (I3 + Ψ[k]P [k + 1])−1 Ψ[k]g[k + 1] ν\n+ d[k + 1]\n(C.2.30)\nBy equating the coefficients of z[k] at both sides of (C.2.30), we have\nu[k] = ΦT (I3 + P [k + 1]Ψ[k])−1 u[k + 1]\n\n(C.2.31)\n\nComparing (C.2.31) with (C.2.28) and noting that u[k1 ] = g[k1 ], we can see that\n\nu[k] = g[k]\n\n(C.2.32)\n\nBy equating the coefficients of ν on both sides of (C.2.30), we have\nω[k] = ω[k + 1] − g T [k + 1] (I3 + Ψ[k]P [k + 1])−1 Ψ[k]g[k + 1]\n\n(C.2.33)\n\nFinally, it is easy to conclude\n\nd[k] = skf\n\n198\n\n∀k\n\n(C.2.34)\n\nFrom (C.2.14), (C.2.32), and (C.2.34) we can write\n\nν=\n\ns1 − skf − g T [k]z[k]\nω[k]\n\n(C.2.35)\n\nFor ready reference, the required equations are gathered together in the\nfollowing:\n\nP [k] = 2Q̃[k] + ΦT P [k + 1] (I3 + Ψ[k]P [k + 1])−1 Φ\n\n\n0 0\nP [k1 ] =\n\n0 0\ng[k] = ΦT (I3 + P [k + 1]Ψ[k])−1 g[k + 1]\n\u0014\n\u0015T\ng[k1 ] = 1 0\n\n(C.2.36)\n\nω[k] = ω[k + 1] − g T [k + 1] (I3 + Ψ[k]P [k + 1])−1 Ψ[k]g[k + 1]\nω[k1 ] = 0\nKnowing k1 , we can easily solve equations in (C.2.36) in a backward fashion\nto obtain the evolution of P [k], g[k], and ω[k] for k = k1 − 1, k1 − 2, . . . , 1, 0. Once\nwe calculate g[0] and ω[0], since we already know z[0], by inserting these values into\n(C.2.35), we can find the value of ν as follows:\n\nν=\n\ns1 − skf − g T [0]z[0]\nω[0]\n\nInserting (C.2.13) into (C.2.9), we have:\n\n199\n\n(C.2.37)\n\nΓT\nλ[k + 1]\n2∆R0eq [k]\n\u0001\nΓT\nP [k + 1]z[k + 1] + g[k + 1]ν\n=−\n2∆R0eq [k]\n\ni[k] = −\n\n(C.2.38)\n\nInserting (C.2.23) into (C.2.38), we can write the optimal current as follows:\n\ni[k] = − 2∆RΓ0eq [k] P [k + 1] (I3 + Ψ[k]P [k + 1])−1 Φz[k] − Ψ[k]g[k + 1]ν\nT\n\nNote that this is a state feedback policy.\n\n200\n\n\u0001\u0001\n\n+ g[k + 1]ν\n\n\u0001\n\n(C.2.39)\n\nBibliography\n[1] https://github.com/abdollahiali/phd-dissertation-oral-presentation.\n[2] http://www.keithley.com/products/dcac/currentvoltage/highpower/?mn=2651a.\n[3] http://www.teamqsi.com/tag/industrial/.\n[4] Burnham, Kenneth P and Anderson, David R, Model selection and inference: a\npractical information-theoretic approach, Springer-Verlag, New York, 1998.\n[5] A Abdollahi, X Han, GV Avvari, N Raghunathan, B Balasingam, KR Pattipati,\nand Y Bar-Shalom, Optimal battery charging, part I: Minimizing time-to-charge,\nenergy loss, and temperature rise for OCV-resistance battery model, Journal of\nPower Sources 303 (2016), 388–398.\n[6] A. Abdollahi, X. Han, N. Raghunathan, B. Pattipati, B. Balasingam, K. R.\nPattipati, Y. Bar-Shalom, and B. Card, Optimal charging for general equivalent\nelectrical battery model, and battery life management, Journal of Energy Storage\n9 (2017), 47–58.\n\n201\n\n[7] A. Abdollahi and K. Pattipati, Unification of leaky noisy OR and logistic\nregression models and maximum a posteriori inference for multiple fault diagnosis\nusing the unified model, DX Conference (Denver, Co), Oct. 4-7 2016.\n[8] A. Abdollahi and K. R. Pattipati, Probabilistic graphical models for fault prognosis in complex systems, in preparation (2017).\n[9] A Abdollahi, N Raghunathan, X Han, GV Avvari, B Balasingam, KR Pattipati,\nand Y Bar-Shalom, Battery charging optimization for OCV-resistance equivalent\ncircuit model, 2015 American Control Conference (ACC), IEEE, 2015, pp. 3467–\n3472.\n[10] A Abdollahi, N Raghunathan, X Han, B Pattipati, B Balasingam, KR Pattipati, Y Bar-Shalom, and B Card, Battery health degradation and optimal life\nmanagement, IEEE AUTOTESTCON, 2015, IEEE, 2015, pp. 146–151.\n[11] Ali Abdollahi, Krishna R Pattipati, Anuradha Kodali, Satnam Singh, Shigang\nZhang, and Peter B Luh, Probabilistic graphical models for fault diagnosis\nin complex systems, Principles of Performance and Reliability Modeling and\nEvaluation, Springer, 2016, pp. 109–139.\n[12] Rafik A Aliev, Rashad R Aliev, Babek Guirimov, and K Uyar, Dynamic data\nmining technique for rules extraction in a process of battery charging, Applied\nSoft Computing 8 (2008), no. 3, 1252–1258.\n[13] Chrissanthi Angeli and Avraam Chatzinikolaou, On-line fault detection techniques for technical systems: A survey., IJCSA 1 (2004), no. 1, 12–30.\n\n202\n\n[14] Arora, Pankaj and White, Ralph E and Doyle, Marc, Capacity fade mechanisms\nand side reactions in lithium-ion batteries, Journal of the Electrochemical Society\n145 (1998), no. 10, 3647–3667.\n[15] M Athans, K-P Dunn, C. S. Greene, WH Lee, NR Sandell, I Segall, and A. S.\nWillsky, The stochastic control of the f-8c aircraft using the multiple model\nadaptive control (MMAC) method, Decision and Control including the 14th\nSymposium on Adaptive Processes, 1975 IEEE Conference on, IEEE, 1975,\npp. 217–228.\n[16] M Athans, K-P Dunn, CS Greene, WH Lee, NR Sandell, I Segall, and AS Willsky,\nThe stochastic control of the f-8c aircraft using the multiple model adaptive\ncontrol (mmac) method, Decision and Control including the 14th Symposium on\nAdaptive Processes, 1975 IEEE Conference on, vol. 14, IEEE, 1975, pp. 217–228.\n[17] Mihiar Ayoubi and Rolf Isermann, Neuro-fuzzy systems for diagnosis, Fuzzy\nsets and Systems 89 (1997), no. 3, 289–307.\n[18] Mohammad S Azam, Fang Tu, Krishna R Pattipati, and Rajaiah Karanam, A\ndependency model-based approach for identifying and evaluating power quality\nproblems, IEEE Transactions on power delivery 19 (2004), no. 3, 1154–1166.\n[19] George K Baah, Andy Podgurski, and Mary Jean Harrold, The probabilistic program dependence graph and its application to fault diagnosis, IEEE Transactions\non Software Engineering 36 (2010), no. 4, 528–545.\n[20] B Balasingam, GV Avvari, B Pattipati, KR Pattipati, and Y Bar-Shalom, A\nrobust approach to battery fuel gauging, part I: Real time model identification,\nJournal of Power Sources 272 (2014), 1142–1153.\n203\n\n[21]\n\n, A robust approach to battery fuel gauging, part II: Real time capacity\nestimation, Journal of Power Sources 269 (2014), 949–961.\n\n[22] Michèle Basseville, Detecting changes in signals and systemsa survey, Automatica\n24 (1988), no. 3, 309–326.\n[23] Michele Basseville and Albert Benveniste, Desgin and comparative study of some\nsequential jump detection algorithms for digital signals, IEEE Transactions on\nAcoustics, Speech, and Signal Processing 31 (1983), no. 3, 521–535.\n[24] Michèle Basseville, Igor V Nikiforov, et al., Detection of abrupt changes: theory\nand application, vol. 104, Prentice Hall Englewood Cliffs, 1993.\n[25] Richard Vernon Beard, Failure accomodation in linear systems through selfreorganization., Ph.D. thesis, Massachusetts Institute of Technology, 1971.\n[26] John E Beasley, An algorithm for set covering problem, European Journal of\nOperational Research 31 (1987), no. 1, 85–93.\n[27]\n\n, A lagrangian heuristic for set-covering problems, Naval Research Logistics (NRL) 37 (1990), no. 1, 151–164.\n\n[28] John E Beasley and Paul C Chu, A genetic algorithm for the set covering\nproblem, European journal of operational research 94 (1996), no. 2, 392–404.\n[29] John E Beasley and Kurt Jörnsten, Enhancing an algorithm for set covering\nproblems, European Journal of Operational Research 58 (1992), no. 2, 293–300.\n[30] DP Bertsekas, Nonlinear programming 2nd edn (belmont, ma: Athena scientific),\n(1999).\n204\n\n[31] Zhong Binglin, Yan Tinghu, Huang Ren, and JA Brandon, A genetic algorithm\nfor diagnosis problem solving, Systems, Man and Cybernetics, 1993.’Systems\nEngineering in the Service of Humans’, Conference Proceedings., International\nConference on, vol. 2, IEEE, 1993, pp. 404–408.\n[32] Christopher M Bishop, Neural networks for pattern recognition, Oxford university\npress, 1995.\n[33] Douglas M. Blough and Andrzej Pelc, Complexity of fault diagnosis in comparison\nmodels, IEEE Transactions on computers 41 (1992), no. 3, 318–324.\n[34] R Boel, P Varaiya, and E Wong, Martingales on jump processes. II: Applications,\nSIAM Journal on Control 13 (1975), no. 5, 1022–1061.\n[35] René Boel, Pravin Varaiya, and Eugene Wong, Martingales on jump processes.\nI: Representation results, SIAM Journal on control 13 (1975), no. 5, 999–1021.\n[36] R Boumen, Sui Ruan, Ivo SM de Jong, JM Van De Mortel-Fronczak, JE Rooda,\nand Krishna R Pattipati, Hierarchical test sequencing for complex systems, IEEE\nTransactions on Systems, Man, and Cybernetics-Part A: Systems and Humans\n39 (2009), no. 3, 640–649.\n[37] Mikhail A Bragin, Peter B Luh, Joseph H Yan, Nanpeng Yu, and Gary A\nStern, Convergence of the surrogate lagrangian relaxation method, Journal of\nOptimization Theory and applications 164 (2015), no. 1, 173.\n[38] Kenneth P Burnham, David R Anderson, and Kathryn P Huyvaert, Aic model\nselection and multimodel inference in behavioral ecology: some background,\n\n205\n\nobservations, and comparisons, Behavioral Ecology and Sociobiology 65 (2011),\nno. 1, 23–35.\n[39] Chaturvedi, Nalin A and Klein, Reinhardt and Christensen, Jake and Ahmed,\nJasim and Kojic, Aleksandar, Algorithms for advanced battery-management\nsystems, IEEE Control Systems 30 (2010), no. 3, 49–68.\n[40] Jie Chen and Ron J Patton, Robust model-based fault diagnosis for dynamic\nsystems, vol. 3, Springer Science & Business Media, 2012.\n[41] Liang-Rui Chen, A design of an optimal battery pulse charge system by frequencyvaried technique, IEEE Transactions on Industrial Electronics 54 (2007), no. 1,\n398–405.\n[42]\n\n, Design of duty-varied voltage pulse charger for improving li-ion batterycharging response, IEEE Transactions on Industrial Electronics 56 (2009), no. 2,\n480–487.\n\n[43] Liang-Rui Chen, Roy Chaoming Hsu, and Chuan-Sheng Liu, A design of a\ngrey-predicted li-ion battery charge system, IEEE Transactions on Industrial\nElectronics 55 (2008), no. 10, 3692–3701.\n[44] Stefano Chessa and Paolo Santi, Operative diagnosis of graph-based systems with\nmultiple faults, IEEE Transactions on Systems, Man, and Cybernetics-Part A:\nSystems and Humans 31 (2001), no. 2, 112–119.\n[45] Kihoon Choi, M Madhavi Namburu, Mohammad Azam, Jianhui Luo, Krishna\nPattipati, and Ann Patterson-Hine, Fault diagnosis in hvac chillers using data-\n\n206\n\ndriven techniques, AUTOTESTCON 2004. Proceedings, IEEE, 2004, pp. 407–\n413.\n[46] Kihoon Choi, Satnam Singh, Anuradha Kodali, Krishna R Pattipati, John W\nSheppard, Setu Madhavi Namburu, Shunsuke Chigusa, Danil V Prokhorov, and\nLiu Qiao, Novel classifier fusion approaches for fault diagnosis in automotive\nsystems, IEEE Transactions on Instrumentation and Measurement 58 (2009),\nno. 3, 602–611.\n[47] EYEY Chow and AS Willsky, Analytical redundancy and the design of robust\nfailure detection systems, IEEE Transactions on automatic control 29 (1984),\nno. 7, 603–614.\n[48] Vasek Chvatal, A greedy heuristic for the set-covering problem, Mathematics of\noperations research 4 (1979), no. 3, 233–235.\n[49] Robert N Clark, Douglas C Fosth, and Vincent M Walton, Detecting instrument\nmalfunctions in control systems, IEEE Transactions on Aerospace and Electronic\nSystems (1975), no. 4, 465–473.\n[50]\n\n, Detecting instrument malfunctions in control systems, IEEE Transactions on Aerospace and Electronic Systems (1975), no. 4, 465–473.\n\n[51] Richard C Cope and Yury Podrazhansky, The art of battery charging, Battery\nConference on Applications and Advances. The Fourteenth Annual, IEEE, 1999,\npp. 233–235.\n\n207\n\n[52] Anton T. Dahbura and Gerald M. Masson, An o(n2.5 ) fault identification algorithm for diagnosable systems, IEEE Transactions on Computers (1984), no. 6,\n486–492.\n[53] Anton T Dahbura, Krishan K Sabnani, and Linda L King, The comparison\napproach to multiprocessor fault diagnosis, IEEE Transactions on Computers 36\n(1987), no. 3, 373–378.\n[54] Xuewu Dai and Zhiwei Gao, From model, signal to knowledge: A data-driven\nperspective of fault detection and diagnosis, IEEE Transactions on Industrial\nInformatics 9 (2013), no. 4, 2226–2238.\n[55] Jaime M De Faria, Carlos RP Hartmann, Carl L Gerberich, and Pramod\nVarshney, An information theoretic approach to the construction of efficient\ndecision trees, (1980).\n[56] Johan De Kleer and Brian C Williams, Diagnosing multiple faults, Artificial\nintelligence 32 (1987), no. 1, 97–130.\n[57] Somnath Deb, Krishna R Pattipati, Vijay Raghavan, Mojdeh Shakeri, and\nRoshan Shrestha, Multi-signal flow graphs: a novel approach for system testability\nanalysis and fault diagnosis, IEEE Aerospace and Electronic Systems Magazine\n10 (1995), no. 5, 14–25.\n[58] AL Dexter, Fuzzy model based fault diagnosis, IEE Proceedings-Control Theory\nand Applications 142 (1995), no. 6, 545–550.\n[59] Markus Einhorn, Fiorentino Valerio Conte, Christian Kral, and Juergen Fleig, A\nmethod for online capacity estimation of lithium ion battery cells using the state\n208\n\nof charge and the transferred charge, IEEE Transactions on Industry Applications\n48 (2012), no. 2, 736–741.\n[60] N El Alami, A Ouansafi, and N Znaidi, On the discrete linear quadratic minimumtime problem, Journal of the Franklin Institute 335 (1998), no. 3, 525–532.\n[61] Samuel L Fagin, Recursive linear regression theory, optimal filter theory, and\nerror analysis of optimal systems, IEEE international convention record, vol. 12,\n1964, pp. 216–245.\n[62] De Faria et al., Application of information theory to sequential fault diagnosis,\nIEEE Transactions on Computers 100 (1982), no. 2, 164–170.\n[63] Giulio Fedi, Riccardo Giomi, Antonio Luchetta, Stefano Manetti, and\nMaria Cristina Piccirilli, On the application of symbolic techniques to the multiple\nfault location in low testability analog circuits, IEEE Transactions on Circuits and\nSystems II: Analog and Digital Signal Processing 45 (1998), no. 10, 1383–1388.\n[64] Marshall L Fisher, The lagrangian relaxation method for solving integer programming problems, Management science 27 (1981), no. 1, 1–18.\n[65] Paul M Frank, Fault diagnosis in dynamic systems using analytical and\nknowledge-based redundancy: A survey and some new results, automatica 26\n(1990), no. 3, 459–474.\n[66]\n\n, Analytical and qualitative model-based fault diagnosis–a survey and\nsome new results, European Journal of control 2 (1996), no. 1, 6–28.\n\n209\n\n[67] Paul M Frank and Xianchun Ding, Survey of robust residual generation and\nevaluation methods in observer-based fault detection systems, Journal of process\ncontrol 7 (1997), no. 6, 403–424.\n[68] Paul M Frank and Birgit Köppen-Seliger, New developments using AI in fault\ndiagnosis, Engineering Applications of Artificial Intelligence 10 (1997), no. 1,\n3–14.\n[69]\n\n, New developments using ai in fault diagnosis, Engineering Applications\nof Artificial Intelligence 10 (1997), no. 1, 3–14.\n\n[70] PM Frank, SX Ding, and T Marcu, Model-based fault diagnosis in technical\nprocesses, Transactions of the Institute of Measurement and Control 22 (2000),\nno. 1, 57–101.\n[71] Zhiwei Gao, Carlo Cecati, and Steven X Ding, A survey of fault diagnosis and\nfault-tolerant techniquespart i: Fault diagnosis with model-based and signalbased approaches, IEEE Transactions on Industrial Electronics 62 (2015), no. 6,\n3757–3767.\n[72] M. R. Garey and D. S. Johnson, Computers and intractability : A guide to the\ntheory of np-completeness, New York: Freeman, 1983.\n[73] Janos J Gertler, Survey of model-based failure detection and isolation in complex\nplants, IEEE Control systems magazine 8 (1988), no. 6, 3–11.\n[74]\n\n, Fault detection and diagnosis in engineering systems, CRC press, 1998.\n\n210\n\n[75] Kai Goebel, Bhaskar Saha, Abhinav Saxena, Jose R Celaya, and Jon P Christophersen, Prognostics in battery health management, IEEE instrumentation &\nmeasurement magazine 11 (2008), no. 4, 33–40.\n[76] Guifang Guo, Peng Xu, Zhifeng Bai, Shiqiong Zhou, Gang Xu, and Binggang Cao,\nOptimization of ni-mh battery fast charging in electric vehicles using dynamic data\nmining and anfis, International Conference on Intelligent Computing, Springer,\n2008, pp. 468–475.\n[77] Zhen Guo, Bor Yann Liaw, Xinping Qiu, Lanlan Gao, and Changshui Zhang,\nOptimal charging method for lithium ion batteries using a universal voltage\nprotocol accommodating aging, Journal of Power Sources 274 (2015), 957–964.\n[78] Zhen Guo, Xinping Qiu, Guangdong Hou, Bor Yann Liaw, and Changshui Zhang,\nState of health estimation for lithium ion batteries based on charging curves,\nJournal of Power Sources 249 (2014), 457–462.\n[79] Edmund Handschin, Fred C Schweppe, Jurg Kohlas, and Armin Fiechter, Bad\ndata analysis for power system state estimation, IEEE Transactions on Power\nApparatus and Systems 94 (1975), no. 2, 329–337.\n[80]\n\n, Bad data analysis for power system state estimation, Power Apparatus\nand Systems, IEEE Transactions on 94 (1975), no. 2, 329–337.\n\n[81] Fan He and Lin Ma, Thermal management of batteries employing active temperature control and reciprocating cooling flow, International Journal of Heat and\nMass Transfer 83 (2015), 164–172.\n\n211\n\n[82] Wei He, Nicholas Williard, Michael Osterman, and Michael Pecht, Prognostics\nof lithium-ion batteries based on dempster–shafer theory and the bayesian monte\ncarlo method, Journal of Power Sources 196 (2011), no. 23, 10314–10321.\n[83] Nicholas J Higham, Accuracy and stability of numerical algorithms, Siam, 2002.\n[84] Xiaosong Hu, Shengbo Li, Huei Peng, and Fengchun Sun, Charging time and\nloss optimization for linmc and lifepo 4 batteries based on equivalent circuit\nmodels, Journal of Power Sources 239 (2013), 449–457.\n[85] Hu, Xiaosong and Li, Shengbo Eben and Jia, Zhenzhong and Egardt, Bo, Enhanced sample entropy-based health management of Li-ion battery for electrified\nvehicles, Energy 64 (2014), 953–960.\n[86] Inseok Hwang, Sungwan Kim, Youdan Kim, and Chze Eng Seah, A survey of\nfault detection, isolation, and reconfiguration methods, IEEE Transactions on\nControl Systems Technology 18 (2010), no. 3, 636–653.\n[87] Laurent Hyafil and Ronald L Rivest, Constructing optimal binary decision trees\nis np-complete, Information processing letters 5 (1976), no. 1, 15–17.\n[88] Tomohiko Ikeya, Nobuyuki Sawada, Jun-ich Murakami, Kazsuyuki Kobayashi,\nMasanori Hattori, Nobuo Murotani, Satoru Ujiie, Katuya Kajiyama, Hideki\nNasu, Hayato Narisoko, et al., Multi-step constant-current charging method for\nan electric vehicle nickel/metal hydride battery with high-energy efficiency and\nlong cycle life, Journal of power sources 105 (2002), no. 1, 6–12.\n[89] Tomohiko Ikeya, Nobuyuki Sawada, Sakae Takagi, Jun-ichi Murakami, Kazuyuki\nKobayashi, Tetsuya Sakabe, Eiichi Kousaka, Haruki Yoshioka, Satoru Kato,\n212\n\nMasanori Yamashita, et al., Multi-step constant-current charging method for\nelectric vehicle, valve-regulated, lead/acid batteries during night time for loadlevelling, Journal of power sources 75 (1998), no. 1, 101–107.\n[90] Rolf Isermann, Process fault detection based on modeling and estimation methodsa\nsurvey, automatica 20 (1984), no. 4, 387–404.\n[91]\n\n, On fuzzy logic applications for automatic control, supervision, and\nfault diagnosis, IEEE Transactions on Systems, Man, and Cybernetics-Part A:\nSystems and Humans 28 (1998), no. 2, 221–235.\n\n[92]\n\n, Model-based fault-detection and diagnosis–status and applications, Annual Reviews in control 29 (2005), no. 1, 71–85.\n\n[93] Rolf Isermann and Peter Balle, Trends in the application of model-based fault\ndetection and diagnosis of technical processes, Control engineering practice 5\n(1997), no. 5, 709–719.\n[94] A Jazwinski, Limited memory optimal filtering, IEEE Transactions on Automatic\nControl 13 (1968), no. 5, 558–563.\n[95] Andrew H Jazwinski, Stochastic processes and filtering theory, Courier Corporation, 2007.\n[96] Shengbing Jiang and Ratnesh Kumar, Failure diagnosis of discrete-event systems\nwith linear-time temporal logic specifications, IEEE Transactions on Automatic\nControl 49 (2004), no. 6, 934–945.\n[97] Harold Lee Jones, Failure detection in linear systems., Ph.D. thesis, Massachusetts Institute of Technology, 1973.\n213\n\n[98]\n\n, Failure detection in linear systems., Ph.D. thesis, Massachusetts Institute of Technology, 1973.\n\n[99] Michael Irwin Jordan, Learning in graphical models, vol. 89, Springer Science &\nBusiness Media, 1998.\n[100] Peter Keil and Andreas Jossen, Charging protocols for lithium-ion batteries and\ntheir impact on cycle lifean experimental study with different 18650 high-power\ncells, Journal of Energy Storage 6 (2016), 125–141.\n[101] T. H. Kerr, A two ellipsoid overlap test for real time failure detection and isolation\nby confidence regions, IEEE Conference on Decision and Control including the\n13th Symposium on Adaptive Processes, 1974, pp. 735–742.\n[102] Klein, Reinhardt and Chaturvedi, Nalin A and Christensen, Jake and Ahmed,\nJasim and Findeisen, Rolf and Kojic, Aleksandar, Optimal charging strategies\nin lithium-ion battery, Proceedings of the 2011 American Control Conference,\nIEEE, 2011, pp. 382–387.\n[103] Anuradha Kodali, Krishna Pattipati, and Satnam Singh, Coupled factorial\nhidden markov models (cfhmm) for diagnosing multiple and coupled faults, IEEE\nTransactions on Systems, Man, and Cybernetics: Systems 43 (2013), no. 3,\n522–534.\n[104] Anuradha Kodali, Satnam Singh, and Krishna Pattipati, Dynamic set-covering\nfor real-time multiple fault diagnosis with delayed test outcomes, IEEE Transactions on Systems, Man, and Cybernetics: Systems 43 (2013), no. 3, 547–562.\n\n214\n\n[105] Anuradha Kodali, Yilu Zhang, Chaitanya Sankavaram, Krishna Pattipati, and\nMutasim Salman, Fault diagnosis in the automotive electric power generation\nand storage system (epgs), IEEE/ASME Transactions on Mechatronics 18 (2013),\nno. 6, 1809–1818.\n[106] Masasumi Kokawa, Satoshi Miyazaki, and Sadanori Shingai, Fault location using\ndigraph and inverse direction search with application, Automatica 19 (1983),\nno. 6, 729–735.\n[107] Mattias Krysander and Erik Frisk, Sensor placement for fault diagnosis, IEEE\nTransactions on Systems, Man, and Cybernetics-Part A: Systems and Humans\n38 (2008), no. 6, 1398–1410.\n[108] Benjamin Kuipers, The limits of qualitative simulation., IJCAI, 1985, pp. 128–\n136.\n[109]\n\n, Qualitative simulation, Artificial intelligence 29 (1986), no. 3, 289–338.\n\n[110]\n\n, Qualitative simulation as causal explanation, IEEE Transactions on\nSystems, Man, and Cybernetics 17 (1987), no. 3, 432–444.\n\n[111] D. G. Lainiotis, Joint detection, estimation and system identification, Information\nand control 19 (1971), no. 1, 75–92.\n[112] Steffen Leonhardt and M Ayoubi, Methods of fault diagnosis, Control engineering\npractice 5 (1997), no. 5, 683–692.\n[113] Jun Li, Edward Murphy, Jack Winnick, and Paul A Kohl, The effects of pulse\ncharging on cycling characteristics of commercial lithium-ion batteries, Journal\nof Power Sources 102 (2001), no. 1, 302–309.\n215\n\n[114] Xianke Lin, Jonghyun Park, Lin Liu, Yoonkoo Lee, AM Sastry, and Wei Lu, A\ncomprehensive capacity fade model and analysis for li-ion batteries, Journal of\nThe Electrochemical Society 160 (2013), no. 10, A1701–A1710.\n[115] Yi-Hwa Liu, Ching-Hsing Hsieh, and Yi-Feng Luo, Search for an optimal fivestep charging pattern for li-ion batteries using consecutive orthogonal arrays,\nIEEE Transactions on Energy Conversion 26 (2011), no. 2, 654–661.\n[116] Yi-Hwa Liu and Yi-Feng Luo, Search for an optimal rapid-charging pattern for\nli-ion batteries using the taguchi approach, IEEE Transactions on Industrial\nElectronics 57 (2010), no. 12, 3963–3971.\n[117] Yi-Hwa Liu, Jen-Hao Teng, and Yu-Chung Lin, Search for an optimal rapid\ncharging pattern for lithium-ion batteries using ant colony system algorithm,\nIEEE Transactions on Industrial Electronics 52 (2005), no. 5, 1328–1336.\n[118] Lennart Ljung and Torsten Söderström, Theory and practice of recursive identification, vol. 5, JSTOR, 1983.\n[119] Jianhui Luo, Madhavi Namburu, Krishna R Pattipati, Liu Qiao, and Shunsuke\nChigusa, Integrated model-based and data-driven diagnosis of automotive antilock\nbraking systems, IEEE Transactions on Systems, Man, and Cybernetics-Part A:\nSystems and Humans 40 (2010), no. 2, 321–336.\n[120] Jianhui Luo, Krishna R Pattipati, Liu Qiao, and Shunsuke Chigusa, An integrated\ndiagnostic development process for automotive engine control systems, IEEE\nTransactions on Systems, Man, and Cybernetics, Part C (Applications and\nReviews) 37 (2007), no. 6, 1163–1173.\n\n216\n\n[121] M-A Massoumnia, A geometric approach to the synthesis of failure detection\nfilters, IEEE Transactions on automatic control 31 (1986), no. 9, 839–846.\n[122] Raman K Mehra and J Peschon, An innovations approach to fault detection and\ndiagnosis in dynamic systems, Automatica 7 (1971), no. 5, 637–640.\n[123]\n\n, An innovations approach to fault detection and diagnosis in dynamic\nsystems, Automatica 7 (1971), no. 5, 637–640.\n\n[124] Hyde McCune Merrill, Bad data suppression in state estimation, with applications\nto problems in power., Ph.D. thesis, Massachusetts Institute of Technology, 1972.\n[125] Hyde McCune Merrill, Bad data suppression in state estimation, with applications\nto problems in power., Ph.D. thesis, Massachusetts Institute of Technology, 1972.\n[126] Walter C Merrill, Sensor failure detection for jet engines using analytical redundancy, J. Guidance 8 (1985), no. 8.\n[127] John A Miller, Walter D Potter, Ravi V Gandham, and Chito N Lapena,\nAn evaluation of local improvement operators for genetic algorithms, IEEE\nTransactions on Systems, Man, and Cybernetics 23 (1993), no. 5, 1340–1351.\n[128] R Miller, Complexity of computer computations: Proceedings of a symposium on\nthe complexity of computer computations, held march 20–22, 1972, at the ibm\nthomas j. watson research center, yorktown heights, new york, and sponsored by\nthe office of naval research, mathematics program, ibm world trade corporation,\nand the ibm research mathematical sciences department, Springer Science &\nBusiness Media, 2013.\n\n217\n\n[129] Robert Milne, Strategies for diagnosis, IEEE Transactions on Systems, Man,\nand Cybernetics 17 (1987), no. 3, 333–339.\n[130] Kevin P Murphy, Machine learning: a probabilistic perspective, MIT press, 2012.\n[131] Kenney Ng and Richard P Lippmann, A comparative study of the practical\ncharacteristics of neural network and conventional pattern classifiers, Advances\nin neural information processing systems, 1991, pp. 970–976.\n[132] Peter HL Notten, JHG Op het Veld, and JRG Van Beek, Boostcharging li-ion\nbatteries: A challenging new charging concept, Journal of Power Sources 145\n(2005), no. 1, 89–94.\n[133] Mattias Nyberg, Model-based diagnosis of an automotive engine using several\ntypes of fault models, IEEE Transactions on control systems technology 10\n(2002), no. 5, 679–689.\n[134] Claire E Parfitt, William E Crofts, and Rachel Buckle, An adaptable lithium-ion\nbattery model, ECS Transactions 28 (2010), no. 22, 21–33.\n[135] B Pattipati, B Balasingam, A Abdollahi, GV Avvari, KR Pattipati, and Y BarShalom, Integrated battery fuel gauge and optimal charger, 2014 IEEE AUTOTEST, IEEE, 2014, pp. 260–269.\n[136] Bharath Pattipati, Chaitanya Sankavaram, and Krishna Pattipati, System identification and estimation framework for pivotal automotive battery management\nsystem characteristics, IEEE Transactions on Systems, Man, and Cybernetics,\nPart C (Applications and Reviews) 41 (2011), no. 6, 869–884.\n\n218\n\n[137] KR Pattipati, V Raghavan, M Shakeri, S Deb, and R Shrestha, Teams: testability\nengineering and maintenance system, American Control Conference, 1994, vol. 2,\nIEEE, 1994, pp. 1989–1995.\n[138] Krishna R Pattipati and Mark G Alexandridis, Application of heuristic search\nand information theory to sequential fault diagnosis, IEEE Transactions on\nSystems, Man, and Cybernetics 20 (1990), no. 4, 872–887.\n[139] Krishna R Pattipati and Mahesh Dontamsetty, On a generalized test sequencing\nproblem, IEEE transactions on systems, man, and cybernetics 22 (1992), no. 2,\n392–396.\n[140] RJ Patton, Fault detection and diagnosis in aerospace systems using analytical\nredundancy, Computing & Control Engineering Journal 2 (1991), no. 3, 127–136.\n[141] RJ Patton, FJ Uppal, and CJ Lopez-Toribio, Soft computing approaches to fault\ndiagnosis for dynamic systems: a survey, IFAC Proceedings Volumes 33 (2000),\nno. 11, 303–315.\n[142] Ron J Patton, Robustness in model-based fault diagnosis: the 1995 situation,\nAnnual reviews in control 21 (1997), 103–123.\n[143] Ron J Patton, Paul M Frank, and Robert N Clark, Issues of fault diagnosis for\ndynamic systems, Springer Science & Business Media, 2000.\n[144] Yun Peng and James A Reggia, A probabilistic causal model for diagnostic\nproblem solving part i: Integrating symbolic causal inference with numeric\nprobabilistic inference, IEEE Transactions on Systems, Man, and Cybernetics\n17 (1987), no. 2, 146–162.\n219\n\n[145]\n\n, A probabilistic causal model for diagnostic problem solving part ii:\nDiagnostic strategy, IEEE Transactions on Systems, Man, and Cybernetics 17\n(1987), no. 3, 395–406.\n\n[146] Ahmad A Pesaran, Battery thermal models for hybrid vehicle simulations, Journal\nof Power Sources 110 (2002), no. 2, 377–382.\n[147] Ahmad A Pesaran, Andreas Vlahinos, and Steven D Burch, Thermal performance\nof ev and hev battery modules and packs, National Renewable Energy Laboratory,\n1997.\n[148] Panom Petchjatuporn, Noppadol Khaehintung, Khamron Sunat, Phaophak\nSirisuk, and Wiwat Kiranon, Implementation of GA-trained GRNN for intelligent\nfast charger for ni-cd batteries, Power Electronics and Motion Control Conference,\nCES/IEEE 5th International, vol. 1, IEEE, 2006, pp. 1–5.\n[149] David Walter Peterson, Hypothesis, estimation, and validation of dynamic social\nmodels: energy demand modeling., Ph.D. thesis, Massachusetts Institute of\nTechnology, 1975.\n[150] Gregory L Plett, Extended kalman filtering for battery management systems of\nLiPB-based hev battery packs: Part 3. state and parameter estimation, Journal\nof Power sources 134 (2004), no. 2, 277–292.\n[151]\n\n, Recursive approximate weighted total least squares estimation of battery\ncell total capacity, Journal of Power Sources 196 (2011), no. 4, 2319–2331.\n\n[152] Prasad, Githin K and Rahn, Christopher D, Model based identification of aging\nparameters in lithium ion batteries, Journal of power sources 232 (2013), 79–85.\n220\n\n[153] BK Purushothaman and U Landau, Rapid charging of lithium-ion batteries using\npulsed currents a theoretical analysis, Journal of The Electrochemical Society\n153 (2006), no. 3, A533–A542.\n[154] Vijay Raghavan, Mojdeh Shakeri, and Krishna Pattipati, Optimal and nearoptimal test sequencing algorithms with realistic test models, IEEE Transactions\non systems, man, and cybernetics-part A: Systems and Humans 29 (1999), no. 1,\n11–26.\n[155] Vijay Raghavan, Mojdeh Shakeri, and Krishna R Pattipati, Test sequencing\nproblems arising in test planning and design for testability, IEEE Transactions\non Systems, Man, and Cybernetics-Part A: Systems and Humans 29 (1999),\nno. 2, 153–163.\n[156] Vijaya Raghavan, Mojdeh Shakeri, and Krishna Pattipati, Test sequencing\nalgorithms with unreliable tests, IEEE Transactions on Systems, Man, and\nCybernetics-Part A: Systems and Humans 29 (1999), no. 4, 347–357.\n[157] Nageswara SV Rao, On parallel algorithms for single-fault diagnosis in fault\npropagation graph systems, IEEE Transactions on Parallel and Distributed\nSystems 7 (1996), no. 12, 1217–1223.\n[158] Raymond Reiter, A theory of diagnosis from first principles, Artificial intelligence\n32 (1987), no. 1, 57–95.\n[159] Frank Rijmen, Bayesian networks with a logistic regression model for the conditional probabilities, International Journal of Approximate Reasoning 48 (2008),\nno. 2, 659–666.\n\n221\n\n[160] Peng Rong and Massoud Pedram, An analytical model for predicting the remaining battery capacity of lithium-ion batteries, IEEE Transactions on Very Large\nScale Integration (VLSI) Systems 14 (2006), no. 5, 441–451.\n[161] Sui Ruan, Fang Tu, Krishna R Pattipati, and Ann Patterson-Hine, On a\nmultimode test sequencing problem, IEEE Transactions on Systems, Man, and\nCybernetics, Part B (Cybernetics) 34 (2004), no. 3, 1490–1499.\n[162] Bhaskar Saha, Kai Goebel, Scott Poll, and Jon Christophersen, Prognostics methods for battery health monitoring using a bayesian framework, IEEE Transactions\non Instrumentation and Measurement 58 (2009), no. 2, 291–296.\n[163] Meera Sampath, Raja Sengupta, Stéphane Lafortune, Kasim Sinnamohideen,\nand Demosthenis Teneketzis, Diagnosability of discrete-event systems, IEEE\nTransactions on automatic control 40 (1995), no. 9, 1555–1575.\n[164] Meera Sampath, Raja Sengupta, Stephane Lafortune, Kasim Sinnamohideen,\nand Demosthenis C Teneketzis, Failure diagnosis using discrete-event models,\nIEEE transactions on control systems technology 4 (1996), no. 2, 105–124.\n[165] FRED C Schweppe and EDMUND J Handschin, Static state estimation in\nelectric power systems, Proceedings of the IEEE 62 (1974), no. 7, 972–982.\n[166] Fred C Schweppe and Edmund J Handschin, Static state estimation in electric\npower systems, Proceedings of the IEEE 62 (1974), no. 7, 972–982.\n[167] Mojdeh Shakeri, Vijaya Raghavan, Krishna R Pattipati, and Ann PattersonHine, Optimal and near-optimal algorithms for multiple fault diagnosis with\n\n222\n\nunreliable tests, IEEE Transactions on Systems, Man, and Cybernetics, Part C\n(Applications and Reviews) 28 (1998), no. 3, 431–440.\n[168]\n\n, Sequential testing algorithms for multiple fault diagnosis, IEEE Transactions on Systems, Man, and Cybernetics-Part A: Systems and Humans 30\n(2000), no. 1, 1–14.\n\n[169] Michael A Shwe, Blackford Middleton, DE Heckerman, Max Henrion, EJ Horvitz,\nHP Lehmann, and GF Cooper, Probabilistic diagnosis using a reformulation\nof the internist-1/qmr knowledge base, Methods of information in Medicine 30\n(1991), no. 4, 241–255.\n[170] Satnam Singh, Anuradha Kodali, Kihoon Choi, Krishna R Pattipati, Setu Madhavi Namburu, Shunsuke Chigusa Sean, Danil V Prokhorov, and Liu Qiao,\nDynamic multiple fault diagnosis: Mathematical formulations and solution techniques, IEEE Transactions on Systems, Man, and Cybernetics-Part A: Systems\nand Humans 39 (2009), no. 1, 160–176.\n[171] K Sinnamohideen, Discrete-event based diagnostic supervisory control system,\nProceedings of the AIChE Annual Meeting, 1991.\n[172] Padhraic Smyth, Hidden markov models for fault detection in dynamic systems,\nPattern recognition 27 (1994), no. 1, 149–164.\n[173]\n\n, Markov monitoring with unknown states, IEEE Journal on Selected\nAreas in Communications 12 (1994), no. 9, 1600–1612.\n\n[174] Peter Struss and Chris Price, Model-based systems in the automotive industry,\nAI magazine 24 (2003), no. 4, 17.\n223\n\n[175] Suthar, Bharatkumar and Ramadesigan, Venkatasailanathan and De, Sumitava\nand Braatz, Richard D and Subramanian, Venkat R, Optimal charging profiles\nfor mechanically constrained lithium-ion batteries, Physical Chemistry Chemical\nPhysics 16 (2014), no. 1, 277–287.\n[176] Tzyh Jong Tarn and Johnson Zaborszky, A practical nondiverging filter, AIAA\nJournal 8 (1970), no. 6, 1127–1133.\n[177] Sergios Theodoridis, Machine learning: a bayesian and optimization perspective,\nAcademic Press, 2015.\n[178] Louise Travé-Massuyes, Teresa Escobet, and Xavier Olive, Diagnosability analysis based on component-supported analytical redundancy relations, IEEE Transactions on Systems, Man, and Cybernetics-Part A: Systems and Humans 36\n(2006), no. 6, 1146–1160.\n[179] Fang Tu and Krishna R. Pattipati, Rollout strategies for sequential fault diagnosis,\nIEEE Transactions on Systems, Man, and Cybernetics-Part A: Systems and\nHumans 33 (2003), no. 1, 86–99.\n[180] Fang Tu, Krishna R. Pattipati, Somnath Deb, and Venkata Narayana Malepati,\nComputationally efficient algorithms for multiple fault diagnosis in large graphbased systems, IEEE Transactions on Systems, Man, and Cybernetics-Part A:\nSystems and Humans 33 (2003), no. 1, 73–85.\n[181] LH Ungar, BA Powell, and SN Kamens, Adaptive networks for fault diagnosis\nand process control, Computers & Chemical Engineering 14 (1990), no. 4-5,\n561–572.\n\n224\n\n[182] Francis J Vasko and George R Wilson, Using a facility location algorithm to\nsolve large set covering problems, Operations Research Letters 3 (1984), no. 2,\n85–90.\n[183] Venkat Venkatasubramanian, Raghunathan Rengaswamy, Surya N Kavuri, and\nKewen Yin, A review of process fault detection and diagnosis: Part iii: Process\nhistory based methods, Computers & chemical engineering 27 (2003), no. 3,\n327–346.\n[184] Venkat Venkatasubramanian, Raghunathan Rengaswamy, Kewen Yin, and\nSurya N Kavuri, A review of process fault detection and diagnosis: Part i:\nQuantitative model-based methods, Computers & chemical engineering 27 (2003),\nno. 3, 293–311.\n[185] Venkat Venkatsubramanian, A review of process fault detection and diagnosis,\npart ii: Qualitative models and search strategics, Computers and Chemical\nEngineering 27 (2003), no. 3, 313–326.\n[186] EI Verriest and FL Lewis, On the linear quadratic minimum-time problem, IEEE\ntransactions on automatic control 36 (1991), no. 7, 859–863.\n[187] Thanh Tu Vo, Xiaopeng Chen, Weixiang Shen, and Ajay Kapoor, New charging\nstrategy for lithium-ion batteries based on the integration of taguchi method and\nstate of charge estimation, Journal of Power Sources 273 (2015), 413–422.\n[188]\n\n, New charging strategy for lithium-ion batteries based on the integration\nof taguchi method and state of charge estimation, Journal of Power Sources 273\n(2015), 413–422.\n\n225\n\n[189] Sholom M Weiss and Ioannis Kapouleas, An empirical comparison of pattern\nrecognition, neural nets and machine learning classification methods, Readings\nin machine learning (1990), 177–183.\n[190] JOHNE White and JASONL Speyer, Detection filter design: Spectral theory and\nalgorithms, IEEE Transactions on Automatic Control 32 (1987), no. 7, 593–603.\n[191] A. S. Willsky, A survey of design methods for failure detection in dynamic\nsystems, Automatica 12 (Nov. 1976), no. 6, 601–611.\n[192] Alan Willsky and H Jones, A generalized likelihood ratio approach to the detection\nand estimation of jumps in linear systems, IEEE Transactions on Automatic\ncontrol 21 (1976), no. 1, 108–112.\n[193]\n\n, A generalized likelihood ratio approach to the detection and estimation\nof jumps in linear systems, IEEE Transactions on Automatic control 21 (1976),\nno. 1, 108–112.\n\n[194] Alan S Willsky, A survey of design methods for failure detection in dynamic\nsystems, Automatica 12 (1976), no. 6, 601–611.\n[195] Alan S Willsky, JJ Deyst, and BS Crawford, Two self-test methods applied to an\ninertial system problem, Journal of Spacecraft and Rockets 12 (1975), 434–437.\n[196] Randy Ben Wright, Chester George Motloch, Jeffrey R Belt, Jon Petter Christophersen, Chinh Dac Ho, Roger Allen Richardson, I Bloom, SA Jones, Vincent S\nBattaglia, GL Henriksen, et al., Calendar-and cycle-life studies of advanced\ntechnology development program generation 1 lithium-ion batteries, Journal of\npower sources 110 (2002), no. 2, 445–470.\n226\n\n[197] Thomas D Wu, A problem decomposition method for efficient diagnosis and interpretation of multiple disorders, Computer methods and programs in biomedicine\n35 (1991), no. 4, 239–250.\n[198] Jingyu Yan, Guoqing Xu, Huihuan Qian, Yangsheng Xu, and Zhibin Song,\nModel predictive control-based fast charging for vehicular batteries, Energies 4\n(2011), no. 8, 1178–1196.\n[199] M Yildiz, H Karakoc, and I Dincer, Modeling and validation of temperature\nchanges in a pouch lithium-ion battery at various discharge rates, International\nCommunications in Heat and Mass Transfer 75 (2016), 311–314.\n[200] Feili Yu, Fang Tu, Haiying Tu, and Krishna R Pattipati, A lagrangian relaxation\nalgorithm for finding the map configuration in qmr-dt, IEEE Transactions on\nSystems, Man, and Cybernetics-Part A: Systems and Humans 37 (2007), no. 5,\n746–757.\n[201] Jingliang Zhang and Jay Lee, A review on prognostics and health monitoring of\nli-ion battery, Journal of Power Sources 196 (2011), no. 15, 6007–6014.\n[202] Jixiao Zhang, Jingxian Yu, Chuansin Cha, and Hanxi Yang, The effects of pulse\ncharging on inner pressure and cycling characteristics of sealed ni/mh batteries,\nJournal of power sources 136 (2004), no. 1, 180–185.\n[203] P Zhang and SX Ding, On fault detection in linear discrete-time, periodic, and\nsampled-data systems, Journal of control science and engineering 2008 (2008),\n8.\n\n227\n\n[204] Shigang Zhang, Krishna R Pattipati, Zheng Hu, Xisen Wen, and Chaitanya\nSankavaram, Dynamic coupled fault diagnosis with propagation and observation\ndelays, IEEE Transactions on Systems, Man, and Cybernetics: Systems 43\n(2013), no. 6, 1424–1439.\n[205] Zhang, D and Haran, BS and Durairajan, A and White, Ralph E and Podrazhansky, Y and Popov, Branko N, Studies on capacity fade of lithium-ion batteries,\nJournal of Power Sources 91 (2000), no. 2, 122–129.\n[206] Huiming Zou, Wei Wang, Guiying Zhang, Fei Qin, Changqing Tian, and Yuying\nYan, Experimental investigation on an integrated thermal management system with heat pipe heat exchanger for electric vehicle, Energy Conversion and\nManagement 118 (2016), 88–95.\n\n228\n\n","pages":{"startPosition":[0,5001,10000,14994,20000,24999,29987,34997,39999,44997,49996,55001,59985,65000,69999,74993,79993,84998,89987,95000,99999,104993,110000,114997,119994,125001,129993,135000,140001,144994,150001,154995,159992,165001,169989,174992,179992,184991,190000,195000,200000,205000,209992,214997,219985,225000,230000,234999,240001,244990,249999,255000,259998,264989,269991,274995]}},"html":{"comparison":{"identical":{"groupId":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77],"source":{"chars":{"starts":[3677845,3677862,3677870,3677887,3677895,3677912,3677920,3677937,3677945,3677962,3677970,3677987,3677995,3678012,3678020,3678037,3678045,3678062,3678070,3678087,3678095,3678112,3678120,3678137,3678145,3678162,3678170,3678187,3678195,3678212,3678220,3678237,3678245,3678262,3678270,3678287,3678295,3678312,3678320,3678337,3678345,3678362,3678370,3678387,3678395,3680867,3680884,3680892,3680909,3680917,3680934,3680942,3680959,3680967,3680984,3680992,3681009,3681017,3681034,3681042,3681059,3681067,3681084,3681092,3681109,3681117,3681134,3681142,3683779,3683796,3683804,3683821,3683829,3683846,3683854,3683871,3683879,3683896,3683904,3683921,3683929,3683946,3683954,3683971,3683979,3683996,3684004,3684021,3684029,3684046,3684054,3684071,3684079,3684096,3684104,3684121,3684129,3684840,3684857,3684865,3684882,3684890,3684907,3684915,3684932,3684940,3684957,3684965,3684982,3684990,3685007,3685015,3685032,3685040,3685057,3685065,3685082,3685090,3685107,3685115,3685132,3685140,3685157,3685165,3685182,3685190,3685215,3685232,3685240,3685257,3685265,3685282,3685290,3685307,3685315,3685332,3685340,3685357,3685365,3685382,3685390,3685407,3685415,3685432,3685440,3685457,3685465,3685482,3685490,3685507,3685515,3685532,3685540,3685557,3685565,3685829,3685846,3685854,3685871,3685879,3685896,3685904,3685921,3685929,3685946,3685954,3685971,3685979,3685996,3686004,3686021,3686029,3686046,3686054,3686071,3686079,3686096,3686104,3686121,3686129,3686146,3686154,3686171,3686179,3686694,3686711,3686719,3686736,3686744,3686761,3686769,3686786,3686794,3686811,3686819,3686836,3686844,3686861,3686869,3686886,3686894,3686911,3686919,3686936,3686944,3686961,3686969,3686986,3686994,3687011,3687019,3687036,3687044,3687069,3687086,3687094,3687111,3687119,3687136,3687144,3687161,3687169,3687186,3687194,3687211,3687219,3687236,3687244,3687261,3687269,3687286,3687294,3687311,3687319,3687336,3687344,3688319,3688336,3688344,3688361,3688369,3688386,3688394,3688411,3688419,3688436,3688444,3688461,3688469,3688486,3688494,3688511,3688519,3688536,3688544,3688561,3688569,3688586,3688594,3688611,3688619,3688636,3688644,3689874,3689891,3689899,3689916,3689924,3689941,3689949,3689966,3689974,3689991,3689999,3690016,3690024,3690041,3690049,3690066,3690074,3690091,3690099,3690116,3690124,3690141,3690149,3690166,3690174,3690191,3690199,3690216,3690224,3690241,3690249,3690266,3690274,3691980,3691997,3692005,3692022,3692030,3692047,3692055,3692072,3692080,3692097,3692105,3692122,3692130,3692147,3692155,3692172,3692180,3692197,3692205,3692222,3692230,3692247,3692255,3692647,3692664,3692672,3692689,3692697,3692714,3692722,3692739,3692747,3692764,3692772,3692789,3692797,3692814,3692822,3692839,3692847,3692864,3692872,3692889,3692897,3692914,3692922,3693697,3693714,3693722,3693739,3693747,3693764,3693772,3693789,3693797,3693814,3693822,3693839,3693847,3693864,3693872,3693889,3693897,3693914,3693922,3693939,3693947,3693964,3693972,3693989,3693997,3694014,3694022,3694039,3694047,3694072,3694089,3694097,3694114,3694122,3694139,3694147,3694164,3694172,3694189,3694197,3694214,3694222,3694239,3694247,3694264,3694272,3694289,3694297,3694314,3694322,3694339,3694347,3694364,3694372,3694389,3694397,3694878,3694895,3694903,3694920,3694928,3694945,3694953,3694970,3694978,3694995,3695003,3695020,3695028,3695045,3695053,3695070,3695078,3695095,3695103,3695120,3695128,3695145,3695153,3695509,3695526,3695534,3695551,3695559,3695576,3695584,3695601,3695609,3695626,3695634,3695651,3695659,3695676,3695684,3695701,3695709,3695726,3695734,3695751,3695759,3695776,3695784,3695801,3695809,3695826,3695834,3695851,3695859,3695876,3695884,3695901,3695909,3695926,3695934,3698928,3698945,3698953,3698970,3698978,3698995,3699003,3699020,3699028,3699045,3699053,3699070,3699078,3699095,3699103,3699120,3699128,3699145,3699153,3699170,3699178,3699195,3699203,3699220,3699228,3699245,3699253,3699270,3699278,3699295,3699303,3699320,3699328,3699345,3699353,3699370,3699378,3699395,3699403,3711844,3711861,3711869,3711886,3711894,3711911,3711919,3711936,3711944,3711961,3711969,3711986,3711994,3712011,3712019,3712036,3712044,3712061,3712069,3712086,3712094,3712111,3712119,3712136,3712144,3712161,3712169,3712186,3712194,3712449,3712466,3712474,3712491,3712499,3712516,3712524,3712541,3712549,3712566,3712574,3712591,3712599,3712616,3712624,3712641,3712649,3712666,3712674,3712691,3712699,3712716,3712724,3712741,3712749,3712766,3712774,3712791,3712799,3712824,3712841,3712849,3712866,3712874,3712891,3712899,3712916,3712924,3712941,3712949,3712966,3712974,3712991,3712999,3713016,3713024,3713041,3713049,3713066,3713074,3713091,3713099,3713116,3713124,3713141,3713149,3713166,3713174,3713191,3713199,3713601,3713618,3713626,3713643,3713651,3713668,3713676,3713693,3713701,3713718,3713726,3713743,3713751,3713768,3713776,3713793,3713801,3713818,3713826,3713843,3713851,3713868,3713876,3713893,3713901,3714469,3714486,3714494,3714511,3714519,3714536,3714544,3714561,3714569,3714586,3714594,3714611,3714619,3714636,3714644,3714661,3714669,3714686,3714694,3714711,3714719,3714736,3714744,3714769,3714786,3714794,3714811,3714819,3714836,3714844,3714861,3714869,3714886,3714894,3714911,3714919,3714936,3714944,3714961,3714969,3714986,3714994,3715011,3715019,3715036,3715044,3715061,3715069,3715086,3715094,3715111,3715119,3715136,3715144,3715161,3715169,3716229,3716246,3716254,3716271,3716279,3716296,3716304,3716321,3716329,3716346,3716354,3716371,3716379,3716396,3716404,3716421,3716429,3716446,3716454,3716471,3716479,3716496,3716504,3716521,3716529,3716546,3716554,3716571,3716579,3716596,3716604,3716621,3716629,3716646,3716654,3716671,3716679,3716696,3716704,3717086,3717103,3717111,3717128,3717136,3717153,3717161,3717178,3717186,3717203,3717211,3717228,3717236,3717253,3717261,3717278,3717286,3717303,3717311,3717328,3717336,3717353,3717361,3717378,3717386,3717403,3717411,3717428,3717436,3717453,3717461,3717835,3717852,3717860,3717877,3717885,3717902,3717910,3717927,3717935,3717952,3717960,3717977,3717985,3718002,3718010,3718027,3718035,3718052,3718060,3718077,3718085,3718102,3718110,3718127,3718135,3718152,3718160,3718177,3718185,3718202,3718210,3719062,3719079,3719087,3719104,3719112,3719129,3719137,3719154,3719162,3719179,3719187,3719204,3719212,3719229,3719237,3719254,3719262,3719279,3719287,3719304,3719312,3719329,3719337,3719354,3719362,3719379,3719387,3719404,3719412,3719437,3719454,3719462,3719479,3719487,3719504,3719512,3719529,3719537,3719554,3719562,3719579,3719587,3719604,3719612,3719629,3719637,3719654,3719662,3719679,3719687,3719704,3719712,3720534,3720551,3720559,3720576,3720584,3720601,3720609,3720626,3720634,3720651,3720659,3720676,3720684,3720701,3720709,3720726,3720734,3720751,3720759,3720776,3720784,3720801,3720809,3720826,3720834,3720851,3720859,3720876,3720884,3720901,3720909,3720926,3720934,3720951,3720959,3720976,3720984,3723212,3723229,3723237,3723254,3723262,3723279,3723287,3723304,3723312,3723329,3723337,3723354,3723362,3723379,3723387,3723404,3723412,3723429,3723437,3723454,3723462,3723479,3723487,3723504,3723512,3723529,3723537,3723554,3723562,3724098,3724115,3724123,3724140,3724148,3724165,3724173,3724190,3724198,3724215,3724223,3724240,3724248,3724265,3724273,3724290,3724298,3724315,3724323,3724340,3724348,3724365,3724373,3724390,3724398,3724415,3724423,3724440,3724448,3724473,3724490,3724498,3724515,3724523,3724540,3724548,3724565,3724573,3724590,3724598,3724615,3724623,3724640,3724648,3724665,3724673,3724690,3724698,3724715,3724723,3724740,3724748,3724765,3724773,3725121,3725138,3725146,3725163,3725171,3725188,3725196,3725213,3725221,3725238,3725246,3725263,3725271,3725288,3725296,3725313,3725321,3725338,3725346,3725363,3725371,3725388,3725396,3725667,3725684,3725692,3725709,3725717,3725734,3725742,3725759,3725767,3725784,3725792,3725809,3725817,3725834,3725842,3725859,3725867,3725884,3725892,3725909,3725917,3725934,3725942,3725959,3725967,3725984,3725992,3726009,3726017,3726034,3726042,3726059,3726067,3726084,3726092,3726109,3726117,3726134,3726142,3726159,3726167,3726184,3726192,3727475,3727492,3727500,3727517,3727525,3727542,3727550,3727567,3727575,3727592,3727600,3727617,3727625,3727642,3727650,3727667,3727675,3727692,3727700,3727717,3727725,3727742,3727750,3727767,3727775,3727792,3727800,3727817,3727825,3727842,3727850,3727867,3727875,3727892,3727900,3728165,3728182,3728190,3728207,3728215,3728232,3728240,3728257,3728265,3728282,3728290,3728307,3728315,3728332,3728340,3728357,3728365,3728382,3728390,3728407,3728415,3728432,3728440,3728465,3728482,3728490,3728507,3728515,3728532,3728540,3728557,3728565,3728582,3728590,3728607,3728615,3728632,3728640,3728657,3728665,3728682,3728690,3728707,3728715,3728732,3728740,3728757,3728765,3729039,3729056,3729064,3729081,3729089,3729106,3729114,3729131,3729139,3729156,3729164,3729181,3729189,3729206,3729214,3729231,3729239,3729256,3729264,3729281,3729289,3729306,3729314,3729331,3729339,3729356,3729364,3729381,3729389,3729406,3729414,3729431,3729439,3729456,3729464,3729481,3729489,3729506,3729514,3729531,3729539,3731122,3731139,3731147,3731164,3731172,3731189,3731197,3731214,3731222,3731239,3731247,3731264,3731272,3731289,3731297,3731314,3731322,3731339,3731347,3731364,3731372,3731389,3731397,3731414,3731422,3731439,3731447,3731464,3731472,3732962,3732979,3732987,3733004,3733012,3733029,3733037,3733054,3733062,3733079,3733087,3733104,3733112,3733129,3733137,3733154,3733162,3733179,3733187,3733204,3733212,3733229,3733237,3733254,3733262,3733279,3733287,3733304,3733312,3733329,3733337,3733759,3733776,3733784,3733801,3733809,3733826,3733834,3733851,3733859,3733876,3733884,3733901,3733909,3733926,3733934,3733951,3733959,3733976,3733984,3734001,3734009,3734026,3734034,3734450,3734467,3734475,3734492,3734500,3734517,3734525,3734542,3734550,3734567,3734575,3734592,3734600,3734617,3734625,3734642,3734650,3734667,3734675,3734692,3734700,3734717,3734725,3734742,3734750,3734767,3734775,3735215,3735232,3735240,3735257,3735265,3735282,3735290,3735307,3735315,3735332,3735340,3735357,3735365,3735382,3735390,3735407,3735415,3735432,3735440,3735457,3735465,3735482,3735490,3735507,3735515,3735532,3735540,3735557,3735565,3735582,3735590,3736690,3736707,3736715,3736732,3736740,3736757,3736765,3736782,3736790,3736807,3736815,3736832,3736840,3736857,3736865,3736882,3736890,3736907,3736915,3736932,3736940,3736957,3736965,3736982,3736990,3737007,3737015,3737032,3737040,3737057,3737065,3737082,3737090,3737445,3737462,3737470,3737487,3737495,3737512,3737520,3737537,3737545,3737562,3737570,3737587,3737595,3737612,3737620,3737637,3737645,3737662,3737670,3737687,3737695,3737712,3737720,3737737,3737745,3737762,3737770,3737787,3737795,3737812,3737820,3737837,3737845,3737862,3737870,3738238,3738255,3738263,3738280,3738288,3738305,3738313,3738330,3738338,3738355,3738363,3738380,3738388,3738405,3738413,3738430,3738438,3738455,3738463,3738480,3738488,3738505,3738513,3738530,3738538,3738555,3738563,3740025,3740042,3740050,3740067,3740075,3740092,3740100,3740117,3740125,3740142,3740150,3740167,3740175,3740192,3740200,3740217,3740225,3740242,3740250,3740267,3740275,3740292,3740300,3740317,3740325,3752761,3752778,3752786,3752803,3752811,3752828,3752836,3752853,3752861,3752878,3752886,3752903,3752911,3752928,3752936,3752953,3752961,3752978,3752986,3753003,3753011,3753028,3753036,3753053,3753061,3753078,3753086,3753103,3753111,3753136,3753153,3753161,3753178,3753186,3753203,3753211,3753228,3753236,3753253,3753261,3753278,3753286,3753303,3753311,3753328,3753336,3753353,3753361,3753378,3753386,3753403,3753411,3753428,3753436,3753802,3753819,3753827,3753844,3753852,3753869,3753877,3753894,3753902,3753919,3753927,3753944,3753952,3753969,3753977,3753994,3754002,3754019,3754027,3754044,3754052,3754069,3754077,3754094,3754102,3754119,3754127,3754144,3754152,3754169,3754177,3754407,3754424,3754432,3754449,3754457,3754474,3754482,3754499,3754507,3754524,3754532,3754549,3754557,3754574,3754582,3754599,3754607,3754624,3754632,3754649,3754657,3754674,3754682,3754699,3754707,3754724,3754732,3754749,3754757,3754782,3754799,3754807,3754824,3754832,3754849,3754857,3754874,3754882,3754899,3754907,3754924,3754932,3754949,3754957,3754974,3754982,3754999,3755007,3755024,3755032,3755049,3755057,3755074,3755082,3755099,3755107,3755124,3755132,3755364,3755381,3755389,3755406,3755414,3755431,3755439,3755456,3755464,3755481,3755489,3755506,3755514,3755531,3755539,3755556,3755564,3755581,3755589,3755606,3755614,3755631,3755639,3755664,3755681,3755689,3755706,3755714,3755731,3755739,3755756,3755764,3755781,3755789,3755806,3755814,3755831,3755839,3755856,3755864,3755881,3755889,3755906,3755914,3755931,3755939,3755956,3755964,3755981,3755989,3756006,3756014,3756031,3756039,3756056,3756064,3756330,3756347,3756355,3756372,3756380,3756397,3756405,3756422,3756430,3756447,3756455,3756472,3756480,3756497,3756505,3756522,3756530,3756547,3756555,3756572,3756580,3756597,3756605,3756622,3756630,3756647,3756655,3756672,3756680,3757227,3757244,3757252,3757269,3757277,3757294,3757302,3757319,3757327,3757344,3757352,3757369,3757377,3757394,3757402,3757419,3757427,3757444,3757452,3757469,3757477,3757494,3757502,3758089,3758106,3758114,3758131,3758139,3758156,3758164,3758181,3758189,3758206,3758214,3758231,3758239,3758256,3758264,3758281,3758289,3758306,3758314,3758331,3758339,3758356,3758364,3758778,3758795,3758803,3758820,3758828,3758845,3758853,3758870,3758878,3758895,3758903,3758920,3758928,3758945,3758953,3758970,3758978,3758995,3759003,3759020,3759028,3759045,3759053,3759078,3759095,3759103,3759120,3759128,3759145,3759153,3759170,3759178,3759195,3759203,3759220,3759228,3759245,3759253,3759270,3759278,3759295,3759303,3759320,3759328,3759345,3759353,3760088,3760105,3760113,3760130,3760138,3760155,3760163,3760180,3760188,3760205,3760213,3760230,3760238,3760255,3760263,3760280,3760288,3760305,3760313,3760330,3760338,3760355,3760363,3760380,3760388,3760405,3760413,3760430,3760438,3760702,3760719,3760727,3760744,3760752,3760769,3760777,3760794,3760802,3760819,3760827,3760844,3760852,3760869,3760877,3760894,3760902,3760919,3760927,3760944,3760952,3760969,3760977,3760994,3761002,3761019,3761027,3761044,3761052,3764118,3764135,3764143,3764160,3764168,3764185,3764193,3764210,3764218,3764235,3764243,3764260,3764268,3764285,3764293,3764310,3764318,3764335,3764343,3764360,3764368,3764385,3764393,3764410,3764418,3764435,3764443,3764460,3764468,3764493,3764510,3764518,3764535,3764543,3764560,3764568,3764585,3764593,3764610,3764618,3764635,3764643,3764660,3764668,3764685,3764693,3764710,3764718,3764735,3764743,3764760,3764768,3764785,3764793,3766136,3766153,3766161,3766178,3766186,3766203,3766211,3766228,3766236,3766253,3766261,3766278,3766286,3766303,3766311,3766328,3766336,3766353,3766361,3766378,3766386,3766403,3766411,3766428,3766436,3766453,3766461,3766478,3766486,3766503,3766511,3766719,3766736,3766744,3766761,3766769,3766786,3766794,3766811,3766819,3766836,3766844,3766861,3766869,3766886,3766894,3766911,3766919,3766936,3766944,3766961,3766969,3766986,3766994,3767011,3767019,3767036,3767044,3767061,3767069,3767086,3767094,3767111,3767119,3767144,3767161,3767169,3767186,3767194,3767211,3767219,3767236,3767244,3767261,3767269,3767286,3767294,3767311,3767319,3767336,3767344,3767361,3767369,3767386,3767394,3767414,3767422,3768182,3768199,3768207,3768224,3768232,3768249,3768257,3768274,3768282,3768299,3768307,3768324,3768332,3768349,3768357,3768374,3768382,3768399,3768407,3768424,3768432,3768449,3768457,3769500,3769517,3769525,3769542,3769550,3769567,3769575,3769592,3769600,3769617,3769625,3769642,3769650,3769667,3769675,3769692,3769700,3769717,3769725,3769742,3769750,3769767,3769775,3769792,3769800,3769817,3769825,3771472,3771489,3771497,3771514,3771522,3771539,3771547,3771564,3771572,3771589,3771597,3771614,3771622,3771639,3771647,3771664,3771672,3771689,3771697,3771714,3771722,3771739,3771747,3771764,3771772,3771789,3771797,3771814,3771822,3771839,3771847,3771864,3771872,3771889,3771897,3771914,3771922,3771939,3771947,3771964,3771972,3772280,3772297,3772305,3772322,3772330,3772347,3772355,3772372,3772380,3772397,3772405,3772422,3772430,3772447,3772455,3772472,3772480,3772497,3772505,3772522,3772530,3772547,3772555,3772572,3772580,3772597,3772605,3772622,3772630,3772647,3772655,3772672,3772680,3772697,3772705,3772722,3772730,3773864,3773881,3773889,3773906,3773914,3773931,3773939,3773956,3773964,3773981,3773989,3774006,3774014,3774031,3774039,3774056,3774064,3774081,3774089,3774106,3774114,3774131,3774139,3774156,3774164,3774181,3774189,3774206,3774214,3774239,3774256,3774264,3774281,3774289,3774306,3774314,3774331,3774339,3774356,3774364,3774381,3774389,3774406,3774414,3774431,3774439,3774456,3774464,3774481,3774489,3774506,3774514,3774531,3774539,3774556,3774564,3774581,3774589,3884058,3884088,3884096,3884113,3884121,3884138,3884146,3884163,3884171,3884188,3884196,3884213,3884221,3884238,3884246,3884263,3884271,3884288,3884296,3884313,3884321,3884338,3884346,3884363,3884371,3884388,3884396,3884413,3884421,3884438,3884446,3983852,3983869,3983877,3983894,3983902,3983919,3983927,3983944,3983952,3983969,3983977,3983994,3984002,3984019,3984027,3984044,3984052,3984069,3984077,3984094,3984102,3984123,3984131,4039593,4039618,4039626,4039643,4039651,4039668,4039676,4039693,4039701,4039718,4039726,4039743,4039751,4039768,4039776,4039793,4039801,4039818,4039826,4039843,4039851,4039868,4039876,4039893,4039901,4039918,4039926,4039943,4039951,4039968,4039976,4039993,4040001,4040639,4040663,4040671,4040688,4040696,4040713,4040721,4040738,4040746,4040763,4040771,4040788,4040796,4040813,4040821,4040838,4040846,4040863,4040871,4040888,4040896,4040913,4040921,4040938,4040946,4040963,4040971,4040988,4040996,4041013,4041021,4041038,4041046,4041063,4041071,4041088,4041096,4041113,4041121,4041138,4041146,4041163,4041171,4041188,4041196,4041213,4041221,4041238,4041246,4041263,4041271,4041288,4041296,4041313,4041321,4041338,4041346,4043614,4043639,4043647,4043664,4043672,4043689,4043697,4043714,4043722,4043739,4043747,4043764,4043772,4043789,4043797,4043814,4043822,4043839,4043847,4043864,4043872,4043889,4043897,4043914,4043922,4043939,4043947,4043964,4043972,4043989,4043997,4044014,4044022,4044039,4044047,4044064,4044072,4044089,4044097,4044114,4044122,4044139,4044147,4044164,4044172,4044189,4044197,4044214,4044222,4060845,4060866,4060874,4060891,4060899,4060916,4060924,4060941,4060949,4060966,4060974,4060991,4060999,4061016,4061024,4061041,4061049,4061066,4061074,4061091,4061099,4061116,4061124,4061141,4061149,4061166,4061174,4061191,4061199,4061216,4061224,4061241,4061249,4061266,4061274,4061291,4061299,4061316,4061324,4061341,4061349,4061366,4061374,4061391,4061399,4061416,4061424,4061441,4061449,4061466,4061474],"lengths":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},"words":{"starts":[5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5805,5907,5907,5907,5907,5907,5907,5907,5907,5907,5907,5907,5907,5907,5907,5907,5907,5907,5907,5907,5907,5907,5907,5907,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,5999,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6032,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6047,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6068,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6096,6111,6111,6111,6111,6111,6111,6111,6111,6111,6111,6111,6111,6111,6111,6111,6111,6111,6111,6111,6111,6111,6111,6111,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6150,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6198,6258,6258,6258,6258,6258,6258,6258,6258,6258,6258,6258,6258,6258,6258,6258,6258,6258,6258,6258,6258,6258,6258,6258,6280,6280,6280,6280,6280,6280,6280,6280,6280,6280,6280,6280,6280,6280,6280,6280,6280,6280,6280,6280,6280,6280,6280,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6311,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6326,6353,6353,6353,6353,6353,6353,6353,6353,6353,6353,6353,6353,6353,6353,6353,6353,6353,6353,6353,6353,6353,6353,6353,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6374,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6489,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6537,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6558,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6573,6599,6599,6599,6599,6599,6599,6599,6599,6599,6599,6599,6599,6599,6599,6599,6599,6599,6599,6599,6599,6599,6599,6599,6599,6599,6623,6623,6623,6623,6623,6623,6623,6623,6623,6623,6623,6623,6623,6623,6623,6623,6623,6623,6623,6623,6623,6623,6623,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6635,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6684,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6714,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6740,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6779,6794,6794,6794,6794,6794,6794,6794,6794,6794,6794,6794,6794,6794,6794,6794,6794,6794,6794,6794,6794,6794,6794,6794,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6829,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6914,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6946,6961,6961,6961,6961,6961,6961,6961,6961,6961,6961,6961,6961,6961,6961,6961,6961,6961,6961,6961,6961,6961,6961,6961,6961,6961,6982,6982,6982,6982,6982,6982,6982,6982,6982,6982,6982,6982,6982,6982,6982,6982,6982,6982,6982,6982,6982,6982,6982,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7000,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7064,7088,7088,7088,7088,7088,7088,7088,7088,7088,7088,7088,7088,7088,7088,7088,7088,7088,7088,7088,7088,7088,7088,7088,7100,7100,7100,7100,7100,7100,7100,7100,7100,7100,7100,7100,7100,7100,7100,7100,7100,7100,7100,7100,7100,7100,7100,7100,7100,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7119,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7188,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7247,7274,7274,7274,7274,7274,7274,7274,7274,7274,7274,7274,7274,7274,7274,7274,7274,7274,7274,7274,7274,7274,7274,7274,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7297,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7323,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7373,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7399,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7426,7479,7479,7479,7479,7479,7479,7479,7479,7479,7479,7479,7479,7479,7479,7479,7479,7479,7479,7479,7479,7479,7479,7479,7479,7479,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7524,7539,7539,7539,7539,7539,7539,7539,7539,7539,7539,7539,7539,7539,7539,7539,7539,7539,7539,7539,7539,7539,7539,7539,7539,7539,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7561,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7582,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7597,7617,7617,7617,7617,7617,7617,7617,7617,7617,7617,7617,7617,7617,7617,7617,7617,7617,7617,7617,7617,7617,7617,7617,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7629,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7684,7684,7684,7684,7684,7684,7684,7684,7684,7684,7684,7684,7684,7684,7684,7684,7684,7684,7684,7684,7684,7684,7684,7714,7714,7714,7714,7714,7714,7714,7714,7714,7714,7714,7714,7714,7714,7714,7714,7714,7714,7714,7714,7714,7714,7714,7738,7738,7738,7738,7738,7738,7738,7738,7738,7738,7738,7738,7738,7738,7738,7738,7738,7738,7738,7738,7738,7738,7738,7750,7750,7750,7750,7750,7750,7750,7750,7750,7750,7750,7750,7750,7750,7750,7750,7750,7750,7750,7750,7750,7750,7750,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7778,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7799,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7908,7923,7923,7923,7923,7923,7923,7923,7923,7923,7923,7923,7923,7923,7923,7923,7923,7923,7923,7923,7923,7923,7923,7923,7923,7923,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,7982,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8002,8019,8019,8019,8019,8019,8019,8019,8019,8019,8019,8019,8019,8019,8019,8019,8019,8019,8019,8019,8019,8019,8019,8019,8051,8051,8051,8051,8051,8051,8051,8051,8051,8051,8051,8051,8051,8051,8051,8051,8051,8051,8051,8051,8051,8051,8051,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8094,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8155,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8183,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8240,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,8255,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,10610,12607,12607,12607,12607,12607,12607,12607,12607,12607,12607,12607,12607,12607,12607,12607,12607,12607,12607,12607,12607,12607,12607,12607,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14148,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14186,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14276,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448,14448],"lengths":[22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25]}},"suspected":{"chars":{"starts":[5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5339,5535,5535,5535,5535,5535,5535,5535,5535,5535,5535,5535,5535,5535,5535,5535,5535,5535,5535,5535,5535,5535,5535,5535,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5695,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,5843,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6063,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6211,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6350,6494,6494,6494,6494,6494,6494,6494,6494,6494,6494,6494,6494,6494,6494,6494,6494,6494,6494,6494,6494,6494,6494,6494,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6850,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,6934,7069,7069,7069,7069,7069,7069,7069,7069,7069,7069,7069,7069,7069,7069,7069,7069,7069,7069,7069,7069,7069,7069,7069,7172,7172,7172,7172,7172,7172,7172,7172,7172,7172,7172,7172,7172,7172,7172,7172,7172,7172,7172,7172,7172,7172,7172,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7317,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7389,7425,7425,7425,7425,7425,7425,7425,7425,7425,7425,7425,7425,7425,7425,7425,7425,7425,7425,7425,7425,7425,7425,7425,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,7455,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8170,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8484,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8622,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8694,8766,8766,8766,8766,8766,8766,8766,8766,8766,8766,8766,8766,8766,8766,8766,8766,8766,8766,8766,8766,8766,8766,8766,8766,8766,8796,8796,8796,8796,8796,8796,8796,8796,8796,8796,8796,8796,8796,8796,8796,8796,8796,8796,8796,8796,8796,8796,8796,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8868,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,8940,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9026,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9104,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9182,9326,9326,9326,9326,9326,9326,9326,9326,9326,9326,9326,9326,9326,9326,9326,9326,9326,9326,9326,9326,9326,9326,9326,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9476,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9550,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9629,9859,9859,9859,9859,9859,9859,9859,9859,9859,9859,9859,9859,9859,9859,9859,9859,9859,9859,9859,9859,9859,9859,9859,9859,9859,9889,9889,9889,9889,9889,9889,9889,9889,9889,9889,9889,9889,9889,9889,9889,9889,9889,9889,9889,9889,9889,9889,9889,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,9927,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10108,10261,10261,10261,10261,10261,10261,10261,10261,10261,10261,10261,10261,10261,10261,10261,10261,10261,10261,10261,10261,10261,10261,10261,10686,10686,10686,10686,10686,10686,10686,10686,10686,10686,10686,10686,10686,10686,10686,10686,10686,10686,10686,10686,10686,10686,10686,10686,10686,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10835,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,10980,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11110,11612,11612,11612,11612,11612,11612,11612,11612,11612,11612,11612,11612,11612,11612,11612,11612,11612,11612,11612,11612,11612,11612,11612,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,11696,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12170,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12293,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12378,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,12608,13081,13081,13081,13081,13081,13081,13081,13081,13081,13081,13081,13081,13081,13081,13081,13081,13081,13081,13081,13081,13081,13081,13081,13081,13081,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13167,13350,13350,13350,13350,13350,13350,13350,13350,13350,13350,13350,13350,13350,13350,13350,13350,13350,13350,13350,13350,13350,13350,13350,13350,13350,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13747,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13826,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,13984,14248,14248,14248,14248,14248,14248,14248,14248,14248,14248,14248,14248,14248,14248,14248,14248,14248,14248,14248,14248,14248,14248,14248,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14650,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,14742,15080,15080,15080,15080,15080,15080,15080,15080,15080,15080,15080,15080,15080,15080,15080,15080,15080,15080,15080,15080,15080,15080,15080,15239,15239,15239,15239,15239,15239,15239,15239,15239,15239,15239,15239,15239,15239,15239,15239,15239,15239,15239,15239,15239,15239,15239,15398,15398,15398,15398,15398,15398,15398,15398,15398,15398,15398,15398,15398,15398,15398,15398,15398,15398,15398,15398,15398,15398,15398,15557,15557,15557,15557,15557,15557,15557,15557,15557,15557,15557,15557,15557,15557,15557,15557,15557,15557,15557,15557,15557,15557,15557,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16336,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,16954,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17270,17428,17428,17428,17428,17428,17428,17428,17428,17428,17428,17428,17428,17428,17428,17428,17428,17428,17428,17428,17428,17428,17428,17428,17428,17428,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18300,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,18771,16698,16698,16698,16698,16698,16698,16698,16698,16698,16698,16698,16698,16698,16698,16698,16698,16698,16698,16698,16698,16698,16698,16698,18930,18930,18930,18930,18930,18930,18930,18930,18930,18930,18930,18930,18930,18930,18930,18930,18930,18930,18930,18930,18930,18930,18930,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19089,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19253,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19412,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,19889,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,20241,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,18094,13449,13449,13449,13449,13449,13449,13449,13449,13449,13449,13449,13449,13449,13449,13449,13449,13449,13449,13449,13449,13449,13449,13449,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,8038,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,6609,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,7734,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604,18604],"lengths":[45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55]},"words":{"starts":[777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,777,855,855,855,855,855,855,855,855,855,855,855,855,855,855,855,855,855,855,855,855,855,855,855,908,908,908,908,908,908,908,908,908,908,908,908,908,908,908,908,908,908,908,908,908,908,908,908,908,908,908,908,908,969,969,969,969,969,969,969,969,969,969,969,969,969,969,969,969,969,969,969,969,969,969,969,969,969,969,969,969,969,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1038,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1099,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1145,1197,1197,1197,1197,1197,1197,1197,1197,1197,1197,1197,1197,1197,1197,1197,1197,1197,1197,1197,1197,1197,1197,1197,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1292,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1330,1378,1378,1378,1378,1378,1378,1378,1378,1378,1378,1378,1378,1378,1378,1378,1378,1378,1378,1378,1378,1378,1378,1378,1413,1413,1413,1413,1413,1413,1413,1413,1413,1413,1413,1413,1413,1413,1413,1413,1413,1413,1413,1413,1413,1413,1413,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1464,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1494,1509,1509,1509,1509,1509,1509,1509,1509,1509,1509,1509,1509,1509,1509,1509,1509,1509,1509,1509,1509,1509,1509,1509,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1524,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1784,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1885,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1922,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1952,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2027,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2057,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2094,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2127,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2160,2211,2211,2211,2211,2211,2211,2211,2211,2211,2211,2211,2211,2211,2211,2211,2211,2211,2211,2211,2211,2211,2211,2211,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2258,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2282,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2308,2374,2374,2374,2374,2374,2374,2374,2374,2374,2374,2374,2374,2374,2374,2374,2374,2374,2374,2374,2374,2374,2374,2374,2374,2374,2389,2389,2389,2389,2389,2389,2389,2389,2389,2389,2389,2389,2389,2389,2389,2389,2389,2389,2389,2389,2389,2389,2389,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2404,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2462,2509,2509,2509,2509,2509,2509,2509,2509,2509,2509,2509,2509,2509,2509,2509,2509,2509,2509,2509,2509,2509,2509,2509,2635,2635,2635,2635,2635,2635,2635,2635,2635,2635,2635,2635,2635,2635,2635,2635,2635,2635,2635,2635,2635,2635,2635,2635,2635,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2678,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2725,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2771,2883,2883,2883,2883,2883,2883,2883,2883,2883,2883,2883,2883,2883,2883,2883,2883,2883,2883,2883,2883,2883,2883,2883,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,2904,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3022,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3065,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3091,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3163,3269,3269,3269,3269,3269,3269,3269,3269,3269,3269,3269,3269,3269,3269,3269,3269,3269,3269,3269,3269,3269,3269,3269,3269,3269,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3295,3345,3345,3345,3345,3345,3345,3345,3345,3345,3345,3345,3345,3345,3345,3345,3345,3345,3345,3345,3345,3345,3345,3345,3345,3345,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3447,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3476,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3523,3590,3590,3590,3590,3590,3590,3590,3590,3590,3590,3590,3590,3590,3590,3590,3590,3590,3590,3590,3590,3590,3590,3590,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3681,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3707,3794,3794,3794,3794,3794,3794,3794,3794,3794,3794,3794,3794,3794,3794,3794,3794,3794,3794,3794,3794,3794,3794,3794,3832,3832,3832,3832,3832,3832,3832,3832,3832,3832,3832,3832,3832,3832,3832,3832,3832,3832,3832,3832,3832,3832,3832,3870,3870,3870,3870,3870,3870,3870,3870,3870,3870,3870,3870,3870,3870,3870,3870,3870,3870,3870,3870,3870,3870,3870,3908,3908,3908,3908,3908,3908,3908,3908,3908,3908,3908,3908,3908,3908,3908,3908,3908,3908,3908,3908,3908,3908,3908,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4092,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4249,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4347,4397,4397,4397,4397,4397,4397,4397,4397,4397,4397,4397,4397,4397,4397,4397,4397,4397,4397,4397,4397,4397,4397,4397,4397,4397,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4653,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4783,4180,4180,4180,4180,4180,4180,4180,4180,4180,4180,4180,4180,4180,4180,4180,4180,4180,4180,4180,4180,4180,4180,4180,4831,4831,4831,4831,4831,4831,4831,4831,4831,4831,4831,4831,4831,4831,4831,4831,4831,4831,4831,4831,4831,4831,4831,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4879,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4928,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,4976,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5120,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,5213,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,4590,3369,3369,3369,3369,3369,3369,3369,3369,3369,3369,3369,3369,3369,3369,3369,3369,3369,3369,3369,3369,3369,3369,3369,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1744,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1226,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,1625,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733,4733],"lengths":[22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25]}}},"minorChanges":{"groupId":[78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81],"source":{"chars":{"starts":[3764886,3764911,3764919,3764956,3764964,3764996,3765004,3765021,3765029,3765046,3765054,3765071,3765079,3765096,3765104,3765121,3765129,3765146,3765154,3765171,3765179,3765196,3765204,3765221,3765229,3765246,3765254,3765271,3765279,3765296,3765304,3765321,3765329,3765346,3765354,3765371,3765379,3765396,3765404,3765421,3765429,3765446,3765454,3765471,3765479,3765496,3765504,3765521,3765529,3765546,3765554,3765571,3765579,3765596,3765604,3765621,3765629,3765649,3765657,3878820,3878843,3878851,3878876,3878884,3878915,3878923,3878945,3878953,3878976,3878984,3879014,3879022,3879039,3879047,3879064,3879072,3879089,3879097,3879114,3879122,3879139,3879147,3879164,3879172,3879189,3879197,3879214,3879222,3879239,3879247,3879264,3879272,3879289,3879297,3879314,3879322,3879339,3879347,3879364,3879372,3879389,3879397,3879414,3879422,3879439,3879447,3879464,3879472,3879489,3879497,3879514,3879522,3879539,3879547,3879564,3879572,3879589,3879597,3879614,3879622,3879639,3879647,3879664,3879672,3879692,3879700,4046168,4046196,4046204,4046311,4046334,4046342,4046374,4046382,4046410,4046418,4046439,4046447,4046464,4046472,4046489,4046497,4046514,4046522,4046539,4046547,4046564,4046572,4046589,4046597,4046614,4046622,4046639,4046647,4046664,4046672,4046689,4046697,4046714,4046722,4046739,4046747,4046764,4046772,4046789,4046797,4046814,4046822,4046839,4046847,4046864,4046872,4046889,4046897,4046914,4046922,4046939,4046947,4046964,4046972,4046989,4046997,4047014,4047022,4047039,4047047,4047064,4047072,4047089,4047097,4047114,4047122,4047139,4047147,4047164,4047172,4047189,4047197,4047214,4047222,4047242,4047250,4059707,4059730,4059738,4059770,4059778,4059805,4059813,4059837,4059845,4059862,4059870,4059887,4059895,4059912,4059920,4059937,4059945,4059962,4059970,4059987,4059995,4060012,4060020,4060037,4060045,4060062,4060070,4060087,4060095,4060112,4060120,4060137,4060145,4060162,4060170,4060187,4060195,4060212,4060220,4060237,4060245,4060262,4060270,4060287,4060295,4060312,4060320,4060337,4060345,4060362,4060370,4060387,4060395,4060412,4060420,4060437,4060445,4060462,4060470,4060487,4060495,4060512,4060520,4060537,4060545,4060562,4060570,4060587,4060595,4060612,4060620,4060637,4060645,4060665,4060673],"lengths":[5,1,17,1,12,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,1,5,1,11,1,2,1,3,1,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,12,1,45,4,1,12,1,8,1,5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,4,1,12,1,7,1,5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3]},"words":{"starts":[7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,7937,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,10426,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14368,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407,14407],"lengths":[29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37]}},"suspected":{"chars":{"starts":[17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,17900,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7652,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7798,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936,7936],"lengths":[85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73]},"words":{"starts":[4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1594,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1655,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705,1705],"lengths":[29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33]}}},"relatedMeaning":{"groupId":[82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83],"source":{"chars":{"starts":[3678487,3678512,3678520,3678551,3678559,3678582,3678590,3678618,3678626,3678648,3678656,3678688,3678696,3678713,3678721,3678738,3678746,3678763,3678771,3678788,3678796,3678813,3678821,3678838,3678846,3678863,3678871,3678888,3678896,3678913,3678921,3678938,3678946,3678963,3678971,3678988,3678996,3679013,3679021,3679038,3679046,3679063,3679071,3679088,3679096,3679113,3679121,3679138,3679146,3679163,3679171,3679192,3679200,3772823,3772848,3772856,3772886,3772894,3772917,3772925,3772953,3772961,3772978,3772986,3773003,3773011,3773028,3773036,3773053,3773061,3773078,3773086,3773103,3773111,3773128,3773136,3773153,3773161,3773178,3773186,3773203,3773211,3773228,3773236,3773253,3773261,3773278,3773286,3773303,3773311,3773328,3773336,3773353,3773361,3773378,3773386,3773403,3773411,3773428,3773436,3773453,3773461,3773478,3773486,3773503,3773511,3773528,3773536,3773553,3773561,3773578,3773586,3773603,3773611,3773628,3773636,3773653,3773661,3773681,3773689],"lengths":[5,1,12,1,3,1,9,1,2,1,12,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,5,1,10,1,3,1,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3]},"words":{"starts":[5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,5829,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203,8203],"lengths":[26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33]}},"suspected":{"chars":{"starts":[7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,7575,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286,8286],"lengths":[76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83]},"words":{"starts":[1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1561,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825,1825],"lengths":[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34]}}}}},"version":3}