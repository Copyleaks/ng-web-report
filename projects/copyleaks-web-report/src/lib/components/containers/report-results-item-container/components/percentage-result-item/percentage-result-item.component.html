<div
	class="plagiarism-detection-percentage-top-container"
	fxLayout="row"
	fxLayoutAlign="space-between start"
	fxLayoutGap="4px">
	<div
		class="plagiarism-detection-percentage-container"
		fxLayout="column"
		fxLayoutAlign="start start"
		fxLayoutGap="4px">
		<div
			*ngIf="percentageResult?.title"
			class="plagiarism-detection-title"
			fxLayout="row"
			fxLayoutAlign="space-between start">
			<span>{{ percentageResult.title }}</span>
			<span>{{ getMatchTypePercentage(eMatchType.SimilarWords) | similarity }}</span>
		</div>
		<div
			class="plagiarism-detection-percentage-result"
			fxLayout="column"
			fxLayoutAlign="start start"
			*ngIf="showPlagiarismPercentages && percentageResult?.showArrowButton; else showStackedBar">
			<ng-container *ngTemplateOutlet="plagiarismPercentage"></ng-container>
		</div>

		<ng-template #showStackedBar>
			<div
				[crReportScoreTooltip]="
					percentageResult && percentageResult.showTooltip
						? {
								identicalPct: getMatchTypePercentage(eMatchType.Identical),
								minorChangesPct: getMatchTypePercentage(eMatchType.MinorChanges),
								paraphrasedPct: getMatchTypePercentage(eMatchType.Paraphrased)
						  }
						: null
				"
				class="stacked-bar-top-container"
				fxLayout="row"
				fxLayoutGap="8px"
				fxLayoutAlign="center center">
				<div class="stacked-bar-container">
					<ng-container *ngTemplateOutlet="stackedBar"></ng-container>
				</div>
				<span *ngIf="!percentageResult?.title" class="similar-words-percentage">
					{{ getMatchTypePercentage(eMatchType.SimilarWords) | similarity }}
				</span>
			</div>
		</ng-template>
	</div>

	<button
		*ngIf="percentageResult?.showArrowButton"
		class="show-plagiarism-detection-button"
		fxLayout="row"
		fxLayoutAlign="start end"
		(click)="showPlagiarismPercentages = !showPlagiarismPercentages">
		<ng-container *ngIf="showPlagiarismPercentages; else showLessPerDetailsIcon">
			<mat-icon fontSet="material-icons-round">arrow_drop_up</mat-icon>
		</ng-container>
		<ng-template #showLessPerDetailsIcon>
			<mat-icon fontSet="material-icons-round">arrow_drop_down</mat-icon>
		</ng-template>
	</button>
</div>

<!-- #percentageLessResult -->
<ng-template #stackedBar>
	<div
		class="stacked-bar"
		[style.background-color]="stackedBarBackgroundColor"
		fxLayout="row"
		fxLayoutAlign="start center">
		<div
			class="identical first-percentage"
			[class.last-percentage]="
				!getMatchTypePercentage(eMatchType.MinorChanges) && !getMatchTypePercentage(eMatchType.Paraphrased)
			"
			[style.height]="stackedBarHeight"
			[style.width]="getMatchTypePercentage(eMatchType.Identical) | similarity"></div>
		<div
			class="minorChanges"
			[class.first-percentage]="!getMatchTypePercentage(eMatchType.Identical)"
			[class.last-percentage]="!getMatchTypePercentage(eMatchType.Paraphrased)"
			[style.height]="stackedBarHeight"
			[style.width]="getMatchTypePercentage(eMatchType.MinorChanges) | similarity"></div>
		<div
			class="paraphrased last-percentage"
			[class.first-percentage]="
				!getMatchTypePercentage(eMatchType.Identical) && !getMatchTypePercentage(eMatchType.MinorChanges)
			"
			[style.height]="stackedBarHeight"
			[style.width]="getMatchTypePercentage(eMatchType.Paraphrased) | similarity"></div>
	</div>
</ng-template>

<ng-template #plagiarismPercentage>
	<div class="match-type-top-container" fxLayout="column" fxLayoutAlign="start start" fxLayoutGap="6px">
		<div
			*ngIf="!percentageResult?.showTooltip"
			class="match-type-title"
			fxLayout="row"
			fxLayoutAlign="space-between center">
			<span>Match type</span>
			<div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="12px">
				<span class="percentage-match">Match</span>
				<span class="number-words-match">Words</span>
			</div>
		</div>
		<!--identical-->
		<div class="match-type-cotainer" fxLayout="row" fxLayoutAlign="space-between center">
			<div fxLayout="row" fxLayoutGap="8px" fxLayoutAlign="start center">
				<span class="dot identical"></span>
				<span class="type-name">IDENTICAL</span>
			</div>
			<div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="12px">
				<span class="percentage-match type-value">{{ getMatchTypePercentage(eMatchType.Identical) | similarity }}</span>
				<span *ngIf="!percentageResult?.showTooltip && iStatisticsResult" class="number-words-match type-value">
					{{ iStatisticsResult.identical }}
				</span>
			</div>
		</div>
		<!--minorChanges-->
		<div class="match-type-cotainer" fxLayout="row" fxLayoutAlign="space-between center">
			<div fxLayout="row" fxLayoutGap="8px" fxLayoutAlign="start center">
				<span class="dot minorChanges"></span>
				<span class="type-name">MINORCHANGES</span>
			</div>
			<div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="12px">
				<span class="percentage-match type-value">
					{{ getMatchTypePercentage(eMatchType.MinorChanges) | similarity }}
				</span>
				<span *ngIf="!percentageResult?.showTooltip && iStatisticsResult" class="number-words-match type-value">
					{{ iStatisticsResult.minorChanges }}
				</span>
			</div>
		</div>
		<!-- paraphrased -->
		<div class="match-type-cotainer" fxLayout="row" fxLayoutAlign="space-between center">
			<div fxLayout="row" fxLayoutGap="8px" fxLayoutAlign="start center">
				<span class="dot paraphrased"></span>
				<span class="type-name">PARAPHRASED</span>
			</div>
			<div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="12px">
				<span class="percentage-match type-value">
					{{ getMatchTypePercentage(eMatchType.Paraphrased) | similarity }}
				</span>
				<span *ngIf="!percentageResult?.showTooltip && iStatisticsResult" class="number-words-match type-value">
					{{ iStatisticsResult.relatedMeaning }}
				</span>
			</div>
		</div>
	</div>
</ng-template>
